# NumPy

## NumPy对象（ndarray）

### 1.ndarray定义

NumPy 最重要的一个特点是其 N 维数组对象 ndarray，它是一系列同类型数据的集合，以 0 下标为开始进行集合中元素的索引。

ndarray 对象是用于存放同类型元素的多维数组。

ndarray 中的每个元素在内存中都有相同存储大小的区域。

ndarray 内部由以下内容组成：

- 一个指向数据（内存或内存映射文件中的一块数据）的指针。
- 数据类型或 dtype，描述在数组中的固定大小值的格子。
- 一个表示数组形状（shape）的元组，表示各维度大小的元组。
- 一个跨度元组（stride），其中的整数指的是为了前进到当前维度下一个元素需要"跨过"的字节数。

### 2.语法创建

```python
numpy.array(object, dtype = None, copy = True, order = None, subok = False, ndmin = 0)
```

### 3.参数说明

| 名称   | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| object | 数组或嵌套的数列                                             |
| dtype  | 数组元素的数据类型，可选                                     |
| copy   | 对象是否需要复制，可选                                       |
| order  | 创建数组的内存存储样式，C为行方向，F为列方向，A为任意方向（默认） |
| subok  | 默认返回一个与基类类型一致的数组                             |
| ndmin  | 指定生成数组的最小维度                                       |

- 创建一维数组

  ```python
  arr=np.array([100,200,300])
  print(arr)
  """
  [100 200 300]
  """
  ```

- 创建二维数组

  ```python
  arr=np.array([[100,200],[300,400]])
  print(arr)
  """
  [[100 200]
   [300 400]]
  """
  ```

- 指定最小维度

  ```python
  arr=np.array([100,200,300],ndmin=2)# 指定最小维度，可以升，不可降
  print(arr)
  """
  [[100 200 300]]
  """
  ```

- 设定数组元素类型

  ```python
  arr=np.array([1.0,2.3,2.8],dtype=np.int16)
  print(arr)
  """
  [1 2 2]
  """
  arr=np.array([1,2.3,2.8],dtype=np.float16)
  print(arr)
  """
  [1.  2.3 2.8]
  """
  ```

## NumPy数据类型

| 名称       | 描述                                                         |
| ---------- | ------------------------------------------------------------ |
| bool_      | 布尔型数据类型（True 或者 False）                            |
| int_       | 默认的整数类型（类似于 C 语言中的 long，int32 或 int64）     |
| intc       | 与 C 的 int 类型一样，一般是 int32 或 int 64                 |
| intp       | 用于索引的整数类型（类似于 C 的 ssize_t，一般情况下仍然是 int32 或 int64） |
| int8       | 字节（-128 to 127）                                          |
| int16      | 整数（-32768 to 32767）                                      |
| int32      | 整数（-2147483648 to 2147483647）                            |
| int64      | 整数（-9223372036854775808 to 9223372036854775807）          |
| uint8      | 无符号整数（0 to 255）                                       |
| uint16     | 无符号整数（0 to 65535）                                     |
| uint32     | 无符号整数（0 to 4294967295）                                |
| uint64     | 无符号整数（0 to 18446744073709551615）                      |
| float_     | float64 类型的简写                                           |
| float16    | 半精度浮点数，包括：1 个符号位，5 个指数位，10 个尾数位      |
| float32    | 单精度浮点数，包括：1 个符号位，8 个指数位，23 个尾数位      |
| float64    | 双精度浮点数，包括：1 个符号位，11 个指数位，52 个尾数位     |
| complex_   | complex128 类型的简写，即 128 位复数                         |
| complex64  | 复数，表示双 32 位浮点数（实数部分和虚数部分）               |
| complex128 | 复数，表示双 64 位浮点数（实数部分和虚数部分）               |

## NumPy数组属性

| 属性             | 说明                                        |
| ---------------- | ------------------------------------------- |
| ndarray.ndim     | 秩，即轴的数量或维度的数量                  |
| ndarray.shape    | 数组的维度，对于矩阵，n 行 m 列             |
| ndarray.size     | 数组元素的总个数，相当于 .shape 中 n*m 的值 |
| ndarray.dtype    | ndarray 对象的元素类型                      |
| ndarray.itemsize | ndarray 对象中每个元素的大小，以字节为单位  |
| ndarray.flags    | ndarray 对象的内存信息                      |

### 1.ndarray.ndim

```python
#返回数组维度数

arr=np.array([100,200,300])
print(arr.ndim)#1

arr=np.array([[100,200],[300,400]])
print(arr.ndim)#2

arr=np.array([[[100,200],[300,400]]])
print(arr.ndim)#3
```

### 2.ndarray.shape

```python
#用元组的形式，返回数组维度，如同返回矩阵（行列数）

arr=np.array([100,200,300])
print(arr.shape)#(3,)

arr=np.array([[100,200],[300,400]])
print(arr.shape)#(2, 2)

arr=np.array([[[100,200],[300,400]]])
print(arr.shape)#(1, 2, 2)
```

### 3.ndarray.size

```python
#返回数组元素总个数

arr=np.array([100,200,300])
print(arr.size)#3

arr=np.array([[100,200],[300,400]])
print(arr.size)#4

arr=np.array([[[100,200],[300,400],[500,600]]])
print(arr.size)#6
```

### 4.ndarray.dtype

```python
#返回ndarray对象中元素类型

arr=np.array([100.0,200.0,300.0])
print(arr.dtype)#float64

arr=np.array([[100,200],[300,400]])
print(arr.dtype)#int32

arr=np.array([[[100.0,200.0],[300,400],[500,600]]])
print(arr.dtype)#float64
#当对象中的元素既有int又有float型时，会以精度高的作为数据类型作为返回
```

### 5.ndarray.itemsize

```python
#返回每个元素的大小，以字节为单位

arr=np.array([100.0,200.0,300.0])
print(arr.itemsize)#8

arr=np.array([[100,200],[300,400]])
print(arr.itemsize)#4

arr=np.array([[[100.0,200.0],[300,400],[500,600]]])
print(arr.itemsize)#8
```

## NumPy创建数组方法

### 1.自定义创建数组

#### 1.1、numpy.empty

- 语法

  ```python
  numpy.empty(shape, dtype = float, order = 'C')
  ```

- 参数说明

  | 参数  | 描述                                                         |
  | ----- | ------------------------------------------------------------ |
  | shape | 数组形状                                                     |
  | dtype | 数据类型，可选                                               |
  | order | 有"C"和"F"两个选项,分别代表，行优先和列优先，在计算机内存中的存储元素的顺序。 |

- 代码实现

  ```python
  arr=np.empty((5,5),dtype=np.int16)
  print(arr)
  """
  [[ 25613 -31730  23040  25610  25615]
   [-31728  23040  25611  25617 -31726]
   [ 23040  25612  21251  10496  -9708]
   [ 18436  16717  31299  21118  17222]
   [ 12832  12337   8244  19784  17217]]
  """
  #实现创建未初始化的指定维度数组，及其指定数据类型
  ```

#### 1.2、numpy.zeros

- 语法

  ```python
  numpy.zeros(shape, dtype = float, order = 'C')
  ```

- 参数说明

  | 参数  | 描述                                                |
  | ----- | --------------------------------------------------- |
  | shape | 数组形状                                            |
  | dtype | 数据类型，可选                                      |
  | order | 'C' 用于 C 的行数组，或者 'F' 用于 FORTRAN 的列数组 |

- 代码实现

  ```python
  #创建指定大小的数组，数组元素以 0 来填充
  
  arr=np.zeros((5,5),dtype=np.int16)
  print(arr)
  
  """
  [[0 0 0 0 0]
   [0 0 0 0 0]
   [0 0 0 0 0]
   [0 0 0 0 0]
   [0 0 0 0 0]]
  """
  ```

#### 1.3、numpy.ones

- 语法

  ```python
  numpy.ones(shape, dtype = None, order = 'C')
  ```

- 参数说明

  | 参数  | 描述                                                |
  | ----- | --------------------------------------------------- |
  | shape | 数组形状                                            |
  | dtype | 数据类型，可选                                      |
  | order | 'C' 用于 C 的行数组，或者 'F' 用于 FORTRAN 的列数组 |

- 代码实现

  ```python
  #创建指定形状的数组，数组元素以 1 来填充
  
  arr=np.ones((5,5),dtype=np.float16)
  print(arr)
  
  """
  [[1. 1. 1. 1. 1.]
   [1. 1. 1. 1. 1.]
   [1. 1. 1. 1. 1.]
   [1. 1. 1. 1. 1.]
   [1. 1. 1. 1. 1.]]
  """
  ```

#### 1.4、numpy.zeros_like

- 语法

  numpy.zeros_like 用于创建一个与给定数组具有相同形状的数组，数组元素以 0 来填充。

  ```python
  numpy.zeros_like(a, dtype=None, order='K', subok=True, shape=None)
  ```

- 参数说明

  | 参数  | 描述                                                         |
  | ----- | ------------------------------------------------------------ |
  | a     | 给定要创建相同形状的数组                                     |
  | dtype | 创建的数组的数据类型                                         |
  | order | 数组在内存中的存储顺序，可选值为 'C'（按行优先）或 'F'（按列优先），默认为 'K'（保留输入数组的存储顺序） |
  | subok | 是否允许返回子类，如果为 True，则返回一个子类对象，否则返回一个与 a 数组具有相同数据类型和存储顺序的数组 |
  | shape | 创建的数组的形状，如果不指定，则默认为 a 数组的形状。        |

- 代码实现

  ```python
  arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
  print(arr)
  print(arr.shape)
  """
  [[1 4 7]
   [2 5 8]
   [3 6 9]]
   
  (3, 3)
  
  """
  array_=np.zeros_like(arr,dtype=np.int16)
  print(array_)
  print(array_.shape)
  """
  [[0 0 0]
   [0 0 0]
   [0 0 0]]
   
  (3, 3)
  
  """
  ```

#### 1.5、numpy.ones_like

- 语法

  numpy.ones_like 用于创建一个与给定数组具有相同形状的数组，数组元素以 1 来填充.

  ```
  numpy.ones_like(a, dtype=None, order='K', subok=True, shape=None)
  ```

- 参数说明

  | 参数  | 描述                                                         |
  | ----- | ------------------------------------------------------------ |
  | a     | 给定要创建相同形状的数组                                     |
  | dtype | 创建的数组的数据类型                                         |
  | order | 数组在内存中的存储顺序，可选值为 'C'（按行优先）或 'F'（按列优先），默认为 'K'（保留输入数组的存储顺序） |
  | subok | 是否允许返回子类，如果为 True，则返回一个子类对象，否则返回一个与 a 数组具有相同数据类型和存储顺序的数组 |
  | shape | 创建的数组的形状，如果不指定，则默认为 a 数组的形状。        |

- 代码实现

  ```python
  arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
  print(arr)
  print(arr.shape)
  """
  [[1 4 7]
   [2 5 8]
   [3 6 9]]
   
  (3, 3)
  
  """
  array_=np.ones_like(arr,dtype=np.int16)
  print(array_)
  print(array_.shape)
  """
  [[1 1 1]
   [1 1 1]
   [1 1 1]]
   
  (3, 3)
  
  """
  ```

### 2.从已有数组创建数组

#### 2.1、numpy.asarray

- 语法

  ```python
  numpy.asarray(a, dtype = None, order = None)
  ```

- 参数说明

  | 参数  | 描述                                                         |
  | ----- | ------------------------------------------------------------ |
  | a     | 任意形式的输入参数，可以是，列表, 列表的元组, 元组, 元组的元组, 元组的列表，多维数组 |
  | dtype | 数据类型，可选                                               |
  | order | 可选，有"C"和"F"两个选项,分别代表，行优先和列优先，在计算机内存中的存储元素的顺序。 |

- 代码实现

  ```python
  #列表转换ndarray，数据类型为int
  
  x=[1,7,5,9,1,2]
  arr=np.asarray(x,dtype=np.int16)
  print(arr)
  ```

  ```python
  #元组转换ndarray，数据类型为float
  
  x=(1,7,5,9,1,2)
  arr=np.asarray(x,dtype=np.float16)
  print(arr)
  ```

  ```python
  #元组列表转换ndarray，数据类型为float
  
  x=[(1,7,5),(9,1,2)]
  arr=np.asarray(x,dtype=np.float16)
  print(arr)
  """
  [[1. 7. 5.]
   [9. 1. 2.]]
  """
  ```

#### 2.2、numpy.fromiter

- 语法

  numpy.fromiter 方法从可迭代对象中建立 ndarray 对象，返回一维数组

  ```python
  numpy.fromiter(iterable, dtype, count=-1)
  ```

- 参数说明

  | 参数     | 描述                                   |
  | -------- | -------------------------------------- |
  | iterable | 可迭代对象                             |
  | dtype    | 返回数组的数据类型                     |
  | count    | 读取的数据数量，默认为-1，读取所有数据 |

- 代码实现

  ```python
  x=range(10)
  arr=np.fromiter(x,dtype=np.float16)
  print(arr)
  """
  [0. 1. 2. 3. 4. 5. 6. 7. 8. 9.]
  """
  ```

### 3.从数值范围创建数组

#### 3.1、numpy.arange

- 语法

  numpy 包中的使用 arange 函数创建数值范围并返回 ndarray 对象

  ```python
  numpy.arange(start, stop, step, dtype)
  ```

- 参数说明

  | 参数    | 描述                                                         |
  | ------- | ------------------------------------------------------------ |
  | `start` | 起始值，默认为`0`                                            |
  | `stop`  | 终止值（不包含）                                             |
  | `step`  | 步长，默认为`1`                                              |
  | `dtype` | 返回`ndarray`的数据类型，如果没有提供，则会使用输入数据的类型。 |

- 代码实现

  ```python
  arr=np.arange(5,dtype=np.float16)
  print(arr)
  """
  [0. 1. 2. 3. 4.]
  """
  arr=np.arange(3,10,dtype=np.int16)
  print(arr)
  """
  [3 4 5 6 7 8 9]
  """
  arr=np.arange(3,10,2,dtype=np.float16)
  print(arr)
  """
  [3. 5. 7. 9.]
  """
  
  ```

#### 3.2、numpy.linspace

- 语法

  numpy.linspace 函数用于创建一个一维数组，数组是一个等差数列构成的

  ```python
  np.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None)
  ```

- 参数说明

  | 参数       | 描述                                                         |
  | ---------- | ------------------------------------------------------------ |
  | `start`    | 序列的起始值                                                 |
  | `stop`     | 序列的终止值，如果`endpoint`为`true`，该值包含于数列中       |
  | `num`      | 要生成的等步长的样本数量，默认为`50`                         |
  | `endpoint` | 该值为 `true` 时，数列中包含`stop`值，反之不包含，默认是True。 |
  | `retstep`  | 如果为 True 时，生成的数组中会显示间距，反之不显示。         |
  | `dtype`    | `ndarray` 的数据类型                                         |

- 代码实现

  ```python
  arr=np.linspace(0,10,num=5,dtype=np.int16)
  print(arr)
  """
  [ 0  2  5  7 10]
  """
  
  arr=np.linspace(0,20,num=10,retstep=True,dtype=np.int16)
  print(arr)
  """
  (array([ 0,  2,  4,  6,  8, 11, 13, 15, 17, 20], dtype=int16), 2.2222222222222223)
  """
  ```

## NumPy切片和索引

- **ndarray对象的内容可以通过索引或切片来访问和修改**，**与 Python 中 list 的切片操作一样。**

- **ndarray 数组可以基于 0 - n 的下标进行索引，切片对象可以通过内置的 slice 函数，并设置 start, stop 及 step 参数进行，从原数组中切割出一个新数组。**

  ```python
  #单维数组切片及索引
  arr=np.arange(10)#[0 1 2 3 4 5 6 7 8 9]
  
  s=slice(1,9,2)
  print(arr[s])#[1 3 5 7]
  print(arr[1:9:2])#[1 3 5 7]
  print(arr[1:6])#[1 2 3 4 5]
  print(arr[7])#7
  ```

  ```python
  #多维数组切片及索引
  arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
  """
  [[1 4 7]
   [2 5 8]
   [3 6 9]]
  """
  print(arr[1:])
  """
  [[2 5 8]
   [3 6 9]]
  """
  print(arr[0:2])
  """
  [[1 4 7]
   [2 5 8]]
  
  """
  print(arr[...,1])
  """
  [4 5 6]
  """
  print(arr[1,...])
  """
  [2 5 8]
  """
  print(arr[1:,...])
  """
  [[2 5 8]
   [3 6 9]]
  """
  ```

## NumPy高级索引

​		NumPy 中的高级索引指的是使用整数数组、布尔数组或者其他序列来访问数组的元素。相比于基本索引，高级索引可以访问到数组中的任意元素，并且可以用来对数组进行复杂的操作和修改。

### 1.整数数组索引

​		整数数组索引是指使用一个数组来访问另一个数组的元素。这个数组中的每个元素都是目标数组中某个维度上的索引值。

```python
arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
"""
[[1 4 7]
 [2 5 8]
 [3 6 9]]
"""
print(arr[[0,1],[2,2]])#在数组中获取（0,2）,(1,2)位置处的元素
"""
[7 8]
"""

#获取四个角元素
row=[0,0,2,2]
col=[0,2,0,2]
print(arr[row,col])#(0,0)(0,2)(2,0)(2,2)
"""
[1 7 3 9]
"""
#切片与索引数组结合
a=arr[0:2,1:3]
"""
[[4 7]
 [5 8]]
"""
b=arr[0:2,[0,1]]
"""
[[1 4]
 [2 5]]
"""
c=arr[...,[0,1]]
"""
[[1 4]
 [2 5]
 [3 6]]
"""
```

### 2.布尔索引

布尔索引通过布尔运算（如：比较运算符）来获取符合指定条件的元素的数组

```python
arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
"""
[[1 4 7]
 [2 5 8]
 [3 6 9]]
"""
#获取大于5的元素
print(arr[arr>5])
"""
[7 8 6 9]
"""
arr=np.array([[1,4,7],[2,np.nan,8],[3,np.nan,9]])
"""
[[ 1.  4.  7.]
 [ 2. nan  8.]
 [ 3. nan  9.]]
"""
#过滤掉np.nan
print(arr[~np.isnan(arr)])
"""
[1. 4. 7. 2. 8. 3. 9.]
"""
```

### 3.花式索引

- 花式索引指的是利用**整数数组**进行索引。

- **花式索引根据索引数组的值作为目标数组的某个轴的下标来取值。**
- 对于使用一维整型数组作为索引，如果目标是一维数组，那么索引的结果就是对应位置的元素，如果目标是二维数组，那么就是对应下标的行。

- 花式索引跟切片不一样，它总是将数据复制到新数组中。

### 4.花式索引一维数组

```python
#花式索引一维数组，索引的结果就是对应位置的元素
arr=np.arange(10)#[0 1 2 3 4 5 6 7 8 9]
print(arr[[1,6]])#[1 6]
print(arr[[5]])#[5]
```

### 5.花式索引二维数组

```python
#花式索引二维数组，索引的结果就是对应下标的行
arr=np.array([[1,4,7],[2,5,8],[3,6,9]])
"""
[[1 4 7]
 [2 5 8]
 [3 6 9]]
"""
print(arr[[0,1]])
"""
[[1 4 7]
 [2 5 8]]
"""
print(arr[[-1,-2]])
"""
[[3 6 9]
 [2 5 8]]
"""
```

```python
#传入多个索引数组
"""

np.ix_() 函数就是输入两个数组，产生笛卡尔积的映射关系。

笛卡尔乘积是指在数学中，两个集合 X 和 Y 的笛卡尔积（Cartesian product），又称直积，表示为 **X×Y**，第一个对象是X的成员而第二个对象是 Y 的所有可能有序对的其中一个成员。
例如 **A={a,b}, B={0,1,2}**，则：

A×B={(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}
B×A={(0, a), (0, b), (1, a), (1, b), (2, a), (2, b)}
"""
arr=np.arange(64).reshape(8,8)
"""
[[ 0  1  2  3  4  5  6  7]
 [ 8  9 10 11 12 13 14 15]
 [16 17 18 19 20 21 22 23]
 [24 25 26 27 28 29 30 31]
 [32 33 34 35 36 37 38 39]
 [40 41 42 43 44 45 46 47]
 [48 49 50 51 52 53 54 55]
 [56 57 58 59 60 61 62 63]]
"""
print(arr[np.ix_([1,3,5,7],[4,5,6,7])])
"""
[[12 13 14 15]
 [28 29 30 31]
 [44 45 46 47]
 [60 61 62 63]]
"""
```

