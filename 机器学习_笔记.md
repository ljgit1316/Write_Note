
# æœºå™¨å­¦ä¹ 

## æœºå™¨å­¦ä¹ åˆ†ç±»

### 1.ç›‘ç£å­¦ä¹ 

ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰æ˜¯**ä»æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ æ¨¡å‹**ï¼Œ**ç„¶åå¯¹æŸä¸ªç»™å®šçš„æ–°æ•°æ®åˆ©ç”¨æ¨¡å‹é¢„æµ‹å®ƒçš„æ ‡ç­¾**ã€‚å¦‚æœåˆ†ç±»æ ‡ç­¾ç²¾ç¡®åº¦è¶Šé«˜ï¼Œåˆ™å­¦ä¹ æ¨¡å‹å‡†ç¡®åº¦è¶Šé«˜ï¼Œé¢„æµ‹ç»“æœè¶Šç²¾ç¡®ã€‚

ç›‘ç£å­¦ä¹ ä¸»è¦ç”¨äº**å›å½’**å’Œ**åˆ†ç±»**ã€‚

å¸¸è§çš„ç›‘ç£å­¦ä¹ çš„**å›å½’ç®—æ³•æœ‰çº¿æ€§å›å½’ã€å›å½’æ ‘ã€Ké‚»è¿‘ã€Adaboostã€ç¥ç»ç½‘ç»œç­‰ã€‚**

å¸¸è§çš„ç›‘ç£å­¦ä¹ çš„**åˆ†ç±»ç®—æ³•æœ‰æœ´ç´ è´å¶æ–¯ã€å†³ç­–æ ‘ã€SVMã€é€»è¾‘å›å½’ã€Ké‚»è¿‘ã€Adaboostã€ç¥ç»ç½‘ç»œç­‰ã€‚**

### 2.åŠç›‘ç£å­¦ä¹ 

åŠç›‘ç£å­¦ä¹ ï¼ˆSemi-Supervised Learningï¼‰æ˜¯**åˆ©ç”¨å°‘é‡æ ‡æ³¨æ•°æ®å’Œå¤§é‡æ— æ ‡æ³¨æ•°æ®è¿›è¡Œå­¦ä¹ çš„æ¨¡å¼ã€‚**

åŠç›‘ç£å­¦ä¹ **ä¾§é‡äºåœ¨æœ‰ç›‘ç£çš„åˆ†ç±»ç®—æ³•ä¸­åŠ å…¥æ— æ ‡è®°æ ·æœ¬æ¥å®ç°åŠç›‘ç£åˆ†ç±»ã€‚**

å¸¸è§çš„åŠç›‘ç£å­¦ä¹ ç®—æ³•æœ‰Pseudo-Labelã€Î -Modelã€Temporal Ensemblingã€Mean Teacherã€VATã€UDAã€MixMatchã€ReMixMatchã€FixMatchç­‰ã€‚

### 3.æ— ç›‘ç£å­¦ä¹ 

æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰æ˜¯**ä»æœªæ ‡æ³¨æ•°æ®ä¸­å¯»æ‰¾éšå«ç»“æ„çš„è¿‡ç¨‹ã€‚**

æ— ç›‘ç£å­¦ä¹ **ä¸»è¦ç”¨äºå…³è”åˆ†æã€èšç±»å’Œé™ç»´ã€‚**

å¸¸è§çš„æ— ç›‘ç£å­¦ä¹ ç®—æ³•æœ‰ç¨€ç–è‡ªç¼–ç ï¼ˆSparse Auto-Encoderï¼‰ã€ä¸»æˆåˆ†åˆ†æï¼ˆPrincipal Component Analysis, PCAï¼‰ã€K-Meansç®—æ³•ï¼ˆKå‡å€¼ç®—æ³•ï¼‰ã€DBSCANç®—æ³•ï¼ˆDensity-Based Spatial Clustering of Applications with Noiseï¼‰ã€æœ€å¤§æœŸæœ›ç®—æ³•ï¼ˆExpectation-Maximization algorithm, EMï¼‰ç­‰ã€‚

### 4.å¼ºåŒ–å­¦ä¹ 

å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰**ç±»ä¼¼äºç›‘ç£å­¦ä¹ ï¼Œä½†æœªä½¿ç”¨æ ·æœ¬æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ˜¯æ˜¯é€šè¿‡ä¸æ–­è¯•é”™è¿›è¡Œå­¦ä¹ çš„æ¨¡å¼ã€‚**

åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¯ä»¥è¿›è¡Œäº¤äº’çš„å¯¹è±¡ï¼šæ™ºèƒ½ä½“ï¼ˆAgnetï¼‰å’Œç¯å¢ƒï¼ˆEnvironmentï¼‰ï¼Œè¿˜æœ‰å››ä¸ªæ ¸å¿ƒè¦ç´ ï¼šç­–ç•¥ï¼ˆPolicyï¼‰ã€å›æŠ¥å‡½æ•°ï¼ˆæ”¶ç›Šä¿¡å·ï¼ŒReward Functionï¼‰ã€ä»·å€¼å‡½æ•°ï¼ˆValue Functionï¼‰å’Œç¯å¢ƒæ¨¡å‹ï¼ˆEnvironment Modelï¼‰ï¼Œå…¶ä¸­ç¯å¢ƒæ¨¡å‹æ˜¯å¯é€‰çš„ã€‚

## æœºå™¨å­¦ä¹ åº”ç”¨åœºåˆ

### 1.è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰

è‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½ä¸­çš„é‡è¦é¢†åŸŸä¹‹ä¸€ï¼Œæ¶‰åŠè®¡ç®—æœºä¸äººç±»è‡ªç„¶è¯­è¨€çš„äº¤äº’ã€‚NLPæŠ€æœ¯å¯ä»¥å®ç°è¯­éŸ³è¯†åˆ«ã€æ–‡æœ¬åˆ†æã€æƒ…æ„Ÿåˆ†æç­‰ä»»åŠ¡ï¼Œä¸ºæ™ºèƒ½å®¢æœã€èŠå¤©æœºå™¨äººã€è¯­éŸ³åŠ©æ‰‹ç­‰æä¾›æ”¯æŒã€‚

### 2.åŒ»ç–—è¯Šæ–­ä¸å½±åƒåˆ†æ

æœºå™¨å­¦ä¹ åœ¨åŒ»ç–—é¢†åŸŸæœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬åŒ»ç–—å›¾åƒåˆ†æã€ç–¾ç—…é¢„æµ‹ã€è¯ç‰©å‘ç°ç­‰ã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨åŒ»ç–—å½±åƒè¯Šæ–­ä¸­çš„è¡¨ç°å¼•äººæ³¨ç›®ã€‚

### 3.é‡‘èé£é™©ç®¡ç†

æœºå™¨å­¦ä¹ åœ¨é‡‘èé¢†åŸŸçš„åº”ç”¨è¶Šæ¥è¶Šé‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨é£é™©ç®¡ç†æ–¹é¢ã€‚æ¨¡å‹å¯ä»¥åˆ†æå¤§é‡çš„é‡‘èæ•°æ®ï¼Œé¢„æµ‹å¸‚åœºæ³¢åŠ¨æ€§ã€ä¿¡ç”¨é£é™©ç­‰ã€‚

### 4.é¢„æµ‹ä¸æ¨èç³»ç»Ÿ

æœºå™¨å­¦ä¹ åœ¨é¢„æµ‹å’Œæ¨èç³»ç»Ÿä¸­ä¹Ÿæœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œå¦‚é”€å”®é¢„æµ‹ã€ä¸ªæ€§åŒ–æ¨èç­‰ã€‚ååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹çš„æ¨èæ˜¯å¸¸ç”¨çš„æŠ€æœ¯ã€‚

### 5.åˆ¶é€ ä¸šå’Œç‰©è”ç½‘

ç‰©è”ç½‘ï¼ˆIoTï¼‰åœ¨åˆ¶é€ ä¸šä¸­çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œæœºå™¨å­¦ä¹ å¯ç”¨äºå¤„ç†å’Œåˆ†æä¼ æ„Ÿå™¨æ•°æ®ï¼Œå®ç°è®¾å¤‡é¢„æµ‹æ€§ç»´æŠ¤å’Œè´¨é‡æ§åˆ¶ã€‚

### 6.èƒ½æºç®¡ç†ä¸ç¯å¢ƒä¿æŠ¤

æœºå™¨å­¦ä¹ å¯ä»¥å¸®åŠ©ä¼˜åŒ–èƒ½æºç®¡ç†ï¼Œå‡å°‘èƒ½æºæµªè´¹ï¼Œæé«˜èƒ½æºåˆ©ç”¨æ•ˆç‡ã€‚é€šè¿‡åˆ†æå¤§é‡çš„èƒ½æºæ•°æ®ï¼Œè¯†åˆ«ä¼˜åŒ–çš„æœºä¼šã€‚

### 7.å†³ç­–æ”¯æŒä¸æ™ºèƒ½åˆ†æ

æœºå™¨å­¦ä¹ åœ¨å†³ç­–æ”¯æŒç³»ç»Ÿä¸­çš„åº”ç”¨ä¹Ÿååˆ†é‡è¦ï¼Œå¯ä»¥å¸®åŠ©åˆ†æå¤§é‡æ•°æ®ï¼Œè¾…åŠ©å†³ç­–åˆ¶å®šã€‚åŸºäºæ•°æ®çš„å†³ç­–å¯ä»¥æ›´åŠ å‡†ç¡®å’Œæœ‰æ®å¯ä¾ã€‚

### 8.å›¾åƒè¯†åˆ«ä¸è®¡ç®—æœºè§†è§‰

å›¾åƒè¯†åˆ«å’Œè®¡ç®—æœºè§†è§‰æ˜¯å¦ä¸€ä¸ªé‡è¦çš„æœºå™¨å­¦ä¹ åº”ç”¨é¢†åŸŸï¼Œå®ƒä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œè§£é‡Šå›¾åƒã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹å¦‚å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰åœ¨å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ç­‰ä»»åŠ¡ä¸­å–å¾—äº†çªç ´æ€§è¿›å±•ã€‚

## æœºå™¨å­¦ä¹ é¡¹ç›®å¼€å‘æ­¥éª¤

5ä¸ªåŸºæœ¬æ­¥éª¤ç”¨äºæ‰§è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡ï¼š

1. **æ”¶é›†æ•°æ®**ï¼šæ— è®ºæ˜¯æ¥è‡ªexcelï¼Œaccessï¼Œæ–‡æœ¬æ–‡ä»¶ç­‰çš„åŸå§‹æ•°æ®ï¼Œè¿™ä¸€æ­¥ï¼ˆæ”¶é›†è¿‡å»çš„æ•°æ®ï¼‰æ„æˆäº†æœªæ¥å­¦ä¹ çš„åŸºç¡€ã€‚ç›¸å…³æ•°æ®çš„ç§ç±»ï¼Œå¯†åº¦å’Œæ•°é‡è¶Šå¤šï¼Œæœºå™¨çš„å­¦ä¹ å‰æ™¯å°±è¶Šå¥½ã€‚
2. **å‡†å¤‡æ•°æ®**ï¼šä»»ä½•åˆ†æè¿‡ç¨‹éƒ½ä¼šä¾èµ–äºä½¿ç”¨çš„æ•°æ®è´¨é‡å¦‚ä½•ã€‚äººä»¬éœ€è¦èŠ±æ—¶é—´ç¡®å®šæ•°æ®è´¨é‡ï¼Œç„¶åé‡‡å–æªæ–½è§£å†³è¯¸å¦‚ç¼ºå¤±çš„æ•°æ®å’Œå¼‚å¸¸å€¼çš„å¤„ç†ç­‰é—®é¢˜ã€‚æ¢ç´¢æ€§åˆ†æå¯èƒ½æ˜¯ä¸€ç§è¯¦ç»†ç ”ç©¶æ•°æ®ç»†å¾®å·®åˆ«çš„æ–¹æ³•ï¼Œä»è€Œä½¿æ•°æ®çš„è´¨é‡è¿…é€Ÿæé«˜ã€‚
3. **ç»ƒæ¨¡å‹**ï¼šæ­¤æ­¥éª¤æ¶‰åŠä»¥æ¨¡å‹çš„å½¢å¼é€‰æ‹©é€‚å½“çš„ç®—æ³•å’Œæ•°æ®è¡¨ç¤ºã€‚æ¸…ç†åçš„æ•°æ®åˆ†ä¸ºä¸¤éƒ¨åˆ† - è®­ç»ƒå’Œæµ‹è¯•ï¼ˆæ¯”ä¾‹è§†å‰æç¡®å®šï¼‰; ç¬¬ä¸€éƒ¨åˆ†ï¼ˆè®­ç»ƒæ•°æ®ï¼‰ç”¨äºå¼€å‘æ¨¡å‹ã€‚ç¬¬äºŒéƒ¨åˆ†ï¼ˆæµ‹è¯•æ•°æ®ï¼‰ç”¨ä½œå‚è€ƒä¾æ®ã€‚
4. **è¯„ä¼°æ¨¡å‹**ï¼šä¸ºäº†æµ‹è¯•å‡†ç¡®æ€§ï¼Œä½¿ç”¨æ•°æ®çš„ç¬¬äºŒéƒ¨åˆ†ï¼ˆä¿æŒ/æµ‹è¯•æ•°æ®ï¼‰ã€‚æ­¤æ­¥éª¤æ ¹æ®ç»“æœç¡®å®šç®—æ³•é€‰æ‹©çš„ç²¾åº¦ã€‚æ£€æŸ¥æ¨¡å‹å‡†ç¡®æ€§çš„æ›´å¥½æµ‹è¯•æ˜¯æŸ¥çœ‹å…¶åœ¨æ¨¡å‹æ„å»ºæœŸé—´æ ¹æœ¬æœªä½¿ç”¨çš„æ•°æ®çš„æ€§èƒ½ã€‚
5. **æé«˜æ€§èƒ½**ï¼šæ­¤æ­¥éª¤å¯èƒ½æ¶‰åŠé€‰æ‹©å®Œå…¨ä¸åŒçš„æ¨¡å‹æˆ–å¼•å…¥æ›´å¤šå˜é‡æ¥æé«˜æ•ˆç‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´è¿›è¡Œæ•°æ®æ”¶é›†å’Œå‡†å¤‡çš„åŸå› ã€‚

æ— è®ºæ˜¯ä»»ä½•æ¨¡å‹ï¼Œè¿™5ä¸ªæ­¥éª¤éƒ½å¯ç”¨äºæ„å»ºæŠ€æœ¯ï¼Œå½“æˆ‘ä»¬è®¨è®ºç®—æ³•æ—¶ï¼Œæ‚¨å°†æ‰¾åˆ°è¿™äº”ä¸ªæ­¥éª¤å¦‚ä½•å‡ºç°åœ¨æ¯ä¸ªæ¨¡å‹ä¸­ï¼

## æ•°æ®é›†

### 1.sklearnç©å…·æ•°æ®é›†

- å®šä¹‰

  æ•°æ®é‡å°ï¼Œæ•°æ®åœ¨sklearnåº“çš„æœ¬åœ°ï¼Œåªè¦å®‰è£…äº†sklearnï¼Œä¸ç”¨ä¸Šç½‘å°±å¯ä»¥è·å–

- å›¾ç¤º

  ![real_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/real_1.png)

### 2.sklearnç°å®ä¸–ç•Œæ•°æ®é›†

- å®šä¹‰

  æ•°æ®é‡å¤§ï¼Œæ•°æ®åªèƒ½é€šè¿‡ç½‘ç»œè·å–

- å›¾ç¤º

  ![toal_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/toal_1.png)

### 3.sklearnåŠ è½½ç©å…·æ•°æ®é›†

#### 3.1 é¸¢å°¾èŠ±æ•°æ®

- è¯­æ³•

  ```python
  from sklearn.datasets import load_iris
  iris = load_iris()#é¸¢å°¾èŠ±æ•°æ®,è¿”å›ä¸€ä¸ªBunchå¯¹è±¡
  ```

- ç‰¹å¾

  - â€‹	èŠ±è¼é•¿ sepal length  
  - â€‹	èŠ±è¼å®½ sepal width 
  - â€‹	èŠ±ç“£é•¿ petal length  
  - â€‹	èŠ±ç“£å®½ petal width

- åˆ†ç±»

  - â€‹	0-Setosaå±±é¸¢å°¾    
  - â€‹	1-Versicolourå˜è‰²é¸¢å°¾   
  - â€‹	2-Virginicaç»´å‰å°¼äºšé¸¢å°¾

- å®ä¾‹

  ```python
  import pandas as pd
  import numpy as np
  from sklearn.datasets import load_iris
  iris=load_iris()
  data=iris.data
  target=iris.target
  target=target.reshape(len(target),1)
  iris_con=np.hstack([data,target])
  col=iris.feature_names
  col.append('target')
  iris_show=pd.DataFrame(iris_con,columns=col)
  ```

  ![bird](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/bird.png)

#### 3.2 ç³–å°¿ç—…æ•°æ®

- è¯­æ³•

  ```python
  from sklearn.datasets import  load_diabetes
  diabetes=load_diabetes()
  ```

- ç‰¹å¾

  - â€Œ**å¹´é¾„ï¼ˆâ€Œageï¼‰â€Œ**â€Œ
  - â€Œ**æ€§åˆ«ï¼ˆâ€Œsexï¼‰â€Œ**â€Œ
  - â€Œ**èº«ä½“è´¨é‡æŒ‡æ•°ï¼ˆâ€Œbmiï¼‰â€Œ**â€Œ
  - â€Œ**å¹³å‡è¡€å‹ï¼ˆâ€Œbpï¼‰â€Œ**â€Œ
  - â€Œ**å…­ç§è¡€æ¸…çš„åŒ–éªŒæ•°æ®ï¼ˆâ€Œs1~s6ï¼‰â€Œ**â€Œï¼Œâ€ŒåŒ…æ‹¬Tç»†èƒï¼ˆâ€Œtcï¼‰â€Œã€â€Œä½å¯†åº¦è„‚è›‹ç™½ï¼ˆâ€Œldlï¼‰â€Œã€â€Œé«˜å¯†åº¦è„‚è›‹ç™½ï¼ˆâ€Œhdlï¼‰â€Œã€â€Œä¿ƒç”²çŠ¶è…ºæ¿€ç´ ï¼ˆâ€Œtchï¼‰â€Œã€â€Œæ‹‰è«ä¸‰å—ªï¼ˆâ€Œltgï¼‰â€Œå’Œè¡€ç³–æ°´å¹³ï¼ˆâ€Œgluï¼‰â€Œã€‚â€Œ

- å®ä¾‹

  ```python
  from sklearn.datasets import  load_diabetes
  diabetes=load_diabetes()
  data=diabetes.data
  target=diabetes.target
  target=target.reshape(len(target),1)
  diabetes_con=np.hstack([data,target])
  col=diabetes.feature_names
  col.append('target')
  diabetes_show=pd.DataFrame(diabetes_con,columns=col)
  
  print(diabetes_show)
  ```

  ![tang](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tang.png)



#### 3.3 æ•°å­—æ•°æ®é›†

- è¯­æ³•

  ```python
  from sklearn.datasets import load_digits
  num=load_digits()
  ```

- ç‰¹å¾

  - æ¯ä¸ªæ ·æœ¬ç”±64ä¸ªç‰¹å¾ç»„æˆï¼Œâ€Œè¿™äº›ç‰¹å¾å®é™…ä¸Šæ˜¯8x8åƒç´ å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ çš„ç°åº¦å€¼ã€‚â€Œç°åº¦å€¼é€šå¸¸æ˜¯ä¸€ä¸ªä»‹äº0åˆ°æŸä¸ªæœ€å¤§å€¼ï¼ˆâ€Œåœ¨è¿™ä¸ªæ•°æ®é›†ä¸­æ˜¯16ï¼‰â€Œä¹‹é—´çš„æ•´æ•°ï¼Œâ€Œä½†åœ¨åŠ è½½åˆ°sklearnä¸­æ—¶ï¼Œâ€Œå®ƒä»¬è¢«è½¬æ¢ä¸ºfloat64ç±»å‹çš„å€¼ï¼Œâ€Œå¹¶ä¸”é€šå¸¸ä¼šè¢«å½’ä¸€åŒ–åˆ°[0, 1]èŒƒå›´å†…ï¼Œã€‚
  - 64ä¸ªç‰¹å¾ä»¥çº¿æ€§æ–¹å¼æ’åˆ—ï¼Œâ€Œå¯¹åº”äº8x8å›¾åƒçŸ©é˜µçš„å±•å¹³ç‰ˆæœ¬ã€‚â€Œå…·ä½“æ¥è¯´ï¼Œâ€Œç¬¬ä¸€ä¸ªç‰¹å¾å¯¹åº”äºå›¾åƒå·¦ä¸Šè§’çš„åƒç´ ï¼Œâ€Œæ¥ä¸‹æ¥çš„8ä¸ªç‰¹å¾å¯¹åº”äºç¬¬ä¸€è¡Œçš„å…¶ä½™åƒç´ ï¼Œâ€Œä¾æ­¤ç±»æ¨ï¼Œâ€Œç›´åˆ°éå†æ•´ä¸ªå›¾åƒã€‚â€Œ

- åˆ†ç±»

  **å«0-9å…±10ç§æ ‡ç­¾ï¼Œâ€Œå„ç±»æ ·æœ¬å‡è¡¡ï¼Œâ€Œç‰¹å¾ä¸ºç¦»æ•£æ•°å€¼0-16ä¹‹é—´**â€Œã€‚â€Œ

- å®ä¾‹

  ```python
  from sklearn.datasets import load_digits
  num=load_digits()
  
  data=num.data
  target=num.target
  target=target.reshape(len(target),1)
  num_con=np.hstack([data,target])
  col=num.feature_names
  col.append('target')
  num_show=pd.DataFrame(num_con,columns=col)
  
  print(num_show)
  ```

  ![num](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/num.png)

#### 3.4 linnerudç‰©ç†é”»ç‚¼æ•°æ®

- è¯­æ³•

  ```python
  from sklearn.datasets import load_linnerud
  phy=load_linnerud()
  ```

- ç‰¹å¾

  Chinsï¼šå¼•ä½“å‘ä¸Š

  Situpsï¼šä»°å§èµ·å  

  Jumpsï¼šè·³é«˜  

- ç›®æ ‡å‚æ•°

  Weightï¼šä½“é‡  

  Waistï¼šè…°å›´  

  Pulseï¼šè„‰æ

- å®ä¾‹

  ```python
  from sklearn.datasets import load_linnerud
  phy=load_linnerud()
  
  data=phy.data
  target=phy.target
  phy_con=np.hstack([data,target])
  col=phy.feature_names
  col.append('Weight')
  col.append('Waist')
  col.append('Pulse')
  phy_show=pd.DataFrame(phy_con,columns=col)
  
  print(phy_show)
  ```

  ![phy](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/phy.png)

#### 3.5 è‘¡è„é…’æ•°æ®é›†

- è¯­æ³•

  ```python
  from sklearn.datasets import load_wine
  achlo=load_wine()
  ```

- ç‰¹å¾

  1.â€Œ**é…’ç²¾ï¼ˆâ€Œalcoholï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„é…’ç²¾å«é‡ã€‚â€Œ

  2.â€Œ**è‹¹æœé…¸ï¼ˆâ€Œmalic_acidï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„è‹¹æœé…¸å«é‡ï¼Œâ€Œè‹¹æœé…¸æ˜¯ä¸€ç§æœ‰æœºé…¸ï¼Œâ€Œå¯¹è‘¡è„é…’çš„é£å‘³å’Œå£æ„Ÿæœ‰é‡è¦å½±å“ã€‚â€Œ

  3.â€Œ**ç°åˆ†ï¼ˆâ€Œashï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„ç°åˆ†å«é‡ï¼Œâ€Œç°åˆ†æ˜¯è‘¡è„é…’ä¸­æ— æœºç‰©è´¨çš„æ€»å’Œï¼Œâ€ŒåŒ…æ‹¬çŸ¿ç‰©è´¨ç­‰ã€‚â€Œ

  4.â€Œ**ç°çš„ç¢±æ€§ï¼ˆâ€Œalcalinity_of_ashï¼‰â€Œ**â€Œï¼šâ€Œç°åˆ†çš„ç¢±æ€§ç¨‹åº¦ï¼Œâ€Œåæ˜ äº†ç°åˆ†ä¸­çŸ¿ç‰©è´¨çš„ç§ç±»å’Œå«é‡ã€‚â€Œ

  5.â€Œ**é•ï¼ˆâ€Œmagnesiumï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„é•å«é‡ï¼Œâ€Œé•æ˜¯ä¸€ç§é‡è¦çš„çŸ¿ç‰©è´¨ï¼Œâ€Œå¯¹è‘¡è„é…’çš„é£å‘³å’Œç¨³å®šæ€§æœ‰ä¸€å®šå½±å“ã€‚â€Œ

  6.â€Œ**æ€»é…šï¼ˆâ€Œtotal_phenolsï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„æ€»é…šå«é‡ï¼Œâ€Œé…šç±»ç‰©è´¨æ˜¯è‘¡è„é…’ä¸­çš„é‡è¦æˆåˆ†ï¼Œâ€Œå¯¹è‘¡è„é…’çš„é¢œè‰²ã€â€Œé£å‘³å’ŒæŠ—æ°§åŒ–æ€§æœ‰è´¡çŒ®ã€‚â€Œ

  7.â€Œ**ç±»é»„é…®ï¼ˆâ€Œflavanoidsï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„ç±»é»„é…®å«é‡ï¼Œâ€Œç±»é»„é…®æ˜¯ä¸€ç±»å…·æœ‰æŠ—æ°§åŒ–æ€§è´¨çš„æ¤ç‰©åŒ–å­¦ç‰©è´¨ã€‚â€Œ

  8.â€Œ**éé»„çƒ·ç±»é…šç±»ï¼ˆâ€Œnonflavanoid_phenolsï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„éé»„çƒ·ç±»é…šç±»ç‰©è´¨å«é‡ï¼Œâ€Œè¿™äº›ç‰©è´¨åŒæ ·å¯¹è‘¡è„é…’çš„é£å‘³å’ŒæŠ—æ°§åŒ–æ€§æœ‰è´¡çŒ®ã€‚â€Œ

  9.â€Œ**èŠ±é’ç´ ï¼ˆâ€Œproanthocyaninsï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„èŠ±é’ç´ å«é‡ï¼Œâ€ŒèŠ±é’ç´ æ˜¯ä¸€ç§å¼ºæ•ˆçš„å¤©ç„¶è‰²ç´ å’ŒæŠ—æ°§åŒ–å‰‚ï¼Œâ€Œå¯¹è‘¡è„é…’çš„é¢œè‰²å’Œç¨³å®šæ€§æœ‰é‡è¦ä½œç”¨ã€‚â€Œ

  10.â€Œ**é¢œè‰²å¼ºåº¦ï¼ˆâ€Œcolor_intensityï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’çš„é¢œè‰²å¼ºåº¦ï¼Œâ€Œåæ˜ äº†è‘¡è„é…’ä¸­è‰²ç´ çš„å«é‡å’Œåˆ†å¸ƒã€‚â€Œ

  11.â€Œ**è‰²è°ƒï¼ˆâ€Œhueï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’çš„è‰²è°ƒï¼Œâ€Œå³é¢œè‰²çš„å…·ä½“è¡¨ç°ï¼Œâ€Œå¦‚çº¢è‘¡è„é…’å¯èƒ½å‘ˆç°ä¸åŒçš„çº¢è‰²è°ƒã€‚â€Œ

  12.â€Œ**od280/od315ç¨€é‡Šè‘¡è„é…’ï¼ˆâ€Œod280/od315_of_diluted_winesï¼‰â€Œ**â€Œï¼šâ€Œè¿™æ˜¯ä¸€ä¸ªå…‰å­¦å¯†åº¦çš„æ¯”å€¼ï¼Œâ€Œç”¨äºæè¿°è‘¡è„é…’åœ¨ç‰¹å®šæ³¢é•¿ä¸‹çš„å¸æ”¶ç‰¹æ€§ï¼Œâ€Œä¸è‘¡è„é…’ä¸­çš„æŸäº›åŒ–å­¦æˆåˆ†å«é‡æœ‰å…³ã€‚â€Œ

  13.â€Œ**è„¯æ°¨é…¸ï¼ˆâ€Œprolineï¼‰â€Œ**â€Œï¼šâ€Œè‘¡è„é…’ä¸­çš„è„¯æ°¨é…¸å«é‡ï¼Œâ€Œè„¯æ°¨é…¸æ˜¯ä¸€ç§æ°¨åŸºé…¸ï¼Œâ€Œå¯¹è‘¡è„é…’çš„é£å‘³å’Œå£æ„Ÿæœ‰ä¸€å®šå½±å“ã€‚â€Œ

- åˆ†ç±»

  'class_0'

  'class_1'

  'class_2'

- å®ä¾‹

  ```python
  from sklearn.datasets import load_wine
  achlo=load_wine()
  
  data=achlo.data
  target=achlo.target
  target=target.reshape(len(target),1)
  achlo_con=np.hstack([data,target])
  col=achlo.feature_names
  col.append('target')
  achlo_show=pd.DataFrame(achlo_con,columns=col)
  
  
  print(achlo_show)
  ```

  ![achol](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/achol.png)

#### 3.6 ä¹³è…ºç™Œæ•°æ®é›†

- è¯­æ³•

  ```python
  from sklearn.datasets import load_breast_cancer
  cancer=load_breast_cancer()
  ```

- ç‰¹å¾

  1.â€Œ**è‚¿ç˜¤çš„å¤§å°ç›¸å…³ç‰¹å¾**â€Œï¼šâ€Œå¦‚åŠå¾„ã€â€Œå‘¨é•¿ã€â€Œé¢ç§¯ç­‰ï¼Œâ€Œè¿™äº›ç‰¹å¾ç›´æ¥åæ˜ äº†è‚¿ç˜¤çš„ç‰©ç†å°ºå¯¸1ã€‚â€Œ

  2.â€Œ**è‚¿ç˜¤çš„å½¢çŠ¶å’Œçº¹ç†ç‰¹å¾**â€Œï¼šâ€Œå¦‚çº¹ç†ï¼ˆâ€Œç°åº¦å€¼çš„æ ‡å‡†åå·®ï¼‰â€Œã€â€Œå¹³æ»‘åº¦ï¼ˆâ€ŒåŠå¾„çš„å˜åŒ–å¹…åº¦ï¼‰â€Œã€â€Œå¯†å®åº¦ï¼ˆâ€Œå‘¨é•¿çš„å¹³æ–¹é™¤ä»¥é¢ç§¯çš„å•†å†å‡1ï¼‰â€Œã€â€Œå‡¹åº¦ï¼ˆâ€Œå‡¹é™·éƒ¨åˆ†è½®å»“çš„ä¸¥é‡ç¨‹åº¦ï¼‰â€Œã€â€Œå‡¹ç‚¹ï¼ˆâ€Œå‡¹é™·è½®å»“çš„æ•°é‡ï¼‰â€Œç­‰ï¼Œâ€Œè¿™äº›ç‰¹å¾æè¿°äº†è‚¿ç˜¤çš„è¡¨é¢å½¢æ€å’Œå†…éƒ¨ç»“æ„12ã€‚â€Œ

  3.â€Œ**å…¶ä»–ç”Ÿç‰©å­¦ç‰¹å¾**â€Œï¼šâ€Œå¦‚å¯¹ç§°æ€§ã€â€Œåˆ†å½¢ç»´åº¦ç­‰ï¼Œâ€Œè¿™äº›ç‰¹å¾æä¾›äº†å…³äºè‚¿ç˜¤ç”Ÿé•¿æ–¹å¼å’Œå¤æ‚æ€§çš„é¢å¤–ä¿¡æ¯

- åˆ†ç±»

  0è¡¨ç¤ºè‰¯æ€§è‚¿ç˜¤

  1è¡¨ç¤ºæ¶æ€§è‚¿ç˜¤

- å®ä¾‹

  ```python
  from sklearn.datasets import load_breast_cancer
  cancer=load_breast_cancer()
  
  data=cancer.data
  target=cancer.target
  target=target.reshape(len(target),1)
  cancer_con=np.hstack([data,target])
  col=cancer.feature_names
  col=list(col)
  col.append('target')
  cancer_show=pd.DataFrame(cancer_con,columns=col)
  
  print(cancer_show)
  ```

  ![cancer](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/cancer.png)

### 4.sklearnè·å–ç°å®ä¸–ç•Œæ•°æ®é›†

#### 4.1è·å–20åˆ†ç±»æ–°é—»æ•°æ®

- æ–‡ä»¶ä¿å­˜ç›®å½•

  ```python
  """
  (1)æ‰€æœ‰ç°å®ä¸–ç•Œæ•°æ®ï¼Œé€šè¿‡ç½‘ç»œæ‰èƒ½ä¸‹è½½åï¼Œé»˜è®¤ä¿å­˜çš„ç›®å½•å¯ä»¥ä½¿ç”¨ä¸‹é¢apiè·å–ã€‚å®é™…ä¸Šå°±æ˜¯ä¿å­˜åˆ°å®¶ç›®å½•
  
  (2)ä¸‹è½½æ—¶ï¼Œæœ‰å¯èƒ½å›ä¸ºç½‘ç»œé—®é¢˜è€Œå‡ºé¢˜ï¼Œè¦â€œå°å¿ƒâ€çš„è§£å†³ç½‘ç»œé—®é¢˜ï¼Œä¸å¯è¨€â€¦..
  
  (3)ç¬¬ä¸€æ¬¡ä¸‹è½½ä¼šä¿å­˜çš„ç¡¬ç›˜ä¸­ï¼Œå¦‚æœç¬¬äºŒæ¬¡ä¸‹è½½ï¼Œå› ä¸ºç¡¬ç›˜ä¸­å·²ç»ä¿å­˜æœ‰äº†ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡ä¸‹è½½å°±ç›´æ¥åŠ è½½æˆåŠŸäº†ã€‚
  
  """
  from sklearn import datasets
  ret=datasets.get_data_home()
  print(ret)
  #C:\Users\13167\scikit_learn_data
  ```

- è¯­æ³•

  ```python
  sklearn.datasets.fetch_20newsgroups(data_home,subset)
  ```

- å‚æ•°

  data_home

  ```python
  =None
  è¿™æ˜¯é»˜è®¤å€¼ï¼Œä¸‹è½½çš„æ–‡ä»¶è·¯å¾„ä¸º â€œC:/Users/ADMIN/scikit_learn_data/20news-bydate_py3.pkzâ€
  
  =è‡ªå®šä¹‰è·¯å¾„
  	ä¾‹å¦‚ â€œ./srcâ€, ä¸‹è½½çš„æ–‡ä»¶è·¯å¾„ä¸ºâ€œ./20news-bydate_py3.pkzâ€
  ```

  subset

  ```python
  â€œtrainâ€ï¼Œåªä¸‹è½½è®­ç»ƒé›†
  â€œtestâ€ï¼Œåªä¸‹è½½æµ‹è¯•é›†
  â€œallâ€ï¼Œ ä¸‹è½½çš„æ•°æ®åŒ…å«äº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
  ```

   return_X_yï¼Œå†³å®šç€è¿”å›å€¼çš„æƒ…å†µ

  ```python
  å½“å‚æ•°return_X_yå€¼ä¸ºFalseæ—¶ï¼Œ å‡½æ•°è¿”å›Bunchå¯¹è±¡,Bunchå¯¹è±¡ä¸­æœ‰ä»¥ä¸‹å±æ€§
      *data:ç‰¹å¾æ•°æ®é›†, é•¿åº¦ä¸º18846çš„åˆ—è¡¨list, æ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ç¯‡æ–°é—»å†…å®¹ï¼Œ å…±æœ‰18846ç¯‡
      *target:ç›®æ ‡æ•°æ®é›†ï¼Œé•¿åº¦ä¸º18846çš„æ•°ç»„ndarray, ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ•´æ•°å€¼ä¸º[0,20]
      *target_names:ç›®æ ‡æè¿°ï¼Œé•¿åº¦ä¸º20çš„list
      *filenamesï¼šé•¿åº¦ä¸º18846çš„ndarray, å…ƒç´ ä¸ºå­—ç¬¦ä¸²,ä»£è¡¨æ–°é—»çš„æ•°æ®ä½ç½®çš„è·¯å¾„
      
  å½“å‚æ•°return_X_yå€¼ä¸ºTrueæ—¶ï¼Œå‡½æ•°è¿”å›å€¼ä¸ºå…ƒç»„ï¼Œå…ƒç»„é•¿åº¦ä¸º2ï¼Œ ç¬¬ä¸€ä¸ªå…ƒç´ å€¼ä¸ºç‰¹å¾æ•°æ®é›†ï¼Œç¬¬äºŒä¸ªå…ƒç´ å€¼ä¸ºç›®æ ‡æ•°æ®é›†
  ```

- å®ä¾‹

  ```python
  from sklearn import datasets
  ret=sklearn.datasets.fetch_20newsgroups(data_home='./',subset='all')
  print(len(ret.data))
  print(ret.target.shape) #(18846,)
  print(ret.target_names) #20
  print(ret.filenames) #18846
  ```

  ![news](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/news.png)

#### 4.2åŠ è½½åŠ åˆ©ç¦å°¼äºšä½æˆ¿æ•°æ®

- è¯­æ³•

  ```python
  fetch_california_housing( *, data_home=None, download_if_missing=True, return_X_y=False, as_frame=False
  )
  ```

- å®ä¾‹

  ```python
  from sklearn import datasets
  ret=datasets.fetch_california_housing(data_home='./',as_frame=True)
  print(ret.data)
  ```

  ![house](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/house.png)

### 5.æœ¬åœ°csvæ•°æ®åˆ›å»ºå’Œä½¿ç”¨

#### 1.åˆ›å»ºcsvæ–‡ä»¶

æ–¹å¼1ï¼šæ‰“å¼€è®¡äº‹æœ¬ï¼Œå†™å‡ºå¦‚ä¸‹æ•°æ®ï¼Œæ•°æ®ä¹‹é—´ä½¿ç”¨è‹±æ–‡ä¸‹çš„é€—å·, ä¿å­˜æ–‡ä»¶åæŠŠåç¼€åæ”¹ä¸ºcsv

```python
milage,Liters,Consumtime,target
40920,8.326976,0.953952,3
14488,7.153469,1.673904,2
26052,1.441871,0.805124,1
75136,13.147394,0.428964,1
```

æ–¹å¼2ï¼šåˆ›å»ºexcel æ–‡ä»¶,  å¡«å†™æ•°æ®ï¼Œä»¥csvä¸ºåç¼€ä¿å­˜æ–‡ä»¶

#### 2.pandasåŠ è½½csv

```py
test=pd.read_csv('test1.csv')
print(test)
```

![csv](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/csv.png)

### 6.æ•°æ®é›†åˆ’åˆ†

#### 1.å‡½æ•°

```python
sklearn.model_selection.train_test_split(*arraysï¼Œ**options)

"""
(1) *array 
	è¿™é‡Œç”¨äºæ¥æ”¶1åˆ°å¤šä¸ª"åˆ—è¡¨ã€numpyæ•°ç»„ã€ç¨€ç–çŸ©é˜µæˆ–padasä¸­çš„DataFrame"ã€‚	
	
(2) **optionsï¼Œ é‡è¦çš„å…³é”®å­—å‚æ•°æœ‰ï¼š
 	    test_size å€¼ä¸º0.0åˆ°1.0çš„å°æ•°ï¼Œè¡¨ç¤ºåˆ’åˆ†åæµ‹è¯•é›†å çš„æ¯”ä¾‹
        random_state å€¼ä¸ºä»»æ„æ•´æ•°ï¼Œè¡¨ç¤ºéšæœºç§å­ï¼Œä½¿ç”¨ç›¸åŒçš„éšæœºç§å­å¯¹ç›¸åŒçš„æ•°æ®é›†å¤šæ¬¡åˆ’åˆ†ç»“æœæ˜¯ç›¸åŒçš„ã€‚å¦åˆ™å¤šåŠä¸åŒ
        
(3)è¿”å›å€¼è¯´æ˜
	è¿”å›å€¼ä¸ºåˆ—è¡¨list, åˆ—è¡¨é•¿åº¦ä¸å½¢å‚arrayæ¥æ”¶åˆ°çš„å‚æ•°æ•°é‡ç›¸å…³è”, å½¢å‚arrayæ¥æ”¶åˆ°çš„æ˜¯ä»€ä¹ˆç±»å‹ï¼Œlistä¸­å¯¹åº”è¢«åˆ’åˆ†å‡ºæ¥çš„ä¸¤éƒ¨åˆ†å°±æ˜¯ä»€ä¹ˆç±»å‹
"""
```

#### 2.åˆ—è¡¨æ•°æ®é›†åˆ’åˆ†

```python
from sklearn.model_selection import train_test_split
data1 = [1,    2,    3,    4,    5]
data2 = ["1a", "2a","3a", "4a",  "5a"]
#éšæœºç§å­éƒ½ä½¿ç”¨äº†ç›¸åŒçš„æ•´æ•°(11)ï¼Œæ‰€ä»¥åˆ’åˆ†çš„åˆ’åˆ†çš„æƒ…å†µæ˜¯ç›¸åŒçš„ã€‚
a, b = train_test_split(data1, test_size=0.1, random_state=11)
print(a, b)
#[5, 1, 4, 2] [3]
a, b = train_test_split(data2, test_size=0.1, random_state=11)
print(a, b)
#['5a', '1a', '4a', '2a'] ['3a']
a, b, c, d  = train_test_split(data1, data2,  test_size=0.1, random_state=11)
print(a,b,c,d)
#[5, 1, 4, 2] [3] ['5a', '1a', '4a', '2a'] ['3a']
```

#### 3.ndarrayæ•°æ®é›†åˆ’åˆ†

```python
#åˆ’åˆ†å‰å’Œåˆ’åˆ†åçš„æ•°æ®ç±»å‹æ˜¯ç›¸åŒçš„
data1 = [1,    2,    3,    4,    5]
data2 = np.array(["1a", "2a","3a", "4a",  "5a"]) 
a, b, c, d  = train_test_split(data1, data2,  test_size=0.4, random_state=22)
print(a, b, c, d)  
#[4, 1, 5] [2, 3] ['4a' '1a' '5a'] ['2a' '3a']
print(type(a), type(b), type(c), type(d)) 
#<class 'list'> <class 'list'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
```

#### 4.äºŒç»´æ•°ç»„æ•°æ®é›†åˆ’åˆ†

```python
from sklearn.model_selection import train_test_split
import numpy as np
data1 = np.arange(1, 16, 1)
data1.shape=(5,3)
print(data1)
a, b = train_test_split(data1,  test_size=0.4, random_state=22)
print(a)
print(b)

"""
[[ 1  2  3]
 [ 4  5  6]
 [ 7  8  9]
 [10 11 12]
 [13 14 15]]
 
 [[10 11 12]
 [ 1  2  3]
 [13 14 15]]

 [[4 5 6]
 [7 8 9]]

"""
```

#### 5.DataFrameæ•°æ®é›†åˆ’åˆ†

```python
from sklearn.model_selection import train_test_split
import numpy as np
import pandas as pd
#å¯ä»¥åˆ’åˆ†DataFrame, åˆ’åˆ†åçš„ä¸¤éƒ¨åˆ†è¿˜æ˜¯DataFrame
data1 = np.arange(1, 16, 1)
data1.shape=(5,3)
data1 = pd.DataFrame(data1, index=[1,2,3,4,5], columns=["one","two","three"])
print(data1)

a, b = train_test_split(data1,  test_size=0.4, random_state=22)
print(a)
print(b)

"""
 one  two  three
1    1    2      3
2    4    5      6
3    7    8      9
4   10   11     12
5   13   14     15

    one  two  three
4   10   11     12
1    1    2      3
5   13   14     15

    one  two  three
2    4    5      6
3    7    8      9

"""
```

#### 6.å­—å…¸æ•°æ®é›†åˆ’åˆ†

```python
"""
å¯ä»¥åˆ’åˆ†éç¨€ç–çŸ©é˜µ

ç”¨äºå°†å­—å…¸åˆ—è¡¨è½¬æ¢ä¸ºç‰¹å¾å‘é‡ã€‚è¿™ä¸ªè½¬æ¢å™¨ä¸»è¦ç”¨äºå¤„ç†ç±»åˆ«æ•°æ®å’Œæ•°å€¼æ•°æ®çš„æ··åˆå‹æ•°æ®é›†

1.å¯¹äºç±»åˆ«ç‰¹å¾`DictVectorizer` ä¼šä¸ºæ¯ä¸ªä¸åŒçš„ç±»åˆ«åˆ›å»ºä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶ç‰¹å¾ï¼Œå¦‚æœåŸå§‹æ•°æ®ä¸­çš„æŸä¸ªæ ·æœ¬å…·æœ‰è¯¥ç±»åˆ«ï¼Œåˆ™å¯¹åº”çš„äºŒè¿›åˆ¶ç‰¹å¾å€¼ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚

2.å¯¹äºæ•°å€¼ç‰¹å¾ä¿æŒä¸å˜ï¼Œç›´æ¥ä½œä¸ºç‰¹å¾çš„ä¸€éƒ¨åˆ†
"""
```

```python
from sklearn.feature_extraction import DictVectorizer
data = [{'city':'æˆéƒ½', 'age':30, 'temperature':20}, 
        {'city':'é‡åº†','age':33, 'temperature':60}, 
        {'city':'åŒ—äº¬', 'age':42, 'temperature':80},
        {'city':'ä¸Šæµ·', 'age':22, 'temperature':70},
        {'city':'æˆéƒ½', 'age':72, 'temperature':40},
       ]
transfer = DictVectorizer(sparse=True)
data_new = transfer.fit_transform(data)
print("data_new:\n", data_new)
x = data_new.toarray()
print(type(x))
print(x)
"""
(0,0)æ˜¯çŸ©é˜µçš„è¡Œåˆ—ä¸‹æ ‡  30æ˜¯å€¼
data_new:
  (0, 0)	30.0
  (0, 3)	1.0
  (0, 5)	20.0
  (1, 0)	33.0
  (1, 4)	1.0
  (1, 5)	60.0
  (2, 0)	42.0
  (2, 2)	1.0
  (2, 5)	80.0
  (3, 0)	22.0
  (3, 1)	1.0
  (3, 5)	70.0
  (4, 0)	72.0
  (4, 3)	1.0
  (4, 5)	40.0
<class 'numpy.ndarray'>
# ç¬¬ä¸€è¡Œä¸­:30è¡¨ç¤ºageçš„å€¼  0è¡¨ç¤ºä¸Šæµ· 0è¡¨ç¤ºåŒ—äº¬ 1è¡¨ç¤ºæˆéƒ½ 0è¡¨ç¤ºé‡åº† 20è¡¨ç¤ºtemperature
[[30.  0.  0.  1.  0. 20.]
 [33.  0.  0.  0.  1. 60.]
 [42.  0.  1.  0.  0. 80.]
 [22.  1.  0.  0.  0. 70.]
 [72.  0.  0.  1.  0. 40.]]

"""
```

```python
a, b = train_test_split(data_new,  test_size=0.4, random_state=22)
print(a)
print("\n", b)

"""
  (0, 0)	22.0
  (0, 1)	1.0
  (0, 5)	70.0
  (1, 0)	30.0
  (1, 3)	1.0
  (1, 5)	20.0
  (2, 0)	72.0
  (2, 3)	1.0
  (2, 5)	40.0

  (0, 0)	33.0
  (0, 4)	1.0
  (0, 5)	60.0
  (1, 0)	42.0
  (1, 2)	1.0
  (1, 5)	80.0


"""
```

```python
#data_new.toarray()æ˜¯ndarray
a, b = train_test_split(data_new.toarray(),  test_size=0.4, random_state=22)
print(a)
print("\n", b)
"""
[[22.  1.  0.  0.  0. 70.]
 [30.  0.  0.  1.  0. 20.]
 [72.  0.  0.  1.  0. 40.]]

 [[33.  0.  0.  0.  1. 60.]
 [42.  0.  1.  0.  0. 80.]]

"""
```

#### 7.é¸¢å°¾èŠ±æ•°æ®é›†åˆ’åˆ†

```python
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
iris = load_iris()
list = train_test_split(iris.data,iris.target,  test_size=0.2, random_state=22)
#x_trainè®­ç»ƒç‰¹å¾æ•°æ®é›†,x_testæµ‹è¯•ç‰¹å¾æ•°æ®é›†, y_trainè®­ç»ƒç›®æ ‡æ•°æ®é›†,y_testæµ‹è¯•ç›®æ ‡æ•°æ®é›†,
x_train, x_test, y_train, y_test = list   
#(120, 4) (30, 4) (120,) (30,)
print(x_train.shape, x_test.shape, y_train.shape, y_test.shape)
```

#### 8.ç°å®ä¸–ç•Œæ•°æ®é›†åˆ’åˆ†

```python
from sklearn.datasets import fetch_20newsgroups
from sklearn.model_selection import train_test_split
import numpy as np
news = fetch_20newsgroups(data_home='./', subset='all')
list = train_test_split(news.data, news.target,test_size=0.2, random_state=22)
# """
# è¿”å›å€¼æ˜¯ä¸€ä¸ªlist:å…¶ä¸­æœ‰4ä¸ªå€¼ï¼Œåˆ†åˆ«ä¸ºè®­ç»ƒé›†ç‰¹å¾ã€æµ‹è¯•é›†ç‰¹å¾ã€è®­ç»ƒé›†ç›®æ ‡ã€æµ‹è¯•é›†ç›®æ ‡
x_train, x_test, y_train, y_test = list
# 15076 3770 (15076,) (3770,)
print(len(x_train), len(x_test), y_train.shape, y_test.shape) 
```

```python
#â€œåŠ è½½åŠ åˆ©ç¦å°¼äºšä½æˆ¿æ•°æ®é›†â€,å¹¶è¿›è¡Œæ•°æ®é›†åˆ’åˆ†
from sklearn import datasets
ret=datasets.fetch_california_housing(data_home='./',as_frame=True)
list=train_test_split(ret.data,ret.target,test_size=0.2,random_state=22)
x_train,x_target,y_train,y_target=list
print(x_train,x_target)
print(y_train,y_target)

```
## ç‰¹å¾å·¥ç¨‹

### 1.ç‰¹å¾å·¥ç¨‹æ¦‚å¿µ

- å®šä¹‰

  ç‰¹å¾å·¥ç¨‹æ˜¯å°†ä»»æ„æ•°æ®(å¦‚æ–‡æœ¬æˆ–å›¾åƒ)è½¬æ¢ä¸ºå¯ç”¨äºæœºå™¨å­¦ä¹ çš„**æ•°å­—ç‰¹å¾**,æ¯”å¦‚:å­—å…¸ç‰¹å¾æå–(ç‰¹å¾ç¦»æ•£åŒ–)ã€æ–‡æœ¬ç‰¹å¾æå–ã€å›¾åƒç‰¹å¾æå–ã€‚

- æ­¥éª¤

  - ç‰¹å¾æå–ï¼Œ å¦‚æœä¸æ˜¯è¡¨æ ¼æ•°æ®ï¼Œè¦è¿›è¡Œç‰¹å¾æå–ï¼Œæ¯”å¦‚å­—å…¸ç‰¹å¾æå–ï¼Œæ–‡æœ¬ç‰¹å¾æå–

  - æ— é‡åˆšåŒ–(é¢„å¤„ç†)

    - å½’ä¸€åŒ–
    - æ ‡å‡†åŒ–

  - é™ç»´

    - åº•æ–¹å·®è¿‡æ»¤ç‰¹å¾é€‰æ‹©

    - ä¸»æˆåˆ†åˆ†æ-PCAé™ç»´

### 2.ç‰¹å¾å·¥ç¨‹ç›¸å…³API

- å®ä¾‹åŒ–è½¬æ¢å™¨ç±»å¯¹è±¡

  ```python
  DictVectorizer  	å­—å…¸ç‰¹å¾æå–
  CountVectorizer 	æ–‡æœ¬ç‰¹å¾æå–
  TfidfVectorizer 	TF-IDFæ–‡æœ¬ç‰¹å¾è¯çš„é‡è¦ç¨‹åº¦ç‰¹å¾æå– 
  MinMaxScaler 		å½’ä¸€åŒ–
  StandardScaler 		æ ‡å‡†åŒ–
  VarianceThreshold 	åº•æ–¹å·®è¿‡æ»¤é™ç»´
  PCA  				ä¸»æˆåˆ†åˆ†æé™ç»´
  ```

- è½¬æ¢å™¨å¯¹è±¡è°ƒç”¨

  ```python
  """
  fit_transform()è¿›è¡Œè½¬æ¢, å…¶ä¸­fitç”¨äºè®¡ç®—æ•°æ®ï¼Œtransformè¿›è¡Œæœ€ç»ˆè½¬æ¢
  fit_transform()å¯ä»¥ä½¿ç”¨fit()å’Œtransform()ä»£æ›¿
  """
  data_new = transfer.fit_transform(data)
  å¯å†™æˆ
  transfer.fit(data)
  data_new = transfer.transform(data)
  ```



### 3.ç‰¹å¾å·¥ç¨‹å­˜å‚¨å½¢å¼

- ç¨€ç–çŸ©é˜µå®šä¹‰

  ç¨€ç–çŸ©é˜µæ˜¯æŒ‡ä¸€ä¸ªçŸ©é˜µä¸­å¤§éƒ¨åˆ†å…ƒç´ ä¸ºé›¶ï¼Œåªæœ‰å°‘æ•°å…ƒç´ æ˜¯éé›¶çš„çŸ©é˜µï¼Œä¸”éé›¶å…ƒç´ åˆ†å¸ƒæ²¡æœ‰æ˜æ˜¾çš„è§„å¾‹ã€‚

- ä¸‰å…ƒç»„è¡¨

  ä¸‰å…ƒç»„è¡¨å°±æ˜¯ä¸€ç§ç¨€ç–çŸ©é˜µç±»å‹æ•°æ®,å­˜å‚¨éé›¶å…ƒç´ çš„è¡Œç´¢å¼•ã€åˆ—ç´¢å¼•å’Œå€¼ã€‚é™¤äº†åˆ—å‡ºçš„æœ‰å€¼, å…¶ä½™å…¨æ˜¯0ã€‚

  ```python
  (0,0) 10
  
  (0,1) 20
  
  (2,0) 90
  
  (2,20) 8
  
  (8,0) 70
  ```

- ç¨ å¯†çŸ©é˜µ

  çŸ©é˜µä¸­éé›¶å…ƒç´ çš„æ•°é‡ä¸æ€»å…ƒç´ æ•°é‡ç›¸æ¯”æ¥è¿‘æˆ–ç›¸ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´çŸ©é˜µä¸­çš„å¤§éƒ¨åˆ†å…ƒç´ éƒ½æ˜¯éé›¶çš„ã€‚

- æ€»ç»“

  - **å­˜å‚¨**ï¼šç¨€ç–çŸ©é˜µä½¿ç”¨ç‰¹å®šçš„å­˜å‚¨æ ¼å¼æ¥èŠ‚çœç©ºé—´ï¼Œè€Œç¨ å¯†çŸ©é˜µä½¿ç”¨å¸¸è§„çš„æ•°ç»„å­˜å‚¨æ‰€æœ‰å…ƒç´ ï¼Œæ— è®ºå…¶æ˜¯å¦ä¸ºé›¶ã€‚
  - **è®¡ç®—**ï¼šç¨€ç–çŸ©é˜µåœ¨è¿›è¡Œè®¡ç®—æ—¶å¯ä»¥åˆ©ç”¨é›¶å…ƒç´ çš„ç‰¹æ€§è·³è¿‡ä¸å¿…è¦çš„è®¡ç®—ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚è€Œç¨ å¯†çŸ©é˜µåœ¨è®¡ç®—æ—¶éœ€è¦å¤„ç†æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬é›¶å…ƒç´ ã€‚
  - **åº”ç”¨é¢†åŸŸ**ï¼šç¨€ç–çŸ©é˜µå¸¸è§äºå¤§è§„æ¨¡æ•°æ®åˆ†æã€å›¾å½¢å­¦ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€æœºå™¨å­¦ä¹ ç­‰é¢†åŸŸï¼Œè€Œç¨ å¯†çŸ©é˜µåœ¨æ•°å­¦è®¡ç®—ã€çº¿æ€§ä»£æ•°ç­‰é€šç”¨è®¡ç®—é¢†åŸŸæ›´ä¸ºå¸¸è§ã€‚

### 4.DictVectorizer å­—å…¸åˆ—è¡¨ç‰¹å¾æå–

- è¯­æ³•

  ```python
  #åˆ›å»ºè½¬æ¢å™¨å¯¹è±¡
  sklearn.feature_extraction.DictVectorizer(sparse=True)
  """
  sparse=Trueè¿”å›ç±»å‹ä¸ºcsr_matrixçš„ç¨€ç–çŸ©é˜µ
  
  sparse=Falseè¡¨ç¤ºè¿”å›çš„æ˜¯æ•°ç»„,æ•°ç»„å¯ä»¥è°ƒç”¨.toarray()æ–¹æ³•å°†ç¨€ç–çŸ©é˜µè½¬æ¢ä¸ºæ•°ç»„
  """
  ```

  ```python
  #è½¬æ¢å™¨å¯¹è±¡
  """
  è½¬æ¢å™¨å¯¹è±¡è°ƒç”¨fit_transform(data)å‡½æ•°ï¼Œå‚æ•°dataä¸ºä¸€ç»´å­—å…¸æ•°ç»„æˆ–ä¸€ç»´å­—å…¸åˆ—è¡¨,è¿”å›è½¬åŒ–åçš„çŸ©é˜µæˆ–æ•°ç»„
  
  è½¬æ¢å™¨å¯¹è±¡get_feature_names_out()æ–¹æ³•è·å–ç‰¹å¾å
  """
  ```

- å®ä¾‹:æå–ç¨€ç–çŸ©é˜µå¯¹åº”çš„æ•°ç»„

  ```python
  from sklearn.feature_extraction import DictVectorizer
  data=[
      {"name":"jack","age":23,"money":1000,"com":"å°ç±³"},
       {"name":"rose","age":33,"money":2000,"com":"è…¾è®¯"},
        {"name":"marry","age":83,"money":25,"com":"è‹¹æœ"},
         {"name":"joe","age":123,"money":899,"com":"å°ç±³"},
          {"name":"å°è’‹","age":33,"money":1,"com":"åæ¸…"},
  ]
  dict=DictVectorizer(sparse=False)
  """
  sparse=Trueè¿”å›ç±»å‹ä¸ºcsr_matrixçš„ç¨€ç–çŸ©é˜µ
  
  sparse=Falseè¡¨ç¤ºè¿”å›çš„æ˜¯æ•°ç»„,æ•°ç»„å¯ä»¥è°ƒç”¨.toarray()æ–¹æ³•å°†ç¨€ç–çŸ©é˜µè½¬æ¢ä¸ºæ•°ç»„
  """
  data=dict.fit_transform(data)
  """
  fit_transform()è¿›è¡Œè½¬æ¢, å…¶ä¸­fitç”¨äºè®¡ç®—æ•°æ®ï¼Œtransformè¿›è¡Œæœ€ç»ˆè½¬æ¢
  fit_transform()å¯ä»¥ä½¿ç”¨fit()å’Œtransform()ä»£æ›¿
  """
  print(dict.get_feature_names_out())
  #è·å–ç‰¹å¾æ ‡ç­¾
  print(data)
  ```

  ![dict_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/dict_1.png)

- å®ä¾‹ï¼šæå–ç¨€ç–çŸ©é˜µ

  ```python
  from sklearn.feature_extraction import DictVectorizer
  data=[
      {"name":"jack","age":23,"money":1000,"com":"å°ç±³"},
       {"name":"rose","age":33,"money":2000,"com":"è…¾è®¯"},
        {"name":"marry","age":83,"money":25,"com":"è‹¹æœ"},
         {"name":"joe","age":123,"money":899,"com":"å°ç±³"},
          {"name":"å°è’‹","age":33,"money":1,"com":"åæ¸…"},
  ]
  dict=DictVectorizer(sparse=True)
  """
  sparse=Trueè¿”å›ç±»å‹ä¸ºcsr_matrixçš„ç¨€ç–çŸ©é˜µ
  
  sparse=Falseè¡¨ç¤ºè¿”å›çš„æ˜¯æ•°ç»„,æ•°ç»„å¯ä»¥è°ƒç”¨.toarray()æ–¹æ³•å°†ç¨€ç–çŸ©é˜µè½¬æ¢ä¸ºæ•°ç»„
  """
  data=dict.fit_transform(data)
  """
  fit_transform()è¿›è¡Œè½¬æ¢, å…¶ä¸­fitç”¨äºè®¡ç®—æ•°æ®ï¼Œtransformè¿›è¡Œæœ€ç»ˆè½¬æ¢
  fit_transform()å¯ä»¥ä½¿ç”¨fit()å’Œtransform()ä»£æ›¿
  """
  print(dict.get_feature_names_out())
  #è·å–ç‰¹å¾æ ‡ç­¾
  print(data)
  ```

  ![dict_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/dict_2.png)

### 5.CountVectorizer æ–‡æœ¬ç‰¹å¾æå–

- è¯­æ³•

  ```python
  sklearn.feature_extraction.text.CountVectorizer
  """
  CountVectorizer()æ„é€ å‡½æ•°å…³é”®å­—å‚æ•°stop_wordsï¼Œå€¼ä¸ºlistï¼Œè¡¨ç¤ºè¯çš„é»‘åå•
  
  fit_transformå‡½æ•°çš„è¿”å›å€¼ä¸ºç¨€ç–çŸ©é˜µ
  
  """
  ```

- å®ä¾‹ï¼šè‹±æ–‡æ–‡æœ¬æå–

  ```python
  from sklearn.feature_extraction.text import CountVectorizer
  data=['man','what can i say','manba out','say man i am']
  count=CountVectorizer(stop_words=['man'])#è¿‡æ»¤æ‰manå•è¯
  data=count.fit_transform(data).toarray()#è½¬åŒ–ä¸ºæ•°ç»„
  data_show=pd.DataFrame(data,index=['ç¬¬ä¸€','ç¬¬äºŒ','ç¬¬ä¸‰','ç¬¬å››'],columns=count.get_feature_names_out())
  print(data_show)
  ```

  ![count_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/count_1.png)

- å®ä¾‹ï¼šä¸­æ–‡æ–‡æœ¬æå–

  ```python
  #a.ä¸­æ–‡æ–‡æœ¬ä¸åƒè‹±æ–‡æ–‡æœ¬ï¼Œä¸­æ–‡æ–‡æœ¬æ–‡å­—ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥è¦å…ˆåˆ†è¯ï¼Œä¸€èˆ¬ä½¿ç”¨jiebaåˆ†è¯.
  
  data = "åœ¨å¦‚ä»Šçš„äº’è”ç½‘ä¸–ç•Œï¼Œæ­£èƒ½é‡æ­£æˆä¸ºæ¾æ¹ƒæ—¶ä»£çš„å¤§æµé‡"
  data = jieba.cut(data)
  data = list(data)
  print(data) #['åœ¨', 'å¦‚ä»Š', 'çš„', 'äº’è”ç½‘', 'ä¸–ç•Œ', 'ï¼Œ', 'æ­£', 'èƒ½é‡', 'æ­£', 'æˆä¸º', 'æ¾æ¹ƒ', 'æ—¶ä»£', 'çš„', 'å¤§', 'æµé‡']
  data = "".join(data)
  print(data) #"åœ¨å¦‚ä»Šçš„äº’è”ç½‘ä¸–ç•Œ ï¼Œæ­£èƒ½é‡æ­£æˆä¸ºæ¾æ¹ƒæ—¶ä»£çš„å¤§æµé‡"
  ```

  ```python
  def china_txt(txt):
      return ' '.join(list(jieba.cut(txt)))
  
  data=['çº½çº¦è”å‚¨è°ƒæŸ¥æ˜¾ç¤ºå¤±ä¸šé¢„æœŸåˆ›å†å²æ–°é«˜','å¾·å…‹è¨æ–¯ç”µç½‘é¢ä¸´å¤å­£æœ€å¤§è€ƒéªŒ','å¾·å…‹è¨æ–¯å’Œçº½çº¦']
  data_new=[china_txt(x) for x in data]
  count=CountVectorizer()
  count_data=count.fit_transform(data_new).toarray()
  data_show=pd.DataFrame(count_data,columns=count.get_feature_names_out())
  
  print(data_show)
  ```

  ![count_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/count_2.png)

### 6.TfidfVectorizer TF-IDF æ–‡æœ¬ç‰¹å¾è¯çš„é‡è¦ç¨‹åº¦ç‰¹å¾æå– 

- ç®—æ³•

  ![compute](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/compute.png)

- è¯­æ³•

  ```python
  sklearn.feature_extraction.text.TfidfVectorizer()
  """
  æ„é€ å‡½æ•°å…³é”®å­—å‚æ•°stop_wordsï¼Œè¡¨ç¤ºè¯ç‰¹å¾é»‘åå•
  
  fit_transformå‡½æ•°çš„è¿”å›å€¼ä¸ºç¨€ç–çŸ©é˜µ
  """
  ```

- å®ä¾‹

  ```python
  from sklearn.feature_extraction.text import TfidfVectorizer
  
  def china_txt(txt):
      return ' '.join(list(jieba.cut(txt)))
  
  data=['çº½çº¦è”å‚¨è°ƒæŸ¥æ˜¾ç¤ºå¤±ä¸šé¢„æœŸåˆ›å†å²æ–°é«˜','å¾·å…‹è¨æ–¯ç”µç½‘é¢ä¸´å¤å­£æœ€å¤§è€ƒéªŒ','å¾·å…‹è¨æ–¯å’Œçº½çº¦']
  data_new=[china_txt(x) for x in data]
  count=TfidfVectorizer(stop_words=['é¢„æœŸ','è€ƒéªŒ'])
  count_data=count.fit_transform(data_new).toarray()
  data_show=pd.DataFrame(count_data,columns=count.get_feature_names_out())
  print(count.get_feature_names_out())
  print(count_data)
  ```

  ![tf](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tf.png)

### 7.æ— é‡çº²åŒ–-é¢„å¤„ç†

- å®šä¹‰

  æ— é‡çº²ï¼Œå³æ²¡æœ‰å•ä½çš„æ•°æ®

- ä¸¾ä¾‹è¯´æ˜

  | ç¼–å·id | èº«é«˜ h   | æ”¶å…¥ s    | ä½“é‡ w  |
  | ------ | -------- | --------- | ------- |
  | 1      | 1.75(ç±³) | 15000(å…ƒ) | 120(æ–¤) |
  | 2      | 1.5(ç±³)  | 16000(å…ƒ) | 140(æ–¤) |
  | 3      | 1.6(ç±³)  | 20000(å…ƒ) | 100(æ–¤) |

  å‡è®¾ç®—æ³•ä¸­éœ€è¦æ±‚å®ƒä»¬ä¹‹é—´çš„æ¬§å¼è·ç¦», è¿™é‡Œä»¥ç¼–å·1å’Œç¼–å·2ä¸ºç¤ºä¾‹:

  $L = \sqrt{(1.75-1.5)^2+(15000-16000)^2+(120-140)^2}$

  ä»è®¡ç®—ä¸Šæ¥çœ‹, å‘ç°èº«é«˜å¯¹è®¡ç®—ç»“æœæ²¡æœ‰ä»€ä¹ˆå½±å“, åŸºæœ¬ä¸»è¦ç”±æ”¶å…¥æ¥å†³å®šäº†,ä½†æ˜¯ç°å®ç”Ÿæ´»ä¸­,èº«é«˜æ˜¯æ¯”è¾ƒé‡è¦çš„åˆ¤æ–­æ ‡å‡†.  æ‰€ä»¥éœ€è¦æ— é‡çº²åŒ–.

#### 1.MinMaxScaler å½’ä¸€åŒ–

- å®šä¹‰

  é€šè¿‡å¯¹åŸå§‹æ•°æ®è¿›è¡Œå˜æ¢æŠŠæ•°æ®æ˜ å°„åˆ°æŒ‡å®šåŒºé—´**(é»˜è®¤ä¸º0-1)**

- å…¬å¼

  ![G_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/G_1.png)

  è¿™é‡Œçš„ ğ‘¥min å’Œ ğ‘¥max åˆ†åˆ«æ˜¯æ¯ç§ç‰¹å¾ä¸­çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œè€Œ ğ‘¥æ˜¯å½“å‰ç‰¹å¾å€¼ï¼Œğ‘¥scaled æ˜¯å½’ä¸€åŒ–åçš„ç‰¹å¾å€¼ã€‚

  è‹¥è¦ç¼©æ”¾åˆ°å…¶ä»–åŒºé—´ï¼Œå¯ä»¥ä½¿ç”¨å…¬å¼ï¼š**x=x*(max-min)+min**

  æ¯”å¦‚ [-1, 1]çš„å…¬å¼ä¸º:

  ![G_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/G_2.png)

  æ‰‹ç®—è¿‡ç¨‹:

  ![G_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/G_3.png)

- è¯­æ³•

  ```python
  sklearn.preprocessing.MinMaxScaler(feature_range)
  """
  å‚æ•°:feature_range=(0,1) å½’ä¸€åŒ–åçš„å€¼åŸŸ,å¯ä»¥è‡ªå·±è®¾å®š
  
  fit_transformå‡½æ•°å½’ä¸€åŒ–çš„åŸå§‹æ•°æ®ç±»å‹å¯ä»¥æ˜¯listã€DataFrameå’Œndarray, ä¸å¯ä»¥æ˜¯ç¨€ç–çŸ©é˜µ
  
  fit_transformå‡½æ•°çš„è¿”å›å€¼ä¸ºndarray
  
  """
  ```

- å®ä¾‹ï¼šlistæ•°æ®å½’ä¸€åŒ–

  ```python
  from sklearn.preprocessing import MinMaxScaler
  data=[[110,1243,23255,238423,42314],
        [103,1223,23535,234423,42335],
        [103,1223,23535,234423,42332],
        [103,1223,23535,234423,42339],
        [103,1223,23535,234423,42330],
        [103,1223,23535,234423,42331],
        [170,1253,23755,234223,10]]
  scale=MinMaxScaler(feature_range=(0,1))
  data=scale.fit_transform(data)
  print(data)
  ```

  ![min_max_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/min_max_1.png)

- å®ä¾‹ï¼šdataFrameæ•°æ®å½’ä¸€åŒ–

  ```python
  from sklearn.preprocessing import MinMaxScaler
  scale=MinMaxScaler(feature_range=(0,1))
  data=[[12,22,4],[22,23,1],[11,23,9]]
  data = pd.DataFrame(data=data, index=["ä¸€","äºŒ","ä¸‰"], columns=["ä¸€åˆ—","äºŒåˆ—","ä¸‰åˆ—"])
  data_show=scale.fit_transform(data)
  print(data_show)
  ```

  ![min_max_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/min_max_2.png)

- å®ä¾‹ï¼šndarrayæ•°æ®å½’ä¸€åŒ–

  ```python
  from sklearn.preprocessing import MinMaxScaler
  data=[
      {"name":"jack","age":23,"money":1000,"com":"å°ç±³"},
       {"name":"rose","age":33,"money":2000,"com":"è…¾è®¯"},
        {"name":"marry","age":83,"money":25,"com":"è‹¹æœ"},
         {"name":"joe","age":123,"money":899,"com":"å°ç±³"},
          {"name":"å°è’‹","age":33,"money":1,"com":"åæ¸…"},
  ]
  scale=MinMaxScaler()
  dict=DictVectorizer()
  data_dict=dict.fit_transform(data).toarray()
  data_scale=scale.fit_transform(data_dict)
  print(data_scale)
  ```

  ![min_max_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/min_max_3.png)

- ç¼ºç‚¹

  æœ€å¤§å€¼å’Œæœ€å°å€¼å®¹æ˜“å—åˆ°å¼‚å¸¸ç‚¹å½±å“ï¼Œæ‰€ä»¥**é²æ§æ€§(å¥å£®æ€§)**è¾ƒå·®ã€‚æ‰€ä»¥å¸¸ä½¿ç”¨æ ‡å‡†åŒ–çš„æ— é‡é’¢åŒ–

#### 2.StandardScaler æ ‡å‡†åŒ–

- å®šä¹‰

  æ ‡å‡†åŒ–æ˜¯ä¸€ç§æ•°æ®é¢„å¤„ç†æŠ€æœ¯ï¼Œä¹Ÿç§°ä¸ºæ•°æ®å½’ä¸€åŒ–æˆ–ç‰¹å¾ç¼©æ”¾ã€‚å®ƒçš„ç›®çš„æ˜¯å°†ä¸åŒç‰¹å¾çš„æ•°å€¼èŒƒå›´ç¼©æ”¾åˆ°ç»Ÿä¸€çš„æ ‡å‡†èŒƒå›´ï¼Œä»¥ä¾¿æ›´å¥½åœ°é€‚åº”ä¸€äº›æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯é‚£äº›å¯¹è¾“å…¥æ•°æ®çš„å°ºåº¦æ•æ„Ÿçš„ç®—æ³•ã€‚

- å…¬å¼

  æœ€å¸¸è§çš„æ ‡å‡†åŒ–æ–¹æ³•æ˜¯Z-scoreæ ‡å‡†åŒ–ï¼Œä¹Ÿç§°ä¸ºé›¶å‡å€¼æ ‡å‡†åŒ–ã€‚å®ƒé€šè¿‡å¯¹æ¯ä¸ªç‰¹å¾çš„å€¼å‡å»å…¶å‡å€¼ï¼Œå†é™¤ä»¥å…¶æ ‡å‡†å·®ï¼Œå°†æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„åˆ†å¸ƒã€‚

  ![æ ‡å‡†åŒ–](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/æ ‡å‡†åŒ–.png)

  å…¶ä¸­ï¼Œzæ˜¯è½¬æ¢åçš„æ•°å€¼ï¼Œxæ˜¯åŸå§‹æ•°æ®çš„å€¼ï¼ŒÎ¼æ˜¯è¯¥ç‰¹å¾çš„å‡å€¼ï¼ŒÏƒæ˜¯è¯¥ç‰¹å¾çš„æ ‡å‡†å·®

- è¯­æ³•

  ```python
  sklearn.preprocessing.StandardScale
  """
  ä¸MinMaxScalerä¸€æ ·ï¼ŒåŸå§‹æ•°æ®ç±»å‹å¯ä»¥æ˜¯listã€DataFrameå’Œndarray
  
  fit_transformå‡½æ•°çš„è¿”å›å€¼ä¸ºndarray,   å½’ä¸€åŒ–åå¾—åˆ°çš„æ•°æ®ç±»å‹éƒ½æ˜¯ndarray
  """
  ```

- å®ä¾‹

  ```python
  from sklearn.preprocessing import StandardScaler
  data=[
      {"name":"jack","age":23,"money":1000,"com":"å°ç±³"},
       {"name":"rose","age":33,"money":2000,"com":"è…¾è®¯"},
        {"name":"marry","age":83,"money":25,"com":"è‹¹æœ"},
         {"name":"joe","age":123,"money":899,"com":"å°ç±³"},
          {"name":"å°è’‹","age":33,"money":1,"com":"åæ¸…"},
  ]
  scale=StandardScaler()
  dict=DictVectorizer()
  data_dict=dict.fit_transform(data).toarray()
  data_scale=scale.fit_transform(data_dict)
  print('ndarryæ ‡å‡†åŒ–å½’ä¸€ï¼š\n',data_scale)
  
  
  scale=StandardScaler()
  data=[[12,22,4],[22,23,1],[11,23,9]]
  data = pd.DataFrame(data=data, index=["ä¸€","äºŒ","ä¸‰"], columns=["ä¸€åˆ—","äºŒåˆ—","ä¸‰åˆ—"])
  data_show=scale.fit_transform(data)
  print('DataFrameæ ‡å‡†åŒ–å½’ä¸€ï¼š\n',data_show)
  
  
  data=[[110,1243,23255,238423,42314],
        [103,1223,23535,234423,42335],
        [103,1223,23535,234423,42332],
        [103,1223,23535,234423,42339],
        [103,1223,23535,234423,42330],
        [103,1223,23535,234423,42331],
        [170,1253,23755,234223,10]]
  scale=StandardScaler()
  data=scale.fit_transform(data)
  print('listæ ‡å‡†åŒ–å½’ä¸€ï¼š\n',data)
  ```

  ![standard](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/standard.png)

- é‡ç‚¹

  ä½¿ç”¨å¦‚`StandardScaler`è¿™æ ·çš„æ•°æ®è½¬æ¢å™¨æ—¶ï¼Œ`fit`ã€`fit_transform`å’Œ`transform`è¿™ä¸‰ä¸ªæ–¹æ³•çš„ä½¿ç”¨æ˜¯è‡³å…³é‡è¦çš„ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ä½œç”¨ï¼š

  1. **fit**:
     - è¿™ä¸ªæ–¹æ³•ç”¨æ¥è®¡ç®—æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚å‡å€¼å’Œæ ‡å‡†å·®ï¼ˆåœ¨`StandardScaler`çš„æƒ…å†µä¸‹ï¼‰ã€‚è¿™äº›ç»Ÿè®¡ä¿¡æ¯éšåä¼šè¢«ç”¨äºæ•°æ®çš„æ ‡å‡†åŒ–ã€‚
     - ä½ åº”å½“ä»…åœ¨è®­ç»ƒé›†ä¸Šä½¿ç”¨`fit`æ–¹æ³•ã€‚
  2. **fit_transform**:
     - è¿™ä¸ªæ–¹æ³•ç›¸å½“äºå…ˆè°ƒç”¨`fit`å†è°ƒç”¨`transform`ï¼Œä½†æ˜¯å®ƒåœ¨å†…éƒ¨æ‰§è¡Œå¾—æ›´é«˜æ•ˆã€‚
     - å®ƒåŒæ ·åº”å½“ä»…åœ¨è®­ç»ƒé›†ä¸Šä½¿ç”¨ï¼Œå®ƒä¼šè®¡ç®—è®­ç»ƒé›†çš„ç»Ÿè®¡ä¿¡æ¯å¹¶ç«‹å³åº”ç”¨åˆ°è¯¥è®­ç»ƒé›†ä¸Šã€‚
  3. **transform**:
     - è¿™ä¸ªæ–¹æ³•ä½¿ç”¨å·²ç»é€šè¿‡`fit`æ–¹æ³•è®¡ç®—å‡ºçš„ç»Ÿè®¡ä¿¡æ¯æ¥è½¬æ¢æ•°æ®ã€‚
     - å®ƒå¯ä»¥åº”ç”¨äºä»»ä½•æ•°æ®é›†ï¼ŒåŒ…æ‹¬è®­ç»ƒé›†ã€éªŒè¯é›†æˆ–æµ‹è¯•é›†ï¼Œä½†æ˜¯åº”ç”¨æ—¶ä½¿ç”¨çš„ç»Ÿè®¡ä¿¡æ¯å¿…é¡»æ¥è‡ªäºè®­ç»ƒé›†ã€‚

  å½“ä½ åœ¨é¢„å¤„ç†æ•°æ®æ—¶ï¼Œé¦–å…ˆéœ€è¦åœ¨è®­ç»ƒé›†`X_train`ä¸Šä½¿ç”¨`fit_transform`ï¼Œè¿™æ ·åšå¯ä»¥ä¸€æ¬¡æ€§å®Œæˆç»Ÿè®¡ä¿¡æ¯çš„è®¡ç®—å’Œæ•°æ®çš„æ ‡å‡†åŒ–ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦ç¡®ä¿æ¨¡å‹æ˜¯åŸºäºè®­ç»ƒæ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯è¿›è¡Œå­¦ä¹ çš„ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°æ®é›†çš„ç»Ÿè®¡ä¿¡æ¯ã€‚

  **ä¸€æ—¦`scaler`å¯¹è±¡åœ¨`X_train`ä¸Šè¢«`fit`ï¼Œå®ƒå°±å·²ç»çŸ¥é“äº†å¦‚ä½•å°†æ•°æ®æ ‡å‡†åŒ–ã€‚**è¿™æ—¶ï¼Œå¯¹äºæµ‹è¯•é›†`X_test`ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨`transform`æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›åœ¨æµ‹è¯•é›†ä¸Šé‡æ–°è®¡ç®—ä»»ä½•ç»Ÿè®¡ä¿¡æ¯ï¼Œä¹Ÿä¸å¸Œæœ›æµ‹è¯•é›†çš„ä¿¡æ¯å½±å“åˆ°è®­ç»ƒè¿‡ç¨‹ã€‚å¦‚æœæˆ‘ä»¬å¯¹`X_test`ä¹Ÿä½¿ç”¨`fit_transform`ï¼Œæµ‹è¯•é›†çš„ä¿¡æ¯å°±å¯èƒ½ä¼šå½±å“åˆ°è®­ç»ƒè¿‡ç¨‹ã€‚

  **æ€»ç»“æ¥è¯´:æˆ‘ä»¬å¸¸å¸¸æ˜¯å…ˆfit_transform(x_train)ç„¶åå†transform(x_text)**

### 8.ç‰¹å¾é™ç»´

- å®šä¹‰

  é™ç»´å°±æ˜¯å»æ‰ä¸€äº›ç‰¹å¾,æˆ–è€…è½¬åŒ–å¤šä¸ªç‰¹å¾ä¸ºå°‘é‡ä¸ªç‰¹å¾

- ä½œç”¨

  **ç‰¹å¾é™ç»´å…¶ç›®çš„**:æ˜¯å‡å°‘æ•°æ®é›†çš„ç»´åº¦ï¼ŒåŒæ—¶å°½å¯èƒ½ä¿ç•™æ•°æ®çš„é‡è¦ä¿¡æ¯ã€‚

  **ç‰¹å¾é™ç»´çš„å¥½å¤„**:

  å‡å°‘è®¡ç®—æˆæœ¬ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­å¤„ç†æ•°æ®å¯èƒ½éå¸¸è€—æ—¶ä¸”è®¡ç®—å¯†é›†ã€‚é™ç»´å¯ä»¥ç®€åŒ–æ¨¡å‹ï¼Œé™ä½è®­ç»ƒæ—¶é—´å’Œèµ„æºéœ€æ±‚ã€‚

  å»é™¤å™ªå£°ï¼šé«˜ç»´æ•°æ®å¯èƒ½åŒ…å«è®¸å¤šæ— å…³æˆ–å†—ä½™ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å¯èƒ½å¼•å…¥å™ªå£°å¹¶å¯¼è‡´è¿‡æ‹Ÿåˆã€‚é™ç»´å¯ä»¥å¸®åŠ©å»é™¤è¿™äº›ä¸å¿…è¦çš„ç‰¹å¾ã€‚

- æ–¹æ³•

  - ç‰¹å¾é€‰æ‹©
    - ä»åŸå§‹ç‰¹å¾é›†ä¸­æŒ‘é€‰å‡ºæœ€ç›¸å…³çš„ç‰¹å¾
  - ä¸»æˆä»½åˆ†æ(PCA)
    - ä¸»æˆåˆ†åˆ†æå°±æ˜¯æŠŠä¹‹å‰çš„ç‰¹å¾é€šè¿‡ä¸€ç³»åˆ—æ•°å­¦è®¡ç®—ï¼Œå½¢æˆæ–°çš„ç‰¹å¾ï¼Œæ–°çš„ç‰¹å¾æ•°é‡ä¼šå°äºä¹‹å‰ç‰¹å¾æ•°é‡

#### 1.ç‰¹å¾é€‰æ‹©

##### 1.1 VarianceThreshold ä½æ–¹å·®è¿‡æ»¤ç‰¹å¾é€‰æ‹©

- å®šä¹‰

  **Filter(è¿‡æ»¤å¼):** ä¸»è¦æ¢ç©¶ç‰¹å¾æœ¬èº«ç‰¹ç‚¹ï¼Œ ç‰¹å¾ä¸ç‰¹å¾ã€ç‰¹å¾ä¸ç›®æ ‡ å€¼ä¹‹é—´å…³è”

  - æ–¹å·®é€‰æ‹©æ³•: ä½æ–¹å·®ç‰¹å¾è¿‡æ»¤

    å¦‚æœ**ä¸€ä¸ªç‰¹å¾çš„æ–¹å·®å¾ˆå°ï¼Œè¯´æ˜è¿™ä¸ªç‰¹å¾çš„å€¼åœ¨æ ·æœ¬ä¸­å‡ ä¹ç›¸åŒæˆ–å˜åŒ–ä¸å¤§**ï¼ŒåŒ…å«çš„ä¿¡æ¯é‡å¾ˆå°‘ï¼Œæ¨¡å‹å¾ˆéš¾é€šè¿‡è¯¥ç‰¹å¾åŒºåˆ†ä¸åŒçš„å¯¹è±¡,**æ¯”å¦‚åŒºåˆ†ç”œç“œå­å’Œå’¸ç“œå­è¿˜æ˜¯è’œé¦™ç“œå­,å¦‚æœæœ‰ä¸€ä¸ªç‰¹å¾æ˜¯é•¿åº¦,è¿™ä¸ªç‰¹å¾ç›¸å·®ä¸å¤§å¯ä»¥å»æ‰ã€‚**

    1. **è®¡ç®—æ–¹å·®**ï¼šå¯¹äºæ¯ä¸ªç‰¹å¾ï¼Œè®¡ç®—å…¶åœ¨è®­ç»ƒé›†ä¸­çš„æ–¹å·®(**æ¯ä¸ªæ ·æœ¬å€¼ä¸å‡å€¼ä¹‹å·®çš„å¹³æ–¹,åœ¨æ±‚å¹³å‡**)ã€‚
    2. **è®¾å®šé˜ˆå€¼**ï¼šé€‰æ‹©ä¸€ä¸ªæ–¹å·®é˜ˆå€¼ï¼Œä»»ä½•ä½äºè¿™ä¸ªé˜ˆå€¼çš„ç‰¹å¾éƒ½å°†è¢«è§†ä¸ºä½æ–¹å·®ç‰¹å¾ã€‚
    3. **è¿‡æ»¤ç‰¹å¾**ï¼šç§»é™¤æ‰€æœ‰æ–¹å·®ä½äºè®¾å®šé˜ˆå€¼çš„ç‰¹å¾

- è¯­æ³•

  ```python
  #åˆ›å»ºå¯¹è±¡ï¼Œå‡†å¤‡æŠŠæ–¹å·®ä¸ºç­‰äºå°äº2çš„å»æ‰ï¼Œthresholdçš„ç¼ºçœå€¼ä¸º2.0
  sklearn.feature_selection.VarianceThreshold(threshold=2.0)
  
  #æŠŠxä¸­ä½æ–¹å·®ç‰¹å¾å»æ‰, xçš„ç±»å‹å¯ä»¥æ˜¯DataFrameã€ndarrayå’Œlist
  VananceThreshold.fit_transform(x)
  
  fit_transformå‡½æ•°çš„è¿”å›å€¼ä¸ºndarray
  ```

- å®ä¾‹

  ```python
  from sklearn.feature_selection import VarianceThreshold
  
  data=[[110,1243,23255,238423,42314],
        [103,1223,23535,234423,42335],
        [103,1223,23535,234423,42332],
        [103,1223,23535,234423,42339],
        [103,1223,23535,234423,42330],
        [103,1223,23535,234423,42331],
        [170,1253,23755,234223,10]]
  data=pd.DataFrame(data)
  threshold=VarianceThreshold(threshold=1000)
  data_hold=threshold.fit_transform(data)
  print('åŸå§‹æ•°æ®ï¼š\n',data)
  print('è®¾å®šé˜ˆå€¼åçš„æ•°æ®ï¼š\n',data_hold)
  ```

  ![hold_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/hold_1.png)

##### 1.2 æ ¹æ®ç›¸å…³ç³»æ•°çš„ç‰¹å¾é€‰æ‹©

- å®šä¹‰

  **æ­£ç›¸å…³æ€§**ï¼ˆPositive Correlationï¼‰æ˜¯æŒ‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ä¸€ç§ç»Ÿè®¡å…³ç³»ï¼Œå…¶ä¸­ä¸€ä¸ªå˜é‡çš„å¢åŠ é€šå¸¸ä¼´éšç€å¦ä¸€ä¸ªå˜é‡çš„å¢åŠ ï¼Œåä¹‹äº¦ç„¶ã€‚æ­£ç›¸å…³æ€§é€šå¸¸ç”¨æ­£å€¼çš„ç›¸å…³ç³»æ•°æ¥è¡¨ç¤ºï¼Œ**è¿™ä¸ªå€¼ä»‹äº0å’Œ1ä¹‹é—´ã€‚å½“ç›¸å…³ç³»æ•°ç­‰äº1æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´å­˜åœ¨å®Œç¾çš„æ­£ç›¸å…³å…³ç³»ï¼Œ**å³ä¸€ä¸ªå˜é‡çš„å€¼å¯ä»¥å®Œå…¨ç”±å¦ä¸€ä¸ªå˜é‡çš„å€¼é¢„æµ‹ã€‚

  - å¦‚æœç¬¬ä¸€ä¸ªå˜é‡å¢åŠ ï¼Œç¬¬äºŒä¸ªå˜é‡ä¹Ÿæœ‰å¾ˆå¤§çš„æ¦‚ç‡ä¼šå¢åŠ ã€‚
  - åŒæ ·ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå˜é‡å‡å°‘ï¼Œç¬¬äºŒä¸ªå˜é‡ä¹Ÿå¾ˆå¯èƒ½ä¼šå‡å°‘ã€‚

  **è´Ÿç›¸å…³æ€§**ï¼ˆNegative Correlationï¼‰ä¸æ­£ç›¸å…³æ€§åˆšå¥½ç›¸å,ä½†æ˜¯ä¹Ÿè¯´æ˜ç›¸å…³,æ¯”å¦‚è¿åŠ¨é¢‘ç‡å’ŒBIMä½“é‡æŒ‡æ•°ç¨‹è´Ÿç›¸å…³ã€‚

  **ä¸ç›¸å…³**ï¼šæŒ‡ä¸¤è€…çš„ç›¸å…³æ€§å¾ˆå°,ä¸€ä¸ªå˜é‡å˜åŒ–ä¸ä¼šå¼•èµ·å¦å¤–çš„å˜é‡å˜åŒ–,åªæ˜¯æ²¡æœ‰çº¿æ€§å…³ç³». æ¯”å¦‚é¥­é‡å’Œæ™ºå•†ã€‚

  **çš®å°”é€Šç›¸å…³ç³»æ•°**ï¼ˆPearson correlation coefficient)æ˜¯ä¸€ç§åº¦é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§ç›¸å…³æ€§çš„ç»Ÿè®¡é‡ã€‚å®ƒæä¾›äº†ä¸¤ä¸ªå˜é‡é—´å…³ç³»çš„æ–¹å‘ï¼ˆæ­£ç›¸å…³æˆ–è´Ÿç›¸å…³ï¼‰å’Œå¼ºåº¦çš„ä¿¡æ¯ã€‚çš®å°”é€Šç›¸å…³ç³»æ•°çš„å–å€¼èŒƒå›´æ˜¯ \[âˆ’1,1]ã€‚

  - $\rho=1$ è¡¨ç¤ºå®Œå…¨æ­£ç›¸å…³ï¼Œå³éšç€ä¸€ä¸ªå˜é‡çš„å¢åŠ ï¼Œå¦ä¸€ä¸ªå˜é‡ä¹Ÿçº¿æ€§å¢åŠ ã€‚
  - $\rho=-1$  è¡¨ç¤ºå®Œå…¨è´Ÿç›¸å…³ï¼Œå³éšç€ä¸€ä¸ªå˜é‡çš„å¢åŠ ï¼Œå¦ä¸€ä¸ªå˜é‡çº¿æ€§å‡å°‘ã€‚
  - $\rho=0$ è¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´ä¸å­˜åœ¨çº¿æ€§å…³ç³»ã€‚

  ç›¸å…³ç³»æ•°$\rho$çš„ç»å¯¹å€¼ä¸º0-1ä¹‹é—´ï¼Œç»å¯¹å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºè¶Šç›¸å…³ï¼Œå½“ä¸¤ç‰¹å¾å®Œå…¨ç›¸å…³æ—¶ï¼Œä¸¤ç‰¹å¾çš„å€¼è¡¨ç¤ºçš„å‘é‡æ˜¯åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šï¼Œå½“ä¸¤ç‰¹å¾çš„ç›¸å…³ç³»æ•°ç»å¯¹å€¼å¾ˆå°æ—¶ï¼Œä¸¤ç‰¹å¾å€¼è¡¨ç¤ºçš„å‘é‡æ¥è¿‘åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šã€‚

- å…¬å¼

  å¯¹äºä¸¤ç»„æ•°æ® ğ‘‹={ğ‘¥1,ğ‘¥2,...,ğ‘¥ğ‘›} å’Œ ğ‘Œ={ğ‘¦1,ğ‘¦2,...,ğ‘¦ğ‘›}ï¼Œçš®å°”é€Šç›¸å…³ç³»æ•°å¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š

	$\rho=\frac{\text{Cos}(x, y)}{\sqrt{D x} \cdot \sqrt{D y}}=\frac{E[(x-E x)(y-E y)]}{\sqrt{D x} \cdot \sqrt{D y}}=\frac{\sum_{i=1}^{n}(x-\tilde{x})(y-\bar{y}) /(n-1)}{\sqrt{\sum_{i=1}^{n}(x-\bar{x})^{2} /(n-1)} \cdot \sqrt{\sum_{i=1}^{n}(y-\bar{y})^{2} /(n-1)}}$

  $\bar{x}$å’Œ $\bar{y}$ åˆ†åˆ«æ˜¯ğ‘‹å’Œğ‘Œçš„å¹³å‡å€¼

  |Ï|<0.4ä¸ºä½åº¦ç›¸å…³;    0.4<=|Ï|<0.7ä¸ºæ˜¾è‘—ç›¸å…³ï¼›  0.7<=|Ï|<1ä¸ºé«˜åº¦ç›¸å…³

- è¯­æ³•

  ```python
  scipy.stats.personr(x, y) #è®¡ç®—ä¸¤ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§
  """
  è¿”å›å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§:
  
     statisticçš®å°”é€Šç›¸å…³ç³»æ•°[-1,1]   
  
     pvalueé›¶å‡è®¾(äº†è§£),ç»Ÿè®¡ä¸Šè¯„ä¼°ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§,è¶Šå°è¶Šç›¸å…³
     
  """
  ```

- å®ä¾‹

  ```python
  from scipy.stats import pearsonr
  x=np.array([1,2,3,4, 5, 6, 7, 8,9])
  y_1=np.array([10,20,30,40,50,60,70,80,90])
  y_2=np.array([100,200,300,10, 20, 0, 70, 1000,200])
  print("x:\n",x)
  print("y_1:\n",y_1)
  print("y_2:\n",y_2)
  ret_1=pearsonr(x,y_1)
  ret_2=pearsonr(x,y_2)
  print(ret_1)
  print(ret_2)
  ```

  ![pearsonr](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pearsonr.png)

#### 2.ä¸»æˆåˆ†åˆ†æ(PCA)

- å®šä¹‰

  PCAçš„æ ¸å¿ƒç›®æ ‡æ˜¯ä»åŸå§‹ç‰¹å¾ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªæ–°çš„åæ ‡ç³»ç»Ÿï¼Œä½¿å¾—æ•°æ®åœ¨æ–°åæ ‡è½´ä¸Šçš„æŠ•å½±èƒ½å¤Ÿæœ€å¤§ç¨‹åº¦åœ°ä¿ç•™æ•°æ®çš„æ–¹å·®ï¼ŒåŒæ—¶å‡å°‘æ•°æ®çš„ç»´åº¦ã€‚

- åŸç†

  ![pca_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pca_1.png)

  $x_0$æŠ•å½±åˆ°Lçš„å¤§å°ä¸º$x_0*cos  \alpha$

  $y_0$æŠ•å½±åˆ°Lçš„å¤§å°ä¸º$y_0*sin\alpha$ 

  ä½¿ç”¨$(x_0,y_0)$è¡¨ç¤ºä¸€ä¸ªç‚¹ï¼Œ  è¡¨æ˜è¯¥ç‚¹æœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œ è€Œæ˜ å°„åˆ°Lä¸Šæœ‰ä¸€ä¸ªç‰¹å¾å°±å¯ä»¥è¡¨ç¤ºè¿™ä¸ªç‚¹äº†ã€‚è¿™å°±è¾¾åˆ°äº†é™ç»´çš„åŠŸèƒ½ ã€‚

  æŠ•å½±åˆ°Lä¸Šçš„å€¼å°±æ˜¯é™ç»´åä¿ç•™çš„ä¿¡æ¯ï¼ŒæŠ•å½±åˆ°ä¸Lå‚ç›´çš„è½´ä¸Šçš„å€¼å°±æ˜¯ä¸¢å¤±çš„ä¿¡æ¯ã€‚ä¿ç•™ä¿¡æ¯/ä¸¢å¤±ä¿¡æ¯=ä¿¡æ¯ä¿ç•™çš„æ¯”ä¾‹

  ä¸‹å›¾ä¸­çº¢çº¿ä¸Šç‚¹ä¸ç‚¹çš„è·ç¦»æ˜¯æœ€å¤§çš„ï¼Œæ‰€ä»¥åœ¨çº¢è‰²çº¿ä¸Šç‚¹çš„æ–¹å·®æœ€å¤§ï¼Œç²‰çº¢çº¿ä¸Šçš„åˆšå¥½ç›¸å. 

  æ‰€ä»¥çº¢è‰²çº¿ä¸Šç‚¹æ¥è¡¨ç¤ºä¹‹å‰ç‚¹çš„ä¿¡æ¯æŸå¤±æ˜¯æœ€å°çš„ã€‚

  ![pca_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pca_2.png)

- æ­¥éª¤

  - å¾—åˆ°çŸ©é˜µ

  - ç”¨çŸ©é˜µPå¯¹åŸå§‹æ•°æ®è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°æ–°çš„æ•°æ®çŸ©é˜µZ,æ¯ä¸€åˆ—å°±æ˜¯ä¸€ä¸ªä¸»æˆåˆ†, å¦‚ä¸‹å›¾å°±æ˜¯æŠŠ10ç»´é™æˆäº†2ç»´,å¾—åˆ°äº†ä¸¤ä¸ªä¸»æˆåˆ†

    ![pca_4](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pca_4.png)

  - æ ¹æ®ä¸»æˆåˆ†çš„æ–¹å·®ç­‰ï¼Œç¡®å®šæœ€ç»ˆä¿ç•™çš„ä¸»æˆåˆ†ä¸ªæ•°ï¼Œ æ–¹å·®å¤§çš„è¦ç•™ä¸‹ã€‚**ä¸€ä¸ªç‰¹å¾çš„å¤šä¸ªæ ·æœ¬çš„å€¼å¦‚æœéƒ½ç›¸åŒï¼Œåˆ™æ–¹å·®ä¸º0ï¼Œ åˆ™è¯´æ˜è¯¥ç‰¹å¾å€¼ä¸èƒ½åŒºåˆ«æ ·æœ¬ï¼Œæ‰€ä»¥è¯¥ç‰¹å¾æ²¡æœ‰ç”¨ã€‚**

  æ¯”å¦‚ä¸‹å›¾çš„äºŒç»´æ•°æ®è¦é™ä¸ºä¸€ç»´æ•°æ®ï¼Œå›¾å½¢æ³•æ˜¯æŠŠæ‰€åœ¨æ•°æ®åœ¨äºŒç»´åæ ‡ä¸­ä»¥ç‚¹çš„å½¢å¼æ ‡å‡ºï¼Œç„¶åç»™å‡ºä¸€æ¡ç›´çº¿ï¼Œè®©æ‰€æœ‰ç‚¹å‚ç›´æ˜ å°„åˆ°ç›´çº¿ä¸Šï¼Œè¯¥ç›´çº¿æœ‰å¾ˆå¤šï¼Œåªæœ‰ç‚¹åˆ°çº¿çš„è·ç¦»ä¹‹å’Œæœ€å°çš„çº¿æ‰èƒ½è®©ä¹‹å‰ä¿¡æ¯æŸå¤±æœ€å°ã€‚

  è¿™æ ·ä¹‹å‰æ‰€æœ‰çš„äºŒç»´è¡¨ç¤ºçš„ç‚¹å°±å…¨éƒ¨å˜æˆä¸€æ¡ç›´çº¿ä¸Šçš„ç‚¹ï¼Œä»äºŒç»´é™æˆäº†ä¸€ç»´ã€‚

  ![pca_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pca_3.png)

  ä¸Šå›¾æ˜¯ä¸€ä¸ªä»äºŒç»´é™åˆ°ä¸€ç»´çš„ç¤ºä¾‹ï¼šçš„åŸå§‹æ•°æ®ä¸º

  | ç‰¹å¾1-X1 | ç‰¹å¾2-X2 |
  | -------- | -------- |
  | -1       | -2       |
  | -1       | 0        |
  | 0        | 0        |
  | 2        | 1        |
  | 0        | 1        |

  é™ç»´åæ–°çš„æ•°æ®ä¸º

  | ç‰¹å¾3-X0 |
  | -------- |
  | -3/âˆš2    |
  | -1/âˆš2    |
  | 0        |
  | 3/âˆš2     |
  | -1/âˆš2    |

- è¯­æ³•

  ```python
  from sklearn.decomposition import PCA
  PCA(n_components=None)
  """
  - ä¸»æˆåˆ†åˆ†æ
  - n_components:
    - å®å‚ä¸ºå°æ•°æ—¶ï¼šè¡¨ç¤ºé™ç»´åä¿ç•™ç™¾åˆ†ä¹‹å¤šå°‘çš„ä¿¡æ¯
    - å®å‚ä¸ºæ•´æ•°æ—¶ï¼šè¡¨ç¤ºå‡å°‘åˆ°å¤šå°‘ç‰¹å¾
  """
  ```

- å®ä¾‹

  ```python
  from sklearn.decomposition import PCA
  data=[[110,1243,23255,238423,42314],
        [103,1223,23535,234423,42335],
        [103,1223,23535,234423,42332],
        [103,1223,23535,234423,42339],
        [103,1223,23535,234423,42330],
        [103,1223,23535,234423,42331],
        [170,1253,23755,234223,10]]
  
  pca_intger=PCA(n_components=3)#é™ç»´è‡³ä¸‰ç»´åº¦
  pca_float=PCA(n_components=0.4)#ä¿ç•™ç™¾åˆ†ä¹‹40çš„æ•°æ®
  data_integer=pca_intger.fit_transform(data)
  data_float=pca_float.fit_transform(data)
  print('é™ç»´æ•´æ•°æ•°æ®ï¼š\n',data_integer)
  print('é™ç»´å°æ•°æ•°æ®ï¼š\n',data_float)
  ```

  ![pca_end](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/pca_end.png)

## Sklearnæœºå™¨å­¦ä¹ æ¦‚è¿°

```python
1.å®ä¾‹åŒ–é¢„ä¼°å™¨(ä¼°è®¡å™¨)å¯¹è±¡(estimator)ï¼Œ é¢„ä¼°å™¨å¯¹è±¡å¾ˆå¤š,éƒ½æ˜¯estimatorçš„å­ç±»
	ï¼ˆ1ï¼‰ç”¨äºåˆ†ç±»çš„é¢„ä¼°å™¨
		sklearn.neighbors.KNeighborsClassifier k-è¿‘é‚»
		sklearn.naive_bayes.MultinomialNB è´å¶æ–¯
		sklearn.linear_model.LogisticRegressioon é€»è¾‘å›å½’
		sklearn.tree.DecisionTreeClassifier å†³ç­–æ ‘
		sklearn.ensemble.RandomForestClassifier éšæœºæ£®æ—
	(2)ç”¨äºå›å½’çš„é¢„ä¼°å™¨
		sklearn.linear_model.LinearRegressionçº¿æ€§å›å½’
		sklearn.linear_model.Ridgeå²­å›å½’
	(3)ç”¨äºæ— ç›‘ç£å­¦ä¹ çš„é¢„ä¼°å™¨
		sklearn.cluster.KMeans èšç±»
2.è¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒç»“æŸåç”Ÿæˆæ¨¡å‹
	estimator.fit(x_train, y_train)
3.æ¨¡å‹è¯„ä¼°
	(1)æ–¹å¼1ï¼Œç›´æ¥å¯¹æ¯”
		y_predict = estimator.predict(x_test)
		y_test == y_predict
  	(2)æ–¹å¼2, è®¡ç®—å‡†ç¡®ç‡
  		accuracy = estimator.score(x_test, y_test)
```

## KNNåˆ†ç±»ç®—æ³•

### 1.ä¸¤ç§å¸¸ç”¨æ ·æœ¬è·ç¦»æµ‹ç®—

![ou_ha](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ou_ha.png)

#### 1.1æ¬§å¼è·ç¦»

- å®šä¹‰ï¼šæ¬§å¼è·ç¦»æ˜¯æœ€å¸¸è§çš„è·ç¦»åº¦é‡æ–¹æ³•ï¼Œä¹Ÿç§°ä¸ºç›´çº¿è·ç¦»ã€‚åœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œæ¬§å¼è·ç¦»è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„ç›´çº¿è·ç¦»ã€‚

- ç¼ºç‚¹ï¼šåœ¨ä½¿ç”¨æ­¤è·ç¦»åº¦é‡ä¹‹å‰ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ã€‚éšç€æ•°æ®ç»´æ•°çš„å¢åŠ ï¼Œæ¬§æ°è·ç¦»çš„ç”¨å¤„ä¹Ÿå°±è¶Šå°ã€‚

  ![ou_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ou_1.png)

  ![ou_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ou_2.png)

#### 1.2æ›¼å“ˆé¡¿è·ç¦»

- å®šä¹‰ï¼šæ›¼å“ˆé¡¿è·ç¦»æ˜¯è®¡ç®—ä¸¤ç‚¹ä¹‹é—´æ°´å¹³æˆ–å‚ç›´çº¿æ®µçš„è·ç¦»ä¹‹å’Œï¼Œä¹Ÿç§°ä¸ºåŸå¸‚è¡—åŒºè·ç¦»æˆ–L1è·ç¦»ã€‚

- ç¼ºç‚¹:ç”±äºå®ƒä¸æ˜¯å¯èƒ½çš„æœ€çŸ­è·¯å¾„ï¼Œå®ƒæ¯”æ¬§å‡ é‡Œå¾—è·ç¦»æ›´æœ‰å¯èƒ½ç»™å‡ºä¸€ä¸ªæ›´é«˜çš„è·ç¦»å€¼ã€‚éšç€æ•°æ®ç»´æ•°çš„å¢åŠ ï¼Œæ›¼å“ˆé¡¿è·ç¦»çš„ç”¨å¤„ä¹Ÿå°±è¶Šå°ã€‚

  ![ha_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ha_1.png)

  ![ha_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ha_2.png)

### 2.KNNç®—æ³•åŸç†

- å®šä¹‰

  K-è¿‘é‚»ç®—æ³•ï¼ˆK-Nearest Neighborsï¼Œç®€ç§°KNNï¼‰,æ ¹æ®Kä¸ªé‚»å±…æ ·æœ¬çš„ç±»åˆ«æ¥åˆ¤æ–­å½“å‰æ ·æœ¬çš„ç±»åˆ«ã€‚

  å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„kä¸ªæœ€ç›¸ä¼¼(æœ€é‚»è¿‘)æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸ªç±»åˆ«ï¼Œåˆ™è¯¥ç±»æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«

- ä¾‹å­è¯´æ˜

  ![exam](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/exam.png)

  æ ¹æ®KNNç®—æ³•å”äººè¡—æ¢æ¡ˆã€‹ç”µå½±å±äº**å–œå‰§ç±»å‹**ï¼š

  ![exam_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/exam_2.png)

### 3.KNNç¼ºç‚¹

- å¯¹äºå¤§è§„æ¨¡æ•°æ®é›†ï¼Œè®¡ç®—é‡å¤§ï¼Œå› ä¸ºéœ€è¦è®¡ç®—æµ‹è¯•æ ·æœ¬ä¸æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„è·ç¦»ã€‚

- å¯¹äºé«˜ç»´æ•°æ®ï¼Œè·ç¦»åº¦é‡å¯èƒ½å˜å¾—ä¸é‚£ä¹ˆæœ‰æ„ä¹‰ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œç»´åº¦ç¾éš¾â€

- éœ€è¦é€‰æ‹©åˆé€‚çš„kå€¼å’Œè·ç¦»åº¦é‡ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›å®éªŒå’Œè°ƒæ•´

### 4.KNN-API

- è¯­æ³•

  ```python
  from sklearn.neighbors import KNeighborsClassifier
  
  knn=KNeighborsClassifier(n_neighbors=5, algorithm='auto')
  ```

- å‚æ•°

  **n_neighbors: int, default=5,** é»˜è®¤æƒ…å†µä¸‹ç”¨äºkneighborsæŸ¥è¯¢çš„è¿‘é‚»æ•°ï¼Œå°±æ˜¯K
  **algorithm:{â€˜autoâ€™, â€˜ball_treeâ€™, â€˜kd_treeâ€™, â€˜bruteâ€™}, default=â€™autoâ€™ã€‚**æ‰¾åˆ°è¿‘é‚»çš„æ–¹å¼ï¼Œæ³¨æ„ä¸æ˜¯è®¡ç®—è·ç¦»çš„æ–¹å¼ï¼Œå¼€å‘ä¸­é»˜è®¤å€¼'auto'

- è®­ç»ƒä¸é¢„æµ‹

  (1) fit(x,y) ä½¿ç”¨Xä½œä¸ºè®­ç»ƒæ•°æ®å’Œyä½œä¸ºç›®æ ‡æ•°æ®  
  (2) predict(X) é¢„æµ‹æä¾›çš„æ•°æ®ï¼Œå¾—åˆ°é¢„æµ‹æ•°æ®

### 5.KNNå®ä¾‹

- KNNç®—æ³•â€”é¸¢å°¾èŠ±

  ```python
  from sklearn.datasets import load_iris
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.neighbors import KNeighborsClassifier
  #1.è·å–æ•°æ®
  iris=load_iris()
  data=np.array(iris.data)
  target=np.array(iris.target)
  #2.åˆ†å‰²æ•°æ®ï¼ˆåˆ’åˆ†è®­ç»ƒæ•°æ®ï¼Œæµ‹è¯•æ•°æ®ï¼‰
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,random_state=44,shuffle=True)
  #3.ç‰¹å¾å·¥ç¨‹ï¼ˆæ ‡å‡†åŒ–ï¼‰
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)#ä¿æŒæµ‹è¯•é›†æ‹¥æœ‰ä¸è®­ç»ƒé›†ç›¸åŒçš„æ ‡å‡†åŒ–
  #4.æ¨¡å‹è®­ç»ƒ(ä¼ å…¥è®­ç»ƒæ•°æ®å’Œæ ‡ç­¾)
  knn=KNeighborsClassifier(n_neighbors=5)
  knn.fit(x_train,y_train)
  #5.æ¨¡å‹è¯„ä¼°ï¼ˆé¢„æµ‹æ•°æ®ï¼‰
  y_predict=knn.predict(x_test)
  #æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
  print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š',y_predict==y_test)
  #æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score=knn.score(x_test,y_test)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š',score)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š',score)
  ```

  ![hua](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/hua.png)

- KNNç®—æ³•â€”æ•°å­—æ•°æ®

  ```python
  from sklearn.datasets import load_digits
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.neighbors import KNeighborsClassifier
  #1.åŠ è½½æ•°æ®
  digit=load_digits()
  data=np.array(digit.data)
  target=np.array(digit.target)
  #2.åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,random_state=44,shuffle=True)
  #3.æ ‡å‡†åŒ–
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)#ä¿æŒæµ‹è¯•é›†æ‹¥æœ‰ä¸è®­ç»ƒé›†ç›¸åŒçš„æ ‡å‡†åŒ–
  #4.è®­ç»ƒæ¨¡å‹(ä¼ å…¥è®­ç»ƒæ•°æ®å’Œæ ‡ç­¾)
  knn=KNeighborsClassifier(n_neighbors=5)
  knn.fit(x_train,y_train)
  #5.æ¨¡å‹è¯„ä¼°(é¢„æµ‹æµ‹è¯•é›†)
  y_predict=knn.predict(x_test)
  #æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
  print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š',y_predict==y_test)
  #æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score=knn.score(x_test,y_test)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š',score)
  ```

  ![digit](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/digit.png)

- KNNç®—æ³•â€”è‘¡è„é…’

  ```python
  from sklearn.datasets import load_wine
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.neighbors import KNeighborsClassifier
  
  #1.åŠ è½½æ•°æ®
  acho=load_wine()
  data=acho.data
  target=acho.target
  #2.åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,random_state=44,shuffle=True)
  #3.æ ‡å‡†åŒ–
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)
  #4.è®­ç»ƒæ¨¡å‹(ä¼ å…¥è®­ç»ƒæ•°æ®å’Œæ ‡ç­¾)
  knn=KNeighborsClassifier(n_neighbors=7)
  knn.fit(x_train,y_train)
  #5.æ¨¡å‹è¯„ä¼°(é¢„æµ‹æµ‹è¯•é›†)
  y_predict=knn.predict(x_test)
  #æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
  print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š',y_predict==y_test)
  #æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score=knn.score(x_test,y_test)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š',score)
  ```

  ![acho](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/acho.png)

- KNNç®—æ³•â€”ä¹³è…ºç™Œ

  ```python
  from sklearn.datasets import load_breast_cancer
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.neighbors import KNeighborsClassifier
  
  # 1.åŠ è½½æ•°æ®
  cancer = load_breast_cancer()
  data = cancer.data
  target = cancer.target
  # 2.åˆ’åˆ†æ•°æ®
  x_train, x_test, y_train, y_test = train_test_split(data, target, test_size=0.3, shuffle=True, random_state=44)
  # 3.æ ‡å‡†åŒ–
  stand = StandardScaler()
  x_train = stand.fit_transform(x_train)
  x_test = stand.transform(x_test)
  # 4.è®­ç»ƒæ¨¡å‹(ä¼ å…¥è®­ç»ƒæ•°æ®å’Œæ ‡ç­¾)
  knn = KNeighborsClassifier(n_neighbors=7)
  knn.fit(x_train, y_train)
  # 5.æ¨¡å‹è¯„ä¼°(é¢„æµ‹æµ‹è¯•é›†)
  y_predict = knn.predict(x_test)
  # æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
  print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š', y_predict == y_test)
  # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score = knn.score(x_test, y_test)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š', score)
  ```

  ![cancer_knn](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/cancer_knn.png)

- KNNç®—æ³•â€”æ£®æ—è¦†ç›–ç±»å‹æ•°æ®

  ```python
  from sklearn.datasets import fetch_covtype
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.neighbors import KNeighborsClassifier
  
  # 1.åŠ è½½æ•°æ®
  """"
  æ•°æ®é›†ä¸­çš„ç‰¹å¾å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š
  åœŸå£¤ç±»å‹ç‰¹å¾ (10 ä¸ªç‰¹å¾)ï¼š
      æ¯ä¸ªåœŸå£¤ç±»å‹æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ç‰¹å¾ï¼ŒæŒ‡ç¤ºæ ·æœ¬æ˜¯å¦å±äºè¯¥åœŸå£¤ç±»å‹ã€‚
      ç‰¹å¾ç¼–å·ä¸º Soil_Type1 åˆ° Soil_Type40ï¼Œä½†å¹¶éæ‰€æœ‰åœŸå£¤ç±»å‹éƒ½å‡ºç°ã€‚
  é‡ç”ŸåŠ¨æ¤ç‰©æµ‹é‡å€¼ (44 ä¸ªç‰¹å¾)ï¼š
      è¿™äº›ç‰¹å¾åŒ…æ‹¬æµ·æ‹”ã€å¡åº¦ã€æ°´å¹³è·ç¦»åˆ°æ°´ä½“ã€å‚ç›´è·ç¦»åˆ°æ°´ä½“ç­‰ã€‚
      ç‰¹å¾ç¼–å·ä¸º Elevation, Aspect, Slope, Horizontal_Distance_To_Hydrology, Vertical_Distance_To_Hydrology,
                Horizontal_Distance_To_Roadways, Hillshade_9am, Hillshade_Noon, Hillshade_3pm, 
               Horizontal_Distance_To_Fire_Points ç­‰ã€‚
  ç±»åˆ«æ•°é‡: 7 ç±»ä¸åŒçš„æ£®æ—è¦†ç›–ç±»å‹ã€‚
  """
  ret=datasets.fetch_covtype(data_home='./')
  data=ret.data
  target=ret.target
  #2.åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.3,shuffle=True,random_state=44)
  # 3.æ ‡å‡†åŒ–
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)
  # 4.è®­ç»ƒæ¨¡å‹
  knn=KNeighborsClassifier(n_neighbors=7)
  knn.fit(x_train,y_train)
  # 5.æ¨¡å‹è¯„ä¼°
  y_predict=knn.predict(x_test)
  # æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
  print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š', y_predict == y_test)
  # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score = knn.score(x_test, y_test)
  print('æ¨¡å‹é¢„æµ‹ç‡ï¼š', score)
  ```

  ![forest](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/forest.png)

### 6.æ¨¡å‹ä¿å­˜ä¸åŠ è½½

```python
import joblib
# ä¿å­˜æ¨¡å‹
joblib.dump(estimator, "my_ridge.pkl")
# åŠ è½½æ¨¡å‹
estimator = joblib.load("my_ridge.pkl")
#ä½¿ç”¨æ¨¡å‹é¢„æµ‹
y_test=estimator.predict([[0.4,0.2,0.4,0.7]])
print(y_test)
```

## æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜

### 1.äº¤å‰éªŒè¯

#### 1.1 ä¿ç•™äº¤å‰éªŒè¯(HoldOutï¼‰

- å®šä¹‰

  **HoldOut Cross-validationï¼ˆTrain-Test Splitï¼‰**

- ä½œç”¨

  æ•´ä¸ªæ•°æ®é›†è¢«**éšæœº**åœ°åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†ã€‚æ ¹æ®ç»éªŒæ³•åˆ™ï¼Œæ•´ä¸ªæ•°æ®é›†çš„è¿‘70%è¢«ç”¨ä½œè®­ç»ƒé›†ï¼Œå…¶ä½™30%è¢«ç”¨ä½œéªŒè¯é›†ã€‚**ä¹Ÿå°±æ˜¯æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„ï¼Œç›´æ¥åˆ’åˆ†æ•°æ®é›†çš„æ–¹æ³•ã€‚**

- ä¼˜ç‚¹

  å¾ˆç®€å•å¾ˆå®¹æ˜“æ‰§è¡Œã€‚

- ç¼ºç‚¹

  1.ä¸é€‚ç”¨äºä¸å¹³è¡¡çš„æ•°æ®é›†ã€‚

  â€‹		å‡è®¾80%çš„æ•°æ®å±äº â€œ0 â€œç±»ï¼Œå…¶ä½™20%çš„æ•°æ®å±äº â€œ1 â€œç±»ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒé›†çš„å¤§å°ä¸º80%ï¼Œæµ‹è¯•æ•°æ®çš„å¤§å°ä¸ºæ•°æ®é›†çš„20%ã€‚å¯èƒ½å‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œæ‰€æœ‰80%çš„ â€œ0 â€œç±»æ•°æ®éƒ½åœ¨è®­ç»ƒé›†ä¸­ï¼Œè€Œæ‰€æœ‰ â€œ1 â€œç±»æ•°æ®éƒ½åœ¨æµ‹è¯•é›†ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°†ä¸èƒ½å¾ˆå¥½åœ°æ¦‚æ‹¬æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ï¼Œå› ä¸ºå®ƒä¹‹å‰æ²¡æœ‰è§è¿‡ â€œ1 â€œç±»çš„æ•°æ®ã€‚

  2.ä¸€å¤§å—æ•°æ®è¢«å‰¥å¤ºäº†è®­ç»ƒæ¨¡å‹çš„æœºä¼šã€‚

  â€‹		åœ¨å°æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œæœ‰ä¸€éƒ¨åˆ†æ•°æ®å°†è¢«ä¿ç•™ä¸‹æ¥ç”¨äºæµ‹è¯•æ¨¡å‹ï¼Œè¿™äº›æ•°æ®å¯èƒ½å…·æœ‰é‡è¦çš„ç‰¹å¾ï¼Œè€Œæˆ‘ä»¬çš„æ¨¡å‹å¯èƒ½ä¼šå› ä¸ºæ²¡æœ‰åœ¨è¿™äº›æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒè€Œé”™è¿‡ã€‚

#### 1.2 K-æŠ˜äº¤å‰éªŒè¯(K-fold)

- å®šä¹‰

  **ï¼ˆK-fold Cross Validationï¼Œè®°ä¸ºK-CVæˆ–K-foldï¼‰**

- ä½œç”¨

  K-Foldäº¤å‰éªŒè¯æŠ€æœ¯ä¸­ï¼Œæ•´ä¸ªæ•°æ®é›†è¢«åˆ’åˆ†ä¸º**Kä¸ªå¤§å°ç›¸åŒçš„éƒ¨åˆ†**ã€‚æ¯ä¸ªåˆ†åŒºè¢«ç§°ä¸º ä¸€ä¸ªâ€Foldâ€ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰Kä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºK-Foldã€‚**ä¸€ä¸ªFoldè¢«ç”¨ä½œéªŒè¯é›†ï¼Œå…¶ä½™çš„K-1ä¸ªFoldè¢«ç”¨ä½œè®­ç»ƒé›†ã€‚**

  è¯¥æŠ€æœ¯é‡å¤Kæ¬¡ï¼Œ**ç›´åˆ°æ¯ä¸ªFoldéƒ½è¢«ç”¨ä½œéªŒè¯é›†ï¼Œå…¶ä½™çš„ä½œä¸ºè®­ç»ƒé›†ã€‚**

  **æ¨¡å‹çš„æœ€ç»ˆå‡†ç¡®åº¦æ˜¯é€šè¿‡å–kä¸ªæ¨¡å‹éªŒè¯æ•°æ®çš„å¹³å‡å‡†ç¡®åº¦æ¥è®¡ç®—çš„ã€‚**

- å›¾ç¤º

  ![k_z](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/k_z.png)

#### 1.3åˆ†å±‚k-æŠ˜äº¤å‰éªŒè¯(Stratified k-fold)

- å®šä¹‰

  **Stratified k-fold cross validation**

- ä½œç”¨

  K-æŠ˜äº¤å‰éªŒè¯çš„å˜ç§ï¼Œ åˆ†å±‚çš„æ„æ€æ˜¯è¯´åœ¨**æ¯ä¸€æŠ˜ä¸­éƒ½ä¿æŒç€åŸå§‹æ•°æ®ä¸­å„ä¸ªç±»åˆ«çš„æ¯”ä¾‹å…³ç³»**ï¼Œæ¯”å¦‚è¯´ï¼šåŸå§‹æ•°æ®æœ‰3ç±»ï¼Œæ¯”ä¾‹ä¸º1:2:1ï¼Œé‡‡ç”¨3æŠ˜åˆ†å±‚äº¤å‰éªŒè¯ï¼Œé‚£ä¹ˆåˆ’åˆ†çš„3æŠ˜ä¸­ï¼Œæ¯ä¸€æŠ˜ä¸­çš„æ•°æ®ç±»åˆ«ä¿æŒç€1:2:1çš„æ¯”ä¾‹ï¼Œè¿™æ ·çš„éªŒè¯ç»“æœæ›´åŠ å¯ä¿¡ã€‚

- å›¾ç¤º

  ![k_z_z](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/k_z_z.png)

#### 1.4å…¶ä»–éªŒè¯

- å»é™¤päº¤å‰éªŒè¯)
- ç•™ä¸€äº¤å‰éªŒè¯ï¼‰
- è’™ç‰¹å¡ç½—äº¤å‰éªŒè¯
- æ—¶é—´åºåˆ—äº¤å‰éªŒè¯

#### 1.5API

```python
from sklearn.model_selection import StratifiedKFold
kf=StratifiedKFold(n_splits=5,shuffle=True,random_state=44)
"""
    n_splitsåˆ’åˆ†ä¸ºå‡ ä¸ªæŠ˜å  
    shuffleæ˜¯å¦åœ¨æ‹†åˆ†ä¹‹å‰è¢«æ‰“ä¹±(éšæœºåŒ–),Falseåˆ™æŒ‰ç…§é¡ºåºæ‹†åˆ†
    random_stateéšæœºå› å­

"""
indexs=kf.split(X,y) 
"""
	è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡,ä¸€å…±æœ‰5ä¸ªæŠ˜å ,æ¯ä¸ªæŠ˜å å¯¹åº”çš„æ˜¯è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ä¸‹æ ‡

	ç„¶åå¯ä»¥ç”¨forå¾ªç¯å–å‡ºæ¯ä¸€ä¸ªæŠ˜å å¯¹åº”çš„Xå’Œyä¸‹æ ‡æ¥è®¿é—®åˆ°å¯¹åº”çš„æµ‹è¯•æ•°æ®é›†å’Œè®­ç»ƒæ•°æ®é›† ä»¥åŠæµ‹è¯•ç›®æ ‡é›†å’Œè®­ç»ƒç›®æ ‡é›†
"""
for train_index, test_index in indexs:
X[train_index],y[train_index],X[test_index ],y[test_index]


#æ™®é€šKæŠ˜äº¤å‰éªŒè¯å’Œåˆ†å±‚KæŠ˜äº¤å‰éªŒè¯çš„ä½¿ç”¨æ˜¯ä¸€æ ·çš„  åªæ˜¯å¼•å…¥çš„ç±»ä¸åŒ
#ä½¿ç”¨æ—¶åªæ˜¯KFoldè¿™ä¸ªç±»åä¸ä¸€æ ·å…¶ä»–ä»£ç å®Œå…¨ä¸€æ ·
from sklearn.model_selection import KFold
```

#### 1.6å®ä¾‹

```python
from sklearn.datasets import load_iris
from sklearn.model_selection import StratifiedKFold
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier

#1.åŠ è½½æ•°æ®
iris=load_iris()
data=iris.data
target=iris.target
#2.åˆå§‹åŒ–åˆ†å±‚K-æŠ˜äº¤å‰éªŒè¯å™¨
kf=StratifiedKFold(n_splits=5,shuffle=True,random_state=44)
#3.åˆå§‹åŒ–KNNå®¹å™¨
knn=KNeighborsClassifier(n_neighbors=7)
#4.äº¤å‰éªŒè¯
score=[]
for train_index,test_index in kf.split(data,target):
    x_train,x_test=data[train_index],data[test_index]
    y_train,y_test=target[train_index],target[test_index]
    #æ ‡å‡†åŒ–
    stand=StandardScaler()
    x_train=stand.fit_transform(x_train)
    x_test=stand.transform(x_test)
    #æ¨¡å‹è®­ç»ƒ
    knn.fit(x_train,y_train)
    #å¾—åˆ°æ¯æ¬¡æŠ˜å çš„å‡†ç¡®ç‡
    score_num=knn.score(x_test,y_test)
    score.append(score_num)
print('å¹³å‡åŒ–å¾—åˆ†ï¼š',sum(score)/len(score))
"""
å¹³å‡åŒ–å¾—åˆ†ï¼š 0.9600000000000002
"""
```

### 2.è¶…å‚æ•°æœç´¢

- å®šä¹‰

  è¶…å‚æ•°æœç´¢ä¹Ÿå«ç½‘æ ¼æœç´¢(Grid Search)

  æ¯”å¦‚åœ¨KNNç®—æ³•ä¸­ï¼Œkæ˜¯ä¸€ä¸ªå¯ä»¥äººä¸ºè®¾ç½®çš„å‚æ•°ï¼Œæ‰€ä»¥å°±æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚ç½‘æ ¼æœç´¢èƒ½è‡ªåŠ¨çš„å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°æœ€å¥½çš„è¶…å‚æ•°å€¼ã€‚

- å›¾ç¤º

  ![super](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/super.png)

### 3.è¶…å‚æ•°æœç´¢API

```python
from sklearn.model_selection import GridSearchCV
gc=GridSearchCV(estimatorï¼Œparam_gridï¼Œcv)

è¯´æ˜ï¼š
åŒæ—¶è¿›è¡Œäº¤å‰éªŒè¯(CV)ã€å’Œç½‘æ ¼æœç´¢(GridSearch)ï¼ŒGridSearchCVå®è®¡ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªä¼°è®¡å™¨(estimator)ï¼ŒåŒæ—¶å®ƒæœ‰å‡ ä¸ªé‡è¦å±æ€§ï¼š
      best_params_  æœ€ä½³å‚æ•°
      best_score_ åœ¨è®­ç»ƒé›†ä¸­çš„å‡†ç¡®ç‡
      best_estimator_ æœ€ä½³ä¼°è®¡å™¨
      cv_results_ äº¤å‰éªŒè¯è¿‡ç¨‹æè¿°
      best_index_æœ€ä½³kåœ¨åˆ—è¡¨ä¸­çš„ä¸‹æ ‡
å‚æ•°ï¼š
	estimatorï¼š scikit-learnä¼°è®¡å™¨å®ä¾‹
	param_grid:ä»¥å‚æ•°åç§°ï¼ˆstrï¼‰ä½œä¸ºé”®ï¼Œå°†å‚æ•°è®¾ç½®åˆ—è¡¨å°è¯•ä½œä¸ºå€¼çš„å­—å…¸
		ç¤ºä¾‹ï¼š {"n_neighbors": [1, 3, 5, 7, 9, 11]}
    cv: ç¡®å®šäº¤å‰éªŒè¯åˆ‡åˆ†ç­–ç•¥,å€¼ä¸º:
        (1)None  é»˜è®¤5æŠ˜
        (2)integer  è®¾ç½®å¤šå°‘æŠ˜
        å¦‚æœä¼°è®¡å™¨æ˜¯åˆ†ç±»å™¨ï¼Œä½¿ç”¨"åˆ†å±‚k-æŠ˜äº¤å‰éªŒè¯(StratifiedKFold)"ã€‚åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼Œä½¿ç”¨KFoldã€‚
```

### 4.è¶…å‚æ•°æœç´¢å®ä¾‹

```python
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import GridSearchCV
#1.åŠ è½½æ•°æ®
iris=load_iris()
data=iris.data
target=iris.target
#2.åˆ’åˆ†æ•°æ®
x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.3,random_state=44,shuffle=True)
#3.æ ‡å‡†åŒ–ï¼ˆæ•°æ®é¢„å¤„ç†ï¼‰
stand=StandardScaler()
x_train=stand.fit_transform(x_train)
x_test=stand.transform(x_test)
#4.åˆå§‹åŒ–KNNå®¹å™¨
knn=KNeighborsClassifier()
#5.è¶…å‚æ•°æœç´¢
gc=GridSearchCV(knn,{'n_neighbors':[1,2,3,4,5,6,7,8,9,10]},cv=10)
gc.fit(x_train,y_train)
#æ¨¡å‹è¯„ä¼°
y_predict=gc.predict(x_test)
# æ–¹æ³•1:å¯¹æ¯”é¢„æµ‹å€¼å’ŒçœŸå®å€¼
print('æ¨¡å‹é¢„æµ‹ç»“æœï¼š', y_predict == y_test)
# æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
score = gc.score(x_test, y_test)
print('æ¨¡å‹é¢„æµ‹ç‡ï¼š', score)
# æœ€ä½³å‚æ•°ï¼šbest_params_
print("æœ€ä½³å‚æ•°ï¼š\n", gc.best_params_)
# æœ€ä½³ç»“æœï¼šbest_score_
print("åœ¨è®­ç»ƒé›†ä¸­çš„å‡†ç¡®ç‡ï¼š\n", gc.best_score_)
# æœ€ä½³ä¼°è®¡å™¨ï¼šbest_estimator_
print("æœ€ä½³ä¼°è®¡å™¨:\n", gc.best_estimator_)
# äº¤å‰éªŒè¯ç»“æœï¼šcv_results_
print("äº¤å‰éªŒè¯è¿‡ç¨‹æè¿°:\n", gc.cv_results_)
# æœ€ä½³å‚æ•°ç»„åˆçš„ç´¢å¼•:æœ€ä½³kåœ¨åˆ—è¡¨ä¸­çš„ä¸‹æ ‡
print("æœ€ä½³å‚æ•°ç»„åˆçš„ç´¢å¼•:\n", gc.best_index_)
```

![spuer_serach](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/spuer_serach.png)

## æœ´ç´ è´å¶æ–¯åˆ†ç±»

### 1.è´å¶æ–¯åˆ†ç±»ç†è®º

æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒç”±ä¸¤ç±»æ•°æ®ç»„æˆï¼Œæ•°æ®åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![byes1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/byes1.png)

ç”¨p1(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«1(å›¾ä¸­çº¢è‰²åœ†ç‚¹è¡¨ç¤ºçš„ç±»åˆ«)çš„æ¦‚ç‡ï¼Œç”¨p2(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«2(å›¾ä¸­è“è‰²ä¸‰è§’å½¢è¡¨ç¤ºçš„ç±»åˆ«)çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæ–°æ•°æ®ç‚¹(x,y)ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è§„åˆ™æ¥åˆ¤æ–­å®ƒçš„ç±»åˆ«ï¼š

- å¦‚æœp1(x,y)>p2(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º1
- å¦‚æœp1(x,y)<p2(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º2

ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©é«˜æ¦‚ç‡å¯¹åº”çš„ç±»åˆ«ã€‚è¿™å°±æ˜¯è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³ï¼Œå³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–ã€‚

### 2.æ¡ä»¶æ¦‚ç‡

- å®šä¹‰

  P(A|B)ï¼šåœ¨äº‹ä»¶Bå‘ç”Ÿçš„æƒ…å†µä¸‹ï¼Œäº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡

- å›¾ç¤º

  ![bayes5](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/bayes5.png)

  åœ¨äº‹ä»¶Bå‘ç”Ÿçš„æƒ…å†µä¸‹ï¼Œäº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡å°±æ˜¯P(Aâˆ©B)é™¤ä»¥P(B)ã€‚

  ğ‘ƒ(ğ´|ğµ)=ğ‘ƒ(ğ´âˆ©ğµ)/ğ‘ƒ(ğµ)

- æ¨ç†

  å·²çŸ¥ï¼šğ‘ƒ(ğ´|ğµ)=ğ‘ƒ(ğ´âˆ©ğµ)/ğ‘ƒ(ğµ)

  åˆ™ï¼šğ‘ƒ(ğ´âˆ©ğµ)=ğ‘ƒ(ğ´|ğµ)ğ‘ƒ(ğµ) 

  å¯æ¨å‡ºï¼šğ‘ƒ(ğ´âˆ©ğµ)=ğ‘ƒ(ğµ|ğ´)ğ‘ƒ(ğ´)

  å³ï¼šğ‘ƒ(ğ´|ğµ)=ğ‘ƒ(B|A)ğ‘ƒ(ğ´)/ğ‘ƒ(ğµ)

### 3.å…¨æ¦‚ç‡å…¬å¼

é™¤äº†æ¡ä»¶æ¦‚ç‡ä»¥å¤–ï¼Œåœ¨è®¡ç®—p1å’Œp2çš„æ—¶å€™ï¼Œè¿˜è¦ç”¨åˆ°å…¨æ¦‚ç‡å…¬å¼

- å›¾ç¤º

  å‡å®šæ ·æœ¬ç©ºé—´Sï¼Œæ˜¯ä¸¤ä¸ªäº‹ä»¶Aä¸A'çš„å’Œï¼š

  ![bayes2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/bayes2.png)

  åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹ä»¶Bå¯ä»¥åˆ’åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼š

  ![bayes3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/bayes3.png)

  å³ï¼š

  ğ‘ƒ(ğµ)=ğ‘ƒ(ğµâˆ©ğ´)+ğ‘ƒ(ğµâˆ©ğ´â€²)

- æ¨ç†

  å·²çŸ¥ï¼šğ‘ƒ(ğµ)=ğ‘ƒ(ğµâˆ©ğ´)+ğ‘ƒ(ğµâˆ©ğ´â€²)

  æ‰€ä»¥ï¼šğ‘ƒ(ğµ)=ğ‘ƒ(ğµ|ğ´)ğ‘ƒ(ğ´)+ğ‘ƒ(ğµ|ğ´â€²)ğ‘ƒ(ğ´â€²)

  å°†è¿™ä¸ªå…¬å¼ä»£å…¥ä¸Šä¸€èŠ‚çš„**æ¡ä»¶æ¦‚ç‡å…¬å¼**ï¼Œå°±å¾—åˆ°äº†æ¡ä»¶æ¦‚ç‡çš„å¦ä¸€ç§å†™æ³•ï¼š

  $P(A|B)=\frac{P(B|A)P(A)}{P(B|A)P(A)+P(B|A^,)P(A^,)}$

### 4.è´å¶æ–¯æ¨æ–­

æ¡ä»¶æ¦‚ç‡å…¬å¼è¿›è¡Œå˜å½¢ï¼š

![bye](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/bye.png)

**æˆ‘ä»¬æŠŠP(A)ç§°ä¸º"å…ˆéªŒæ¦‚ç‡"ï¼ˆPrior probabilityï¼‰**ï¼Œå³åœ¨Bäº‹ä»¶å‘ç”Ÿä¹‹å‰ï¼Œæˆ‘ä»¬å¯¹Aäº‹ä»¶æ¦‚ç‡çš„ä¸€ä¸ªåˆ¤æ–­ã€‚

**P(A|B)ç§°ä¸º"åéªŒæ¦‚ç‡"ï¼ˆPosterior probabilityï¼‰**ï¼Œå³åœ¨Bäº‹ä»¶å‘ç”Ÿä¹‹åï¼Œæˆ‘ä»¬å¯¹Aäº‹ä»¶æ¦‚ç‡çš„é‡æ–°è¯„ä¼°ã€‚

**P(B|A)/P(B)ç§°ä¸º"å¯èƒ½æ€§å‡½æ•°"ï¼ˆLikelyhoodï¼‰**ï¼Œè¿™æ˜¯ä¸€ä¸ªè°ƒæ•´å› å­ï¼Œä½¿å¾—é¢„ä¼°æ¦‚ç‡æ›´æ¥è¿‘çœŸå®æ¦‚ç‡ã€‚

æ¡ä»¶æ¦‚ç‡å¯ä»¥è½¬æ¢æˆå·²ä¸‹å½¢å¼ï¼š

**åéªŒæ¦‚ç‡ã€€ï¼ã€€å…ˆéªŒæ¦‚ç‡ï½˜è°ƒæ•´å› å­**

### 5.æœ´ç´ è´å¶æ–¯æ¨æ–­

- å®šä¹‰

  æœ´ç´ è´å¶æ–¯ç›¸å¯¹äºè´å¶æ–¯ï¼Œå¯¹æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒåšäº†**æ¡ä»¶ç‹¬ç«‹**æ€§çš„å‡è®¾ã€‚

- è§£é‡Š

  å‡è®¾æœ‰nä¸ªç‰¹å¾ï¼Œæ ¹æ®è´å¶æ–¯å®šç†ï¼ŒåéªŒæ¦‚ç‡ P(a|X)  å¯ä»¥è¡¨ç¤ºä¸ºï¼š

  $P(a|X) = \frac{P(X|a)P(a)}{P(X)}$

  å…¶ä¸­ï¼š

  - P(X|a)  æ˜¯ç»™å®šç±»åˆ« \( a \) ä¸‹è§‚æµ‹åˆ°ç‰¹å¾å‘é‡  $X=(x_1, x_2, ..., x_n) $çš„æ¦‚ç‡ï¼›
  - P(a) æ˜¯ç±»åˆ«  a  çš„å…ˆéªŒæ¦‚ç‡ï¼›
  - P(X) æ˜¯è§‚æµ‹åˆ°ç‰¹å¾å‘é‡ X çš„è¾¹ç¼˜æ¦‚ç‡ï¼Œé€šå¸¸ä½œä¸ºå½’ä¸€åŒ–å¸¸æ•°å¤„ç†ã€‚

  æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨çš„å…³é”®å‡è®¾æ˜¯ç‰¹å¾ä¹‹é—´çš„æ¡ä»¶ç‹¬ç«‹æ€§ï¼Œå³ç»™å®šç±»åˆ« a ï¼Œç‰¹å¾  $x_i$  å’Œ $x_j$  (å…¶ä¸­ $i \neq j$ ç›¸äº’ç‹¬ç«‹ã€‚)

  å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è”åˆæ¦‚ç‡ P(X|a)  åˆ†è§£ä¸ºå„ä¸ªç‰¹å¾çš„æ¦‚ç‡ä¹˜ç§¯ï¼š


  $P(X|a) = P(x_1, x_2, ..., x_n|a) = P(x_1|a)P(x_2|a)...P(x_n|a)$


  å°†è¿™ä¸ªæ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾åº”ç”¨äºè´å¶æ–¯å…¬å¼ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š


  $P(a|X) = \frac{P(x_1|a)P(x_2|a)...P(x_n|a)P(a)}{P(X)}$


  è¿™æ ·ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å°±å¯ä»¥é€šè¿‡è®¡ç®—æ¯ç§å¯èƒ½ç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡å’Œå…ˆéªŒæ¦‚ç‡ï¼Œç„¶åé€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„ç±»åˆ«ä½œä¸ºé¢„æµ‹ç»“æœã€‚

- å®ä¾‹

  |      | çº¹ç† | è‰²æ³½ | é¼”å£° | ç±»åˆ« |
  | ---- | ---- | ---- | ---- | ---- |
  | 1    | æ¸…æ™° | æ¸…ç»¿ | æ¸…è„† | å¥½ç“œ |
  | 2    | æ¨¡ç³Š | ä¹Œé»‘ | æµŠå“ | åç“œ |
  | 3    | æ¨¡ç³Š | æ¸…ç»¿ | æµŠå“ | åç“œ |
  | 4    | æ¸…æ™° | ä¹Œé»‘ | æ²‰é—· | å¥½ç“œ |
  | 5    | æ¸…æ™° | æ¸…ç»¿ | æµŠå“ | å¥½ç“œ |
  | 6    | æ¨¡ç³Š | ä¹Œé»‘ | æ²‰é—· | åç“œ |
  | 7    | æ¸…æ™° | ä¹Œé»‘ | æ¸…è„† | å¥½ç“œ |
  | 8    | æ¨¡ç³Š | æ¸…ç»¿ | æ²‰é—· | å¥½ç“œ |
  | 9    | æ¸…æ™° | ä¹Œé»‘ | æµŠå“ | åç“œ |
  | 10   | æ¨¡ç³Š | æ¸…ç»¿ | æ¸…è„† | å¥½ç“œ |
  | 11   | æ¸…æ™° | æ¸…ç»¿ | æ²‰é—· | ï¼Ÿ   |
  | 12   | æ¨¡ç³Š | ä¹Œé»‘ | æµŠå“ | ?    |

  ```python
  å…¬å¼ï¼š
      p(a|X) = p(X|a)* p(a)/p(X)
      p(X|a) = p(x1,x2,x3...xn|a) = p(x1|a)*p(x2|a)*p(x3|a)...p(xn|a)
      p(X) = p(x1,x2,x3...xn) = p(x1)*p(x2)*p(x3)...p(xn)
      p(a|X) = p(x1|a)*p(x2|a)*p(x3|a)...p(xn|a) * p(a) / p(x1)*p(x2)*p(x3)...p(xn)
  11å·ç“œç¤ºä¾‹ï¼š
      p(å¥½ç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)
          =p(çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·|å¥½ç“œ)*p(å¥½ç“œ)/p(çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)
          =p(å¥½ç“œ)ã€‘*p(çº¹ç†æ¸…æ™°|å¥½ç“œ)*p(è‰²æ³½æ¸…ç»¿|å¥½ç“œ)*p(é¼“å£°æ²‰é—·|å¥½ç“œ)/p(çº¹ç†æ¸…æ™°)*p(è‰²æ³½æ¸…ç»¿)*p(é¼“å£°æ²‰é—·)
  
      p(åç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)
          =p(åç“œ)*p(çº¹ç†æ¸…æ™°|åç“œ)*p(è‰²æ³½æ¸…ç»¿|åç“œ)*p(é¼“å£°æ²‰é—·|åç“œ)/p(çº¹ç†æ¸…æ™°)*p(è‰²æ³½æ¸…ç»¿)*p(é¼“å£°æ²‰é—·)
  
      ä»å…¬å¼ä¸­åˆ¤æ–­"p(å¥½ç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)"å’Œ"p(åç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)"æ—¶ï¼Œå› ä¸ºå®ƒä»¬çš„åˆ†æ¯å€¼æ˜¯ç›¸åŒçš„ï¼Œå€¼éƒ½æ˜¯p(çº¹ç†æ¸…æ™°)*p(è‰²æ³½æ¸…ç»¿)*p(é¼“å£°æ²‰é—·)ï¼Œæ‰€ä»¥åªè¦è®¡ç®—å®ƒä»¬çš„åˆ†å­å°±å¯ä»¥åˆ¤æ–­æ˜¯"å¥½ç“œ"è¿˜æ˜¯"åç“œ"ä¹‹é—´è°å¤§è°å°äº†ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦è®¡ç®—åˆ†æ¯
      p(å¥½ç“œ) = 6/10
      p(åç“œ)=4/10
      pï¼ˆçº¹ç†æ¸…æ™°|å¥½ç“œï¼‰ = 4/6 
      pï¼ˆè‰²æ³½æ¸…ç»¿|å¥½ç“œï¼‰ = 4/6
      pï¼ˆé¼“å£°æ²‰é—·|å¥½ç“œï¼‰ = 2/6
      pï¼ˆçº¹ç†æ¸…æ™°|åç“œï¼‰ = 1/4 
      pï¼ˆè‰²æ³½æ¸…ç»¿|åç“œï¼‰ = 1/4
      pï¼ˆé¼“å£°æ²‰é—·|åç“œï¼‰ = 1/4
      æŠŠä»¥ä¸Šè®¡ç®—ä»£å…¥å…¬å¼çš„åˆ†å­
      p(å¥½ç“œ)*pï¼ˆçº¹ç†æ¸…æ™°|å¥½ç“œï¼‰*pï¼ˆè‰²æ³½æ¸…ç»¿|å¥½ç“œï¼‰*pï¼ˆé¼“å£°æ²‰é—·|å¥½ç“œ) = 4/45
      p(åç“œ)*pï¼ˆçº¹ç†æ¸…æ™°|åç“œï¼‰*pï¼ˆè‰²æ³½æ¸…ç»¿|åç“œï¼‰*pï¼ˆé¼“å£°æ²‰é—·|åç“œ) = 1/160
      æ‰€ä»¥
      p(å¥½ç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·) >  p(åç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)ï¼Œ
      æ‰€ä»¥æŠŠ(çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ¸…ç»¿ï¼Œé¼“å£°æ²‰é—·)çš„æ ·æœ¬å½’ç±»ä¸ºå¥½ç“œ
      
      
      
  
  12å·ç“œæµ‹ç®—ï¼š
  	#åˆ†æ¯ç›¸åŒä¸ç®—
  	p(å¥½ç“œ/(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“))
      	=p((çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“)/å¥½ç“œ)*p(å¥½ç“œ)/p(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“)
          =p(çº¹ç†æ¨¡ç³Š/å¥½ç“œ)*p(è‰²æ³½ä¹Œé»‘/å¥½ç“œ)*p(é¼“å£°æµŠå“/å¥½ç“œ)*p(å¥½ç“œ)/p(çº¹ç†æ¨¡ç³Š)*p(è‰²æ³½ä¹Œé»‘)*p(é¼“å£°æµŠå“)
          =(2/6 * 2/6 * 1/6 * 6/10)
          =(1/90)
          
          
          
  	p(åç“œ/(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“))
      	=p((çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“)/åç“œ)*p(å¥½ç“œ)/p(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“)
  		=p(çº¹ç†æ¨¡ç³Š/åç“œ)*p(è‰²æ³½ä¹Œé»‘/åç“œ)*p(é¼“å£°æµŠå“/åç“œ)*p(åç“œ)/p(çº¹ç†æ¨¡ç³Š)*p(è‰²æ³½ä¹Œé»‘)*p(é¼“å£°æµŠå“)
  		=(3/4 * 3/4 * 3/4 * 4/10)
          =27/160
  	
      p(åç“œ/(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“))>p(å¥½ç“œ/(çº¹ç†æ¨¡ç³Šã€è‰²æ³½ä¹Œé»‘ã€é¼“å£°æµŠå“))
      
      æ‰€ä»¥12å·ç“œå½’äºåç“œ
  
  
  ```

### 6.æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

- å®šä¹‰

  æŸäº›äº‹ä»¶æˆ–ç‰¹å¾å¯èƒ½ä»æœªå‡ºç°è¿‡ï¼Œè¿™ä¼šå¯¼è‡´å®ƒä»¬çš„æ¦‚ç‡è¢«ä¼°è®¡ä¸ºé›¶ã€‚ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå³ä½¿æŸä¸ªäº‹ä»¶æˆ–ç‰¹å¾æ²¡æœ‰å‡ºç°åœ¨è®­ç»ƒé›†ä¸­ï¼Œä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å®ƒåœ¨æœªæ¥æ ·æœ¬ä¸­å‡ºç°çš„å¯èƒ½æ€§ã€‚æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘æŠ€æœ¯å¯ä»¥é¿å…è¿™ç§â€œé›¶æ¦‚ç‡é™·é˜±â€ã€‚

- å…¬å¼

  ![lapulas](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/lapulas.png)

  **ä¸€èˆ¬Î±å–å€¼1ï¼Œmçš„å€¼ä¸ºæ€»ç‰¹å¾æ•°é‡**

- ä½œç”¨

  é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œ**å³ä½¿æŸä¸ªç‰¹å¾åœ¨è®­ç»ƒé›†ä¸­ä»æœªå‡ºç°è¿‡**ï¼Œå®ƒçš„æ¦‚ç‡ä¹Ÿä¸ä¼šè¢«ä¼°è®¡ä¸ºé›¶ï¼Œ**è€Œæ˜¯ä¼šè¢«èµ‹äºˆä¸€ä¸ªå¾ˆå°ä½†éé›¶çš„å€¼**ï¼Œä»è€Œé¿å…äº†æ¨¡å‹åœ¨é¢å¯¹æ–°æ•°æ®æ—¶å¯èƒ½å‡ºç°çš„è¿‡æ‹Ÿåˆæˆ–é¢„æµ‹é”™è¯¯

- ç¤ºä¾‹

  ```python
  """
  æ¯”å¦‚è®¡ç®—åˆ¤æ–­æ–°ç“œ(çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ·¡ç™½ï¼Œé¼“å£°æ²‰é—·)æ˜¯å¥½å’Œåæ—¶,å› ä¸ºåœ¨æ ·æœ¬ä¸­è‰²æ³½æ·¡ç™½æ²¡æœ‰å‡ºç°,å¯¼è‡´å‡ºç°0å€¼,ä¼šå½±å“è®¡ç®—ç»“æœ,è¦é‡‡ç”¨æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°
  """
  p(å¥½ç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ·¡ç™½ï¼Œé¼“å£°æ²‰é—·)
  	=ã€p(å¥½ç“œ)ã€‘*ã€pï¼ˆçº¹ç†æ¸…æ™°|å¥½ç“œï¼‰*pï¼ˆè‰²æ³½æ·¡ç™½|å¥½ç“œï¼‰*pï¼ˆé¼“å£°æ²‰é—·|å¥½ç“œ)ã€‘/ã€pï¼ˆçº¹ç†æ¸…æ™°ï¼‰*pï¼ˆè‰²æ³½æ·¡ç™½ï¼‰*pï¼ˆé¼“å£°æ²‰é—·)ã€‘
  p(åç“œ|çº¹ç†æ¸…æ™°ï¼Œè‰²æ³½æ·¡ç™½ï¼Œé¼“å£°æ²‰é—·)
  	=ã€p(åç“œ)ã€‘*ã€pï¼ˆçº¹ç†æ¸…æ™°|åç“œï¼‰*pï¼ˆè‰²æ³½æ·¡ç™½|åç“œï¼‰*pï¼ˆé¼“å£°æ²‰é—·|åç“œ)ã€‘/ã€pï¼ˆçº¹ç†æ¸…æ™°ï¼‰*pï¼ˆè‰²æ³½æ·¡ç™½ï¼‰*pï¼ˆé¼“å£°æ²‰é—·)ã€‘   
  pï¼ˆçº¹ç†æ¸…æ™°|å¥½ç“œï¼‰= (4+1)/(6+3)  # +1æ˜¯å› ä¸ºé˜²æ­¢é›¶æ¦‚ç‡ +3æ˜¯å› ä¸ºæœ‰3ä¸ªç‰¹å¾(çº¹ç†,è‰²æ³½,é¼“å£°)
  pï¼ˆè‰²æ³½æ·¡ç™½|å¥½ç“œï¼‰= (0+1)/(6+3)  
  pï¼ˆé¼“å£°æ²‰é—·|å¥½ç“œ) = (2+1)/(6+3) 
  pï¼ˆçº¹ç†æ¸…æ™°|åç“œï¼‰= (1+1)/(4+3)   
  pï¼ˆè‰²æ³½æ·¡ç™½|åç“œï¼‰= (0+1)/(4+3)  
  pï¼ˆé¼“å£°æ²‰é—·|åç“œ) = (1+1)/(4+3)  
  ```

### 7.API

```python
from sklearn.naive_bayes import MultinomialNB
by=MultinomialNB()
by.fit(x_train, y_train)
y_predict = by.predict(x_test)
```

### 8.å®ä¾‹

- æœ´ç´ è´å¶æ–¯åˆ†ç±»â€”é¸¢å°¾èŠ±

  ```python
  from sklearn.datasets import load_iris
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import MinMaxScaler
  from sklearn.naive_bayes import MultinomialNB
  
  #åŠ è½½æ•°æ®
  iris=load_iris()
  data=iris.data
  target=iris.target
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,shuffle=True,random_state=44)
  #é¢„å¤„ç†æ•°æ®
  minmax=MinMaxScaler()
  x_train=minmax.fit_transform(x_train)
  x_test=minmax.transform(x_test)
  #åˆå§‹åŒ–æœ´ç´ è´å¶æ–¯å®¹å™¨
  biys=MultinomialNB()
  biys.fit(x_train,y_train)
  #æ¨¡å‹è¯„ä¼°
  score=biys.score(x_test,y_test)
  print('æ¨¡å‹å‡†ç¡®ç‡ï¼š',score)
  #æ•°æ®é¢„æµ‹
  y_predict=biys.predict([[1,4,5,1]])
  print('é¢„æµ‹ç»“æœä¸ºï¼š',iris.target_names[y_predict])
  ```

  ![biys_isir](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/biys_isir.png)

- æœ´ç´ è´å¶æ–¯åˆ†ç±»â€”æ•°å­—

  ```python
  from sklearn.datasets import load_digits
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import MinMaxScaler
  from sklearn.naive_bayes import MultinomialNB
  
  #åŠ è½½æ•°æ®
  digit=load_digits()
  data=digit.data
  target=digit.target
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,shuffle=True,random_state=44)
  #é¢„å¤„ç†æ•°æ®
  minmax=MinMaxScaler()
  x_train=minmax.fit_transform(x_train)
  x_test=minmax.transform(x_test)
  #åˆå§‹åŒ–æœ´ç´ è´å¶æ–¯å®¹å™¨
  biys=MultinomialNB()
  biys.fit(x_train,y_train)
  #æ¨¡å‹è¯„ä¼°
  score=biys.score(x_test,y_test)
  print('æ¨¡å‹å‡†ç¡®ç‡ï¼š',score)
  #æ•°æ®é¢„æµ‹
  y_predict=biys.predict([[x for x in range(64)]])
  print('é¢„æµ‹ç»“æœä¸ºï¼š',digit.target_names[y_predict])
  ```

  ![biys_digit](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/biys_digit.png)

- æœ´ç´ è´å¶æ–¯åˆ†ç±»â€”è‘¡è„é…’

  ```python
  from sklearn.datasets import load_wine
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import MinMaxScaler
  from sklearn.naive_bayes import MultinomialNB
  
  #åŠ è½½æ•°æ®
  wine=load_wine()
  data=wine.data
  target=wine.target
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,shuffle=True,random_state=44)
  #é¢„å¤„ç†æ•°æ®
  minmax=MinMaxScaler()
  x_train=minmax.fit_transform(x_train)
  x_test=minmax.transform(x_test)
  #åˆå§‹åŒ–æœ´ç´ è´å¶æ–¯å®¹å™¨
  biys=MultinomialNB()
  biys.fit(x_train,y_train)
  #æ¨¡å‹è¯„ä¼°
  score=biys.score(x_test,y_test)
  print('æ¨¡å‹å‡†ç¡®ç‡ï¼š',score)
  #æ•°æ®é¢„æµ‹
  y_predict=biys.predict([[x for x in range(13)]])
  print('é¢„æµ‹ç»“æœä¸ºï¼š',wine.target_names[y_predict])
  ```

  ![biys_wine](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/biys_wine.png)

## å†³ç­–æ ‘åˆ†ç±»

### 1.å†³ç­–æ ‘æ¦‚å¿µ

- å®šä¹‰

  1ã€å†³ç­–èŠ‚ç‚¹
  é€šè¿‡æ¡ä»¶åˆ¤æ–­è€Œè¿›è¡Œåˆ†æ”¯é€‰æ‹©çš„èŠ‚ç‚¹ã€‚å¦‚ï¼šå°†æŸä¸ªæ ·æœ¬ä¸­çš„å±æ€§å€¼(ç‰¹å¾å€¼)ä¸å†³ç­–èŠ‚ç‚¹ä¸Šçš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œåˆ¤æ–­å®ƒçš„æµå‘ã€‚

  2ã€å¶å­èŠ‚ç‚¹
  æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œè¡¨ç¤ºæœ€ç»ˆçš„å†³ç­–ç»“æœã€‚

  3ã€å†³ç­–æ ‘çš„æ·±åº¦
  æ‰€æœ‰èŠ‚ç‚¹çš„æœ€å¤§å±‚æ¬¡æ•°ã€‚

  å†³ç­–æ ‘å…·æœ‰ä¸€å®šçš„å±‚æ¬¡ç»“æ„ï¼Œæ ¹èŠ‚ç‚¹çš„å±‚æ¬¡æ•°å®šä¸º0ï¼Œä»ä¸‹é¢å¼€å§‹æ¯ä¸€å±‚å­èŠ‚ç‚¹å±‚æ¬¡æ•°å¢åŠ 

  4ã€å†³ç­–æ ‘ä¼˜ç‚¹ï¼š

  â€‹      å¯è§†åŒ– - å¯è§£é‡Šèƒ½åŠ›-å¯¹ç®—åŠ›è¦æ±‚ä½

   5ã€ å†³ç­–æ ‘ç¼ºç‚¹ï¼š

  â€‹      å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼Œæ‰€ä»¥ä¸è¦æŠŠæ·±åº¦è°ƒæ•´å¤ªå¤§äº†ã€‚

- ç¤ºä¾‹å›¾ç¤º

  ![tree_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_1.png)

  ![tree_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_2.png)

  |       | æ˜¯åŠ¨ç‰© | ä¼šé£ | æœ‰ç¾½æ¯› |
  | ----- | ------ | ---- | ------ |
  | 1éº»é›€ | 1      | 1    | 1      |
  | 2è™è  | 1      | 1    | 0      |
  | 3é£æœº | 0      | 1    | 0      |
  | 4ç†ŠçŒ« | 1      | 0    | 0      |

   æ˜¯å¦ä¸ºåŠ¨ç‰©

  |       | æ˜¯åŠ¨ç‰© | ä¼šé£ | æœ‰ç¾½æ¯› |
  | ----- | ------ | ---- | ------ |
  | 1éº»é›€ | 1      | 1    | 1      |
  | 2è™è  | 1      | 1    | 0      |
  | 4ç†ŠçŒ« | 1      | 0    | 0      |

  æ˜¯å¦ä¼šé£

  |       | æ˜¯åŠ¨ç‰© | ä¼šé£ | æœ‰ç¾½æ¯› |
  | ----- | ------ | ---- | ------ |
  | 1éº»é›€ | 1      | 1    | 1      |
  | 2è™è  | 1      | 1    | 0      |

  æ˜¯å¦æœ‰ç¾½æ¯›

  |       | æ˜¯åŠ¨ç‰© | ä¼šé£ | æœ‰ç¾½æ¯› |
  | ----- | ------ | ---- | ------ |
  | 1éº»é›€ | 1      | 1    | 1      |

### 2.åŸºäºä¿¡æ¯å¢ç›Šå†³ç­–æ ‘çš„å»ºç«‹

#### 2.1ä¿¡æ¯ç†µ

ä¿¡æ¯ç†µæè¿°çš„æ˜¯ä¸ç¡®å®šæ€§ã€‚**ä¿¡æ¯ç†µè¶Šå¤§ï¼Œä¸ç¡®å®šæ€§è¶Šå¤§**ã€‚**ä¿¡æ¯ç†µçš„å€¼è¶Šå°ï¼Œåˆ™Dçš„çº¯åº¦è¶Šé«˜ã€‚**

å‡è®¾æ ·æœ¬é›†åˆDå…±æœ‰Nç±»ï¼Œç¬¬kç±»æ ·æœ¬æ‰€å æ¯”ä¾‹ä¸º$P_k$ï¼Œåˆ™Dçš„ä¿¡æ¯ç†µä¸º:![tree_num](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_num.png)

#### 2.2ä¿¡æ¯å¢ç›Š

ä¿¡æ¯å¢ç›Šæ˜¯ä¸€ä¸ªç»Ÿè®¡é‡ï¼Œç”¨æ¥æè¿°ä¸€ä¸ªå±æ€§åŒºåˆ†æ•°æ®æ ·æœ¬çš„èƒ½åŠ›ã€‚**ä¿¡æ¯å¢ç›Šè¶Šå¤§ï¼Œé‚£ä¹ˆå†³ç­–æ ‘å°±ä¼šè¶Šç®€æ´ã€‚**

ä¿¡æ¯å¢ç›Šå…¬å¼ï¼š![tree_num2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_num2.png)

#### 2.3é€šè¿‡ä¿¡æ¯å¢ç›Šå»ºç«‹å†³ç­–æ ‘

- ç¤ºä¾‹

  |      | èŒä¸š | å¹´é¾„ | æ”¶å…¥  | å­¦å† | æ˜¯å¦è´·æ¬¾ |
  | ---- | ---- | ---- | ----- | ---- | -------- |
  | 1    | å·¥äºº | 36   | 5500  | é«˜ä¸­ | å¦       |
  | 2    | å·¥äºº | 42   | 2800  | åˆä¸­ | æ˜¯       |
  | 3    | ç™½é¢† | 45   | 3300  | å°å­¦ | æ˜¯       |
  | 4    | ç™½é¢† | 25   | 10000 | æœ¬ç§‘ | æ˜¯       |
  | 5    | ç™½é¢† | 32   | 8000  | ç¡•å£« | å¦       |
  | 6    | ç™½é¢† | 28   | 13000 | åšå£« | æ˜¯       |

- å»ºç«‹æµç¨‹

  1.**è®¡ç®—æ ¹èŠ‚ç‚¹çš„ä¿¡æ¯ç†µ**

  ä¸Šè¡¨æ ¹æ®æ˜¯å¦è´·æ¬¾æŠŠæ ·æœ¬åˆ†æˆ2ç±»æ ·æœ¬ï¼Œ"æ˜¯"å 4/6=2/3, "å¦"å 2/6=1/3

  ![tree_bulid_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_1.png)

  2.**è®¡ç®—å±æ€§çš„ä¿¡æ¯å¢ç›Š**

  <1> "èŒä¸š"å±æ€§çš„ä¿¡æ¯å¢ç›Š:IG(D,"èŒä¸š")

  â€‹		åœ¨èŒä¸šä¸­ï¼Œå·¥äººå 1/3,  å·¥äººä¸­ï¼Œæ˜¯å¦ä»£æ¬¾å„å 1/2

  ![tree_bulid_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_2.png)

  â€‹		åœ¨èŒä¸šä¸­ï¼Œç™½é¢†å 2/3,  ç™½é¢†ä¸­ï¼Œæ˜¯è´·æ¬¾å 3/4, ä¸è´·æ¬¾å 1/4

  ![tree_bulid_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_3.png)

  â€‹		æ‰€ä»¥èŒä¸šä¿¡æ¯å¢ç›Šï¼š

  ![tree_bulid_4](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_4.png)

  ![tree_bulid_5](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_5.png)

  <2>" å¹´é¾„"å±æ€§çš„ä¿¡æ¯å¢ç›Šï¼ˆä»¥35å²ä¸ºç•Œï¼‰

  ![tree_bulid_6](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_6.png)

  <3> "æ”¶å…¥"å±æ€§çš„ä¿¡æ¯å¢ç›Šï¼ˆä»¥10000ä¸ºç•Œ,å¤§äºç­‰äº10000ä¸ºä¸€ç±»ï¼‰

  ![tree_bulid_7](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_7.png)

  <4> "å­¦å†"å±æ€§çš„ä¿¡æ¯å¢ç›Šï¼ˆä»¥é«˜ä¸­ä¸ºç•Œ, å¤§äºç­‰äºé«˜ä¸­çš„ä¸ºä¸€ç±»ï¼‰

  ![tree_bulid_8](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_bulid_8.png)

  3.**åˆ’åˆ†å±æ€§**

  å¯¹æ¯”å±æ€§ä¿¡æ¯å¢ç›Šå‘ç°ï¼Œ"æ”¶å…¥"å’Œ"å­¦å†"ç›¸ç­‰ï¼Œå¹¶ä¸”æ˜¯æœ€é«˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©"å­¦å†"æˆ–"æ”¶å…¥"ä½œä¸ºç¬¬ä¸€ä¸ª

  ![tree_show](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/tree_show.png)

### 3.åŸºäºåŸºå°¼æŒ‡æ•°å†³ç­–æ ‘çš„å»ºç«‹ï¼ˆäº†è§£ï¼‰

- å®šä¹‰

  **åŸºå°¼æŒ‡æ•°**ï¼ˆGini Indexï¼‰æ˜¯å†³ç­–æ ‘ç®—æ³•ä¸­ç”¨äºè¯„ä¼°æ•°æ®é›†çº¯åº¦çš„ä¸€ç§åº¦é‡ï¼Œ**åŸºå°¼æŒ‡æ•°è¡¡é‡çš„æ˜¯æ•°æ®é›†çš„ä¸çº¯åº¦ï¼Œæˆ–è€…è¯´åˆ†ç±»çš„ä¸ç¡®å®šæ€§ã€‚**åœ¨æ„å»ºå†³ç­–æ ‘æ—¶ï¼ŒåŸºå°¼æŒ‡æ•°è¢«ç”¨æ¥å†³å®šå¦‚ä½•å¯¹æ•°æ®é›†è¿›è¡Œæœ€ä¼˜åˆ’åˆ†ï¼Œä»¥å‡å°‘ä¸çº¯åº¦ã€‚

- è®¡ç®—

  å¯¹äºä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬å±äºæ­£ç±»çš„æ¦‚ç‡æ˜¯ \(p\)ï¼Œåˆ™å±äºè´Ÿç±»çš„æ¦‚ç‡æ˜¯ \(1-p\)ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„åŸºå°¼æŒ‡æ•° \(Gini(p)\) å®šä¹‰ä¸ºï¼š

   $Gini(p) = 1 - p^2 - (1-p)^2 = 2p(1-p) $

  å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬å±äºç¬¬ k ç±»çš„æ¦‚ç‡æ˜¯ $p_k$ï¼Œåˆ™èŠ‚ç‚¹çš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºï¼š

  ![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/Gini_num1.png)

- ä½œç”¨

  - å½“ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰æ ·æœ¬éƒ½å±äºåŒä¸€ç±»åˆ«æ—¶ï¼Œ**åŸºå°¼æŒ‡æ•°ä¸º 0ï¼Œè¡¨ç¤ºçº¯åº¦æœ€é«˜ã€‚**
  - å½“ä¸€ä¸ªèŠ‚ç‚¹çš„æ ·æœ¬å‡åŒ€åˆ†å¸ƒåœ¨æ‰€æœ‰ç±»åˆ«æ—¶ï¼Œ**åŸºå°¼æŒ‡æ•°æœ€å¤§ï¼Œè¡¨ç¤ºçº¯åº¦æœ€ä½ã€‚**

- æµç¨‹

  ä¸€ä¸ªæ•°æ®é›† \(D\)ï¼Œå…¶ä¸­åŒ…å« \(N\) ä¸ªæ ·æœ¬ï¼Œç‰¹å¾ \(A\) å°†æ•°æ®é›†åˆ†å‰²ä¸º $|D_1|$å’Œ $|D_2|$ ï¼Œåˆ™ç‰¹å¾ \(A\) çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š

 ![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/Gini_num2.png)

  å…¶ä¸­ $|D_1|$å’Œ $|D_2|$ åˆ†åˆ«æ˜¯å­é›† $D_1$ å’Œ $D_2$ ä¸­çš„æ ·æœ¬æ•°é‡ã€‚

  é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œå†³ç­–æ ‘ç®—æ³•é€æ­¥æ„å»ºä¸€æ£µæ ‘ï¼Œæ¯ä¸€å±‚çš„èŠ‚ç‚¹éƒ½å°½å¯èƒ½åœ°å‡å°‘åŸºå°¼æŒ‡æ•°ï¼Œæœ€ç»ˆè¾¾åˆ°å¯¹æ•°æ®é›†çš„æœ‰æ•ˆåˆ†ç±»ã€‚

- ç¤ºä¾‹

  ![gini_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_1.png)

  ![gini_1_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_1_1.png)

  å·¥èµ„æœ‰ä¸¤ä¸ªå–å€¼ï¼Œåˆ†åˆ«æ˜¯0å’Œ1ã€‚å½“å·¥èµ„=1æ—¶ï¼Œæœ‰3ä¸ªæ ·æœ¬ï¼š

  ![gini_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_2.png)

  åœ¨è¿™ä¸‰ä¸ªæ ·æœ¬ä¸­ï¼Œå·¥ä½œéƒ½æ˜¯å¥½ï¼š

  ![gini_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_3.png)

  æ‰€ä»¥å·¥èµ„=1ï¼Œæœ€ç»ˆç»“æœï¼š

  ![gini_4](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_4.png)

  åŒç†ï¼Œå½“å·¥èµ„=0æ—¶ï¼Œæœ‰5ä¸ªæ ·æœ¬ï¼Œåœ¨è¿™äº”ä¸ªæ ·æœ¬ä¸­ï¼Œå·¥ä½œæœ‰3ä¸ªæ˜¯ä¸å¥½ï¼Œ2ä¸ªæ˜¯å¥½ï¼š

  ![gini_5](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_5.png)

  åŒç†ï¼Œå¯å¾—å‹åŠ›çš„åŸºå°¼æŒ‡æ•°å¦‚ä¸‹ï¼š

  ![gini_6](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_6.png)

  å¹³å°çš„åŸºå°¼æŒ‡æ•°å¦‚ä¸‹ï¼š

  ![gini_7](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_7.png)

  **å¹³å°æœ‰ä¸‰ä¸ªå–å€¼0,1,2ã€‚æ‰€ä»¥åœ¨è®¡ç®—æ—¶ï¼Œéœ€è¦å°†å¹³å°çš„æ¯ä¸€ä¸ªå–å€¼éƒ½å•ç‹¬è¿›è¡Œè®¡ç®—ã€‚**æ¯”å¦‚ï¼šå½“å¹³å°=0æ—¶ï¼Œå°†æ•°æ®é›†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œ**ç¬¬ä¸€éƒ¨åˆ†æ˜¯å¹³å°=0ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å¹³å°!=0(åˆ†æ¯æ˜¯5çš„åŸå› )ã€‚**

  **æ ¹æ®åŸºå°¼æŒ‡æ•°æœ€å°å‡†åˆ™ï¼Œæˆ‘ä»¬ä¼˜å…ˆé€‰æ‹©å·¥èµ„æˆ–è€…å¹³å°=0ä½œä¸ºDçš„ç¬¬ä¸€ç‰¹å¾ã€‚**

  æˆ‘ä»¬é€‰æ‹©å·¥èµ„ä½œä¸ºç¬¬ä¸€ç‰¹å¾ï¼Œ**é‚£ä¹ˆå½“å·¥èµ„=1æ—¶ï¼Œå·¥ä½œ=å¥½ï¼Œæ— éœ€ç»§ç»­åˆ’åˆ†ã€‚å½“å·¥èµ„=0æ—¶ï¼Œéœ€è¦ç»§ç»­åˆ’åˆ†ã€‚**

  å½“å·¥èµ„=0æ—¶ï¼Œç»§ç»­è®¡ç®—åŸºå°¼æŒ‡æ•°ï¼š

  ![gini_8](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gini_8.png)

  å½“å¹³å°=0æ—¶ï¼ŒåŸºå°¼æŒ‡æ•°=0ï¼Œå¯ä»¥ä¼˜å…ˆé€‰æ‹©ã€‚

  åŒæ—¶ï¼Œå½“å¹³å°=0æ—¶ï¼Œå·¥ä½œéƒ½æ˜¯å¥½ï¼Œæ— éœ€ç»§ç»­åˆ’åˆ†ï¼Œå½“å¹³å°=1,2æ—¶ï¼Œå·¥ä½œéƒ½æ˜¯ä¸å¥½ï¼Œä¹Ÿæ— éœ€ç»§ç»­åˆ’åˆ†ã€‚ç›´æ¥æŠŠ1,2æ”¾åˆ°æ ‘çš„ä¸€ä¸ªç»“ç‚¹å°±å¯ä»¥ã€‚


### 4.API

```python
from sklearn.tree import DecisionTreeClassifier
tree=DecisionTreeClassifier(criterion,max_depth)
"""
criterion="gini"æˆ–"entropyâ€ é»˜è®¤ä¸º="gini" 
	å½“criterionå–å€¼ä¸º"gini"æ—¶é‡‡ç”¨ åŸºå°¼ä¸çº¯åº¦ï¼ˆGini impurityï¼‰ç®—æ³•æ„é€ å†³ç­–æ ‘ï¼Œ
	å½“criterionå–å€¼ä¸º"entropyâ€æ—¶é‡‡ç”¨ä¿¡æ¯å¢ç›Šï¼ˆ information gainï¼‰ç®—æ³•æ„é€ å†³ç­–æ ‘.
	
max_depth=int, é»˜è®¤ä¸º=None  æ ‘çš„æœ€å¤§æ·±åº¦

"""

#å¯è§†åŒ–å†³ç­–æ ‘
from sklearn.tree import export_graphviz
graph=export_graphviz(decision_tree,out_file,feature_names)
"""
	estimatorå†³ç­–æ ‘é¢„ä¼°å™¨
	out_fileç”Ÿæˆçš„æ–‡æ¡£
    feature_namesèŠ‚ç‚¹ç‰¹å¾å±æ€§å
 	æŠŠç”Ÿæˆçš„æ–‡æ¡£æ‰“å¼€ï¼Œå¤åˆ¶å‡ºå†…å®¹ç²˜åˆ°"http://webgraphviz.com/"ä¸­ï¼Œç‚¹å‡»"generate Graph"ä¼šç”Ÿæˆä¸€ä¸ªæ ‘å‹çš„å†³ç­–æ ‘å›¾
"""
```

### 5.å®ä¾‹

- å†³ç­–æ ‘-é¸¢å°¾èŠ±

  ```python
  #åŠ è½½æ•°æ®
  iris=load_iris()
  data=iris.data
  target=iris.target
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,shuffle=True,random_state=44)
  #é¢„å¤„ç†æ•°æ®
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)
  #åˆå§‹åŒ–å†³ç­–æ ‘å®¹å™¨
  tree_gini=DecisionTreeClassifier(criterion='gini')
  tree_info=DecisionTreeClassifier(criterion='entropy')
  tree_gini.fit(x_train,y_train)#åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘
  tree_info.fit(x_train,y_train)#ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘
  #æ¨¡å‹è¯„ä¼°
  score_gini=tree_gini.score(x_test,y_test)
  score_info=tree_info.score(x_test,y_test)
  print('åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘å‡†ç¡®ç‡ï¼š',score_gini)
  print('ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘å‡†ç¡®ç‡ï¼š',score_info)
  #é¢„æµ‹æ•°æ®
  y_pre_gini=tree_gini.predict([[1,2,3,4]])
  y_pre_info=tree_info.predict([[1,2,3,4]])
  print('åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘é¢„æµ‹ç±»å‹ä¸ºï¼š',iris.target_names[y_pre_gini])
  print('ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘é¢„æµ‹ç±»å‹ä¸ºï¼š',iris.target_names[y_pre_info])
  
  graph_gini=export_graphviz(tree_gini,'./iris_tree_gini',feature_names=iris.feature_names)
  graph_info=export_graphviz(tree_info,'./iris_tree_info',feature_names=iris.feature_names)
  ```

  ![decision_tree](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/decision_tree.png)

  ![iris_show](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/iris_show.png)

- å†³ç­–æ ‘-è‘¡è„é…’

  ```python
  from sklearn.datasets import load_wine
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.tree import DecisionTreeClassifier
  from sklearn.tree import export_graphviz
  
  
  #åŠ è½½æ•°æ®
  wine=load_wine()
  data=wine.data
  target=wine.target
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(data,target,test_size=0.2,shuffle=True,random_state=24)
  #é¢„å¤„ç†æ•°æ®
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)
  #åˆå§‹åŒ–å†³ç­–æ ‘å®¹å™¨
  tree_gini=DecisionTreeClassifier(criterion='gini')
  tree_info=DecisionTreeClassifier(criterion='entropy')
  tree_gini.fit(x_train,y_train)#åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘
  tree_info.fit(x_train,y_train)#ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘
  #æ¨¡å‹è¯„ä¼°
  score_gini=tree_gini.score(x_test,y_test)
  score_info=tree_info.score(x_test,y_test)
  print('åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘å‡†ç¡®ç‡ï¼š',score_gini)
  print('ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘å‡†ç¡®ç‡ï¼š',score_info)
  #é¢„æµ‹æ•°æ®
  y_pre_gini=tree_gini.predict([[x for x in range(13)]])
  y_pre_info=tree_info.predict([[x for x in range(13)]])
  print('åŸºå°¼æŒ‡æ•°å†³ç­–æ ‘é¢„æµ‹ç±»å‹ä¸ºï¼š',wine.target_names[y_pre_gini])
  print('ä¿¡æ¯å¢ç›Šå†³ç­–æ ‘é¢„æµ‹ç±»å‹ä¸ºï¼š',wine.target_names[y_pre_info])
  
  graph_gini=export_graphviz(tree_gini,'./iris_tree_gini',feature_names=wine.feature_names)
  graph_info=export_graphviz(tree_info,'./iris_tree_info',feature_names=wine.feature_names)
  ```

  ![decision_tree_wine](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/decision_tree_wine.png)

  ![wine_show](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/wine_show.png)

- å¦å°¼å…‹å·ä¹˜å®¢ç”Ÿå­˜

  ```python
  import pandas as pd
  from sklearn.model_selection import train_test_split
  from sklearn.feature_extraction import DictVectorizer
  from sklearn.tree import DecisionTreeClassifier, export_graphviz
  # 1ã€è·å–æ•°æ®
  titanic = pd.read_csv("src/titanic/titanic.csv")
  titanic.head()
  # ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼
  x = titanic[["pclass", "age", "sex"]]
  y = titanic["survived"]
  
  #2ã€æ•°æ®å¤„ç†
  # 1ï¼‰ç¼ºå¤±å€¼å¤„ç†ï¼Œ å› ä¸ºå…¶ä¸­ageæœ‰ç¼ºå¤±å€¼ã€‚
  x["age"].fillna(x["age"].mean(), inplace=True)
  
  # 2) è½¬æ¢æˆå­—å…¸ï¼Œ å› ä¸ºå…¶ä¸­æ•°æ®å¿…é¡»ä¸ºæ•°å­—æ‰èƒ½è¿›è¡Œå†³ç­–æ ‘ï¼Œæ‰€åœ¨å…ˆè½¬æˆå­—å…¸ï¼Œåé¢åˆå­—å…¸ç‰¹å¾æŠ½å–ï¼Œè¿™æ ·ä¹‹åçš„æ•°æ®å°±ä¼šæ˜¯æ•°å­—äº†, é¸¢å°¾èŠ±çš„æ•°æ®æœ¬æ¥å°±å…¨éƒ¨æ˜¯æ•°å­—ï¼Œæ‰€ä»¥ä¸éœ€è¦è¿™ä¸€æ­¥ã€‚
  """
  x.to_dict(orient="records") è¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äº Pandas DataFrame å¯¹è±¡ï¼Œç”¨æ¥å°† DataFrame è½¬æ¢ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åˆ—è¡¨çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¯¹åº”äº DataFrame ä¸­çš„ä¸€è¡Œè®°å½•ã€‚å­—å…¸çš„é”®æ˜¯ DataFrame çš„åˆ—åï¼Œå€¼åˆ™æ˜¯è¯¥è¡Œä¸­å¯¹åº”çš„åˆ—å€¼ã€‚
  å‡è®¾ä½ æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„ DataFrame x:
     A  B  C
  0  1  4  7
  1  2  5  8
  2  3  6  9
  æ‰§è¡Œ x.to_dict(orient="records")ï¼Œä½ ä¼šå¾—åˆ°è¿™æ ·çš„è¾“å‡ºï¼š
  [
      {'A': 1, 'B': 4, 'C': 7},
      {'A': 2, 'B': 5, 'C': 8},
      {'A': 3, 'B': 6, 'C': 9}
  ]
  """
  x = x.to_dict(orient="records")
  # 3)ã€æ•°æ®é›†åˆ’åˆ†
  x_train, x_test, y_train, y_test = train_test_split(x, y, random_state=22)
  # 4)ã€å­—å…¸ç‰¹å¾æŠ½å–
  transfer = DictVectorizer()
  x_train = transfer.fit_transform(x_train) #ç¨€ç–çŸ©é˜µ
  x_test = transfer.transform(x_test)
  
  # 3ï¼‰å†³ç­–æ ‘é¢„ä¼°å™¨
  estimator = DecisionTreeClassifier(criterion="entropy", max_depth=8)
  estimator.fit(x_train, y_train)
  
  # 4ï¼‰æ¨¡å‹è¯„ä¼°
  # æ–¹æ³•1ï¼šç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼
  y_predict = estimator.predict(x_test)
  print("y_predict:\n", y_predict)
  print("ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n", y_test == y_predict)
  
  # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
  score = estimator.score(x_test, y_test)
  print("å‡†ç¡®ç‡ä¸ºï¼š\n", score)
  
  
  # 6ï¼‰é¢„æµ‹
  x_test = transfer.transform([{'pclass': '1rd', 'age': 22.0, 'sex': 'female'}])
  index=estimator.predict(x_test)
  print("é¢„æµ‹1:\n",index)#[1]  å¤´ç­‰èˆ±çš„å°±å¯ä»¥æ´»ä¸‹æ¥
  x_test = transfer.transform([{'pclass': '3rd', 'age': 22.0, 'sex': 'female'}])
  index=estimator.predict(x_test)
  print("é¢„æµ‹2:\n",index)#[0]  3ç­‰èˆ±çš„æ´»ä¸ä¸‹æ¥
  
  # å¯è§†åŒ–å†³ç­–æ ‘
  export_graphviz(estimator, out_file="titanic_tree.dot", feature_names=transfer.get_feature_names_out())
  ```
## é›†æˆå­¦ä¹ æ–¹æ³•ä¹‹éšæœºæ£®æ—

- å®šä¹‰

  é›†æˆå­¦ä¹ çš„åŸºæœ¬æ€æƒ³å°±æ˜¯å°†å¤šä¸ªåˆ†ç±»å™¨ç»„åˆï¼Œä»è€Œå®ç°ä¸€ä¸ªé¢„æµ‹æ•ˆæœæ›´å¥½çš„é›†æˆåˆ†ç±»å™¨ã€‚

  é›†æˆç®—æ³•å¤§è‡´å¯ä»¥åˆ†ä¸ºï¼šBaggingï¼ŒBoosting å’Œ Stacking ä¸‰å¤§ç±»å‹ã€‚

- æµç¨‹

  ï¼ˆ1ï¼‰æ¯æ¬¡æœ‰æ”¾å›åœ°ä»è®­ç»ƒé›†ä¸­å–å‡º n ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œç»„æˆæ–°çš„è®­ç»ƒé›†ï¼›

  ï¼ˆ2ï¼‰åˆ©ç”¨æ–°çš„è®­ç»ƒé›†ï¼Œè®­ç»ƒå¾—åˆ°Mä¸ªå­æ¨¡å‹ï¼›

  ï¼ˆ3ï¼‰å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œé‡‡ç”¨æŠ•ç¥¨çš„æ–¹æ³•ï¼Œå¾—ç¥¨æœ€å¤šå­æ¨¡å‹çš„åˆ†ç±»ç±»åˆ«ä¸ºæœ€ç»ˆçš„ç±»åˆ«ï¼›

- ä½œç”¨

  **éšæœºæ£®æ—**å°±å±äºé›†æˆå­¦ä¹ ,æ˜¯é€šè¿‡æ„å»ºä¸€ä¸ªåŒ…å«å¤šä¸ªå†³ç­–æ ‘(é€šå¸¸ç§°ä¸ºåŸºå­¦ä¹ å™¨æˆ–å¼±å­¦ä¹ å™¨)çš„æ£®æ—ï¼Œæ¯æ£µæ ‘éƒ½åœ¨ä¸åŒçš„æ•°æ®å­é›†å’Œç‰¹å¾å­é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œæœ€ç»ˆé€šè¿‡æŠ•ç¥¨æˆ–å¹³å‡é¢„æµ‹ç»“æœæ¥äº§ç”Ÿæ›´å‡†ç¡®å’Œç¨³å¥çš„é¢„æµ‹ã€‚è¿™ç§æ–¹æ³•ä¸ä»…æé«˜äº†é¢„æµ‹ç²¾åº¦ï¼Œä¹Ÿé™ä½äº†è¿‡æ‹Ÿåˆé£é™©ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¤„ç†é«˜ç»´åº¦å’Œå¤§è§„æ¨¡æ•°æ®é›†ã€‚

### 1.ç®—æ³•åŸç†

![jiche](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/jiche.png)

- éšæœº:  ç‰¹å¾éšæœºï¼Œè®­ç»ƒé›†éšæœº
  - æ ·æœ¬ï¼šå¯¹äºä¸€ä¸ªæ€»ä½“è®­ç»ƒé›†Tï¼ŒTä¸­å…±æœ‰Nä¸ªæ ·æœ¬ï¼Œæ¯æ¬¡æœ‰æ”¾å›åœ°éšæœºé€‰æ‹©nä¸ªæ ·æœ¬ã€‚ç”¨è¿™nä¸ªæ ·æœ¬æ¥è®­ç»ƒä¸€ä¸ªå†³ç­–æ ‘ã€‚
  - ç‰¹å¾ï¼šå‡è®¾è®­ç»ƒé›†çš„ç‰¹å¾ä¸ªæ•°ä¸ºdï¼Œæ¯æ¬¡ä»…é€‰æ‹©k(k<d)ä¸ªæ¥æ„å»ºå†³ç­–æ ‘ã€‚
- æ£®æ—:  å¤šä¸ªå†³ç­–æ ‘åˆ†ç±»å™¨æ„æˆçš„åˆ†ç±»å™¨, å› ä¸ºéšæœºï¼Œæ‰€ä»¥å¯ä»¥ç”Ÿæˆå¤šä¸ªå†³ç­–æ ‘
- å¤„ç†å…·æœ‰é«˜ç»´ç‰¹å¾çš„è¾“å…¥æ ·æœ¬ï¼Œè€Œä¸”ä¸éœ€è¦é™ç»´ 
- ä½¿ç”¨å¹³å‡æˆ–è€…æŠ•ç¥¨æ¥æé«˜é¢„æµ‹ç²¾åº¦å’Œæ§åˆ¶è¿‡æ‹Ÿåˆ   

### 2.API

```python
class sklearn.ensemble.RandomForestClassifier

å‚æ•°ï¼š
n_estimators	int, default=100
æ£®æ—ä¸­æ ‘æœ¨çš„æ•°é‡ã€‚(å†³ç­–æ ‘ä¸ªæ•°)

criterion	{â€œginiâ€, â€œentropyâ€}, default=â€giniâ€ å†³ç­–æ ‘å±æ€§åˆ’åˆ†ç®—æ³•é€‰æ‹©
	å½“criterionå–å€¼ä¸ºâ€œginiâ€æ—¶é‡‡ç”¨ åŸºå°¼ä¸çº¯åº¦ï¼ˆGini impurityï¼‰ç®—æ³•æ„é€ å†³ç­–æ ‘ï¼Œ
	å½“criterionå–å€¼ä¸º â€œentropyâ€ æ—¶é‡‡ç”¨ä¿¡æ¯å¢ç›Šï¼ˆ information gainï¼‰ç®—æ³•æ„é€ å†³ç­–æ ‘.
	
ax_depth	int, default=None æ ‘çš„æœ€å¤§æ·±åº¦ã€‚ 
```

### 3.ç¤ºä¾‹

- æ³°å¦å°¼å…‹ä¹˜å®¢ç”Ÿå­˜â€”æ­£å¸¸éšæœºæ£®æ—æ³•

  ```python
  import pandas as pd
  from sklearn.model_selection import train_test_split
  from sklearn.feature_extraction import DictVectorizer
  from sklearn.preprocessing import StandardScaler
  from sklearn.ensemble import RandomForestClassifier
  
  #è¯»å–æ•°æ®
  data=pd.read_csv('./titanic.csv')
  #æ¸…æ´—é€‰å®šåˆ—å­˜åœ¨ç©ºå€¼çš„è¡Œ
  data.dropna(subset=['embarked'],inplace=True)
  #æå–æ‰€éœ€åˆ—æ•°æ®ï¼Œä»¥åŠæ ‡ç­¾å€¼
  x=data[['pclass','embarked','sex']]
  y=data[['survived']]
  #æ•°æ®å­˜åœ¨å­—ç¬¦ä¸²ï¼Œéœ€è¦è½¬æ¢å­—å…¸ï¼Œåœ¨è¿›è¡Œç‰¹å¾æå–
  x=x.to_dict(orient='records')
  dict=DictVectorizer(sparse=False)
  x=dict.fit_transform(x)
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=44,shuffle=True)
  print(x_train.shape)
  #æ•°æ®é¢„å¤„ç†
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.transform(x_test)
  #åˆå§‹åŒ–éšæœºæ£®æ—å®¹å™¨
  tree=RandomForestClassifier(n_estimators=100,max_depth=6,criterion='gini')
  tree.fit(x_train,y_train)
  #æ¨¡å‹è¯„ä¼°
  score=tree.score(x_test,y_test)
  print('éšæœºæ£®æ—å‡†ç¡®ç‡ï¼š',score)
  #é¢„æµ‹æ•°æ®
  #ä¼ å…¥æ•°æ®éœ€è¦è€ƒè™‘æ˜¯å¦è½¬æ¢æ•°æ®ç±»å‹
  y_pre=tree.predict([[1,2,3,4,5,6,7,8]])
  print('å­˜æ´»ç‡ä¸ºï¼š',y_pre)
  ```

  ![random_tree](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/random_tree.png)

- æ³°å¦å°¼å…‹ä¹˜å®¢ç”Ÿå­˜â€”ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯æ³•

  ```python
  import pandas as pd
  from sklearn.model_selection import train_test_split
  from sklearn.feature_extraction import DictVectorizer
  from sklearn.preprocessing import StandardScaler
  from sklearn.ensemble import RandomForestClassifier
  from sklearn.model_selection import GridSearchCV
  #è¯»å–æ•°æ®
  data=pd.read_csv('./titanic.csv')
  #æ¸…æ´—é€‰å®šåˆ—å­˜åœ¨ç©ºå€¼çš„è¡Œ
  data.dropna(subset=['embarked'],inplace=True)
  #æå–æ‰€éœ€åˆ—æ•°æ®ï¼Œä»¥åŠæ ‡ç­¾å€¼
  x=data[['pclass','embarked','sex']]
  y=data['survived']
  #æ•°æ®å­˜åœ¨å­—ç¬¦ä¸²ï¼Œéœ€è¦è½¬æ¢å­—å…¸ï¼Œåœ¨è¿›è¡Œç‰¹å¾æå–
  x=x.to_dict(orient='records')
  dict=DictVectorizer(sparse=False)
  x=dict.fit_transform(x)
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=44,shuffle=True)
  #åˆå§‹åŒ–éšæœºæ£®æ—å®¹å™¨ï¼Œä»¥åŠç½‘æ ¼æœç´¢å®¹å™¨
  tree=RandomForestClassifier()
  gc=GridSearchCV(tree,{'n_estimators':[100,200,300,400,500],'criterion':['gini','entropy'],'max_depth':[3,4,5,6]},cv=5)
  #æ¨¡å‹è®­ç»ƒ
  gc.fit(x_train,y_train)
  #æ¨¡å‹è¯„ä¼°
  print('æœ€ä½³å‚æ•°ï¼š',gc.best_params_)
  print('æœ€ä½³ç»“æœï¼š',gc.best_score_)
  print('æœ€ä½³ä¼°è®¡å™¨ï¼š',gc.best_estimator_)
  best_estimator=gc.best_estimator_
  score=best_estimator.score(x_test,y_test)
  print('æµ‹è¯•æ•°æ®å‡†ç¡®ç‡ï¼š',score)
  #é¢„æµ‹æ•°æ®
  y_pre=gc.predict([[1,2,3,4,5,6,7,8]])
  print('å­˜æ´»ç‡ä¸ºï¼š',y_pre)
  ```

  ![random_cv_tree](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/random_cv_tree.png)

## çº¿æ€§å›å½’

### 1.æ•°æ®å®šä¹‰

- **æ ‡ç§°å‹æ•°æ®**ï¼ˆNominal Dataï¼‰

  å®ƒç”¨äºåˆ†ç±»æˆ–æ ‡è®°**ä¸åŒçš„ç±»åˆ«æˆ–ç»„åˆ«**,æ•°æ®ç‚¹ä¹‹é—´å¹¶**æ²¡æœ‰æ•°å€¼æ„ä¹‰ä¸Šçš„è·ç¦»æˆ–é¡ºåº**ã€‚ä¾‹å¦‚ï¼Œé¢œè‰²ï¼ˆçº¢ã€è“ã€ç»¿ï¼‰ã€æ€§åˆ«ï¼ˆç”·ã€å¥³ï¼‰æˆ–äº§å“ç±»åˆ«ï¼ˆAã€Bã€Cï¼‰ã€‚

  æ ‡ç§°æ•°æ®çš„ç‰¹ç‚¹ï¼š

  1. **æ— åºæ€§**ï¼šæ ‡ç§°æ•°æ®çš„å„ä¸ªç±»åˆ«ä¹‹é—´æ²¡æœ‰å›ºæœ‰çš„é¡ºåºå…³ç³»ã€‚ä¾‹å¦‚ï¼Œâ€œæ€§åˆ«â€å¯ä»¥åˆ†ä¸ºâ€œç”·â€å’Œâ€œå¥³â€ï¼Œä½†â€œç”·â€å’Œâ€œå¥³â€ä¹‹é—´ä¸å­˜åœ¨å¤§å°ã€é«˜ä½ç­‰é¡ºåºå…³ç³»ã€‚
  2. **éæ•°å€¼æ€§**ï¼šæ ‡ç§°æ•°æ®ä¸èƒ½è¿›è¡Œæ•°å­¦è¿ç®—ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰æ•°å€¼å«ä¹‰ã€‚ä½ ä¸èƒ½å¯¹â€œé¢œè‰²â€æˆ–â€œå“ç‰Œâ€è¿™æ ·çš„æ ‡ç§°æ•°æ®è¿›è¡ŒåŠ å‡ä¹˜é™¤ã€‚
  3. **å¤šæ ·æ€§**ï¼šæ ‡ç§°æ•°æ®å¯ä»¥æœ‰å¾ˆå¤šä¸åŒçš„ç±»åˆ«ï¼Œå…·ä½“å–å†³äºç ”ç©¶çš„ä¸»é¢˜æˆ–æ•°æ®æ”¶é›†çš„ç›®çš„ã€‚
  4. æ¯”å¦‚è¥¿ç“œçš„é¢œè‰²,çº¹ç†,æ•²å‡»å£°å“è¿™äº›æ•°æ®å°±å±äºæ ‡ç§°å‹æ•°æ®,é€‚ç”¨äºè¥¿ç“œåˆ†ç±»

- **è¿ç»­å‹æ•°æ®**ï¼ˆContinuous Dataï¼‰

  è¡¨ç¤ºåœ¨æŸä¸ªèŒƒå›´å†…å¯ä»¥å–ä»»æ„æ•°å€¼çš„æµ‹é‡ï¼Œè¿™äº›æ•°æ®ç‚¹ä¹‹é—´æœ‰æ˜ç¡®çš„æ•°å€¼å…³ç³»å’Œè·ç¦»ã€‚ä¾‹å¦‚ï¼Œæ¸©åº¦ã€é«˜åº¦ã€é‡é‡ç­‰ã€‚

  è¿ç»­å‹æ•°æ®çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š

  1. **å¯æµ‹é‡æ€§**ï¼šè¿ç»­å‹æ•°æ®é€šå¸¸æ¥æºäºç‰©ç†æµ‹é‡ï¼Œå¦‚é•¿åº¦ã€é‡é‡ã€æ¸©åº¦ã€æ—¶é—´ç­‰ï¼Œè¿™äº›é‡æ˜¯å¯ä»¥ç²¾ç¡®æµ‹é‡çš„ã€‚
  2. **æ— é™å¯åˆ†æ€§**ï¼šè¿ç»­å‹æ•°æ®çš„å–å€¼èŒƒå›´ç†è®ºä¸Šæ˜¯æ— é™å¯åˆ†çš„ï¼Œå¯ä»¥æ— é™ç²¾ç¡®åœ°ç»†åˆ†ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æµ‹é‡ä¸€ä¸ªç‰©ä½“çš„é•¿åº¦ä¸º2.5ç±³ï¼Œä¹Ÿå¯ä»¥æ›´ç²¾ç¡®åœ°æµ‹é‡ä¸º2.53ç±³ï¼Œç”šè‡³2.5376ç±³ï¼Œç­‰ç­‰ã€‚
  3. **æ•°å€¼è¿ç®—**ï¼šè¿ç»­å‹æ•°æ®å¯ä»¥è¿›è¡Œæ•°å­¦è¿ç®—ï¼Œå¦‚åŠ ã€å‡ã€ä¹˜ã€é™¤ä»¥åŠæ±‚å¹³å‡å€¼ã€ä¸­ä½æ•°ã€æ ‡å‡†å·®ç­‰ç»Ÿè®¡é‡ã€‚

- **è¿ç»­æ€§æ•°æ®å¤„ç†å’Œåˆ†æ**

  - **æè¿°æ€§ç»Ÿè®¡**ï¼šè®¡ç®—å‡å€¼ã€ä¸­ä½æ•°ã€ä¼—æ•°ã€æ ‡å‡†å·®ã€å››åˆ†ä½æ•°ç­‰ï¼Œä»¥äº†è§£æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿å’Œåˆ†å¸ƒæƒ…å†µã€‚
  - **æ¦‚ç‡åˆ†å¸ƒ**ï¼šé€šè¿‡æ‹Ÿåˆæ¦‚ç‡åˆ†å¸ƒæ¨¡å‹ï¼Œå¦‚æ­£æ€åˆ†å¸ƒã€æŒ‡æ•°åˆ†å¸ƒã€ä¼½ç›åˆ†å¸ƒç­‰ï¼Œæ¥ç†è§£æ•°æ®çš„éšæœºç‰¹æ€§ã€‚
  - **å›¾å½¢è¡¨ç¤º**ï¼šä½¿ç”¨ç›´æ–¹å›¾ã€å¯†åº¦å›¾ã€ç®±çº¿å›¾ã€æ•£ç‚¹å›¾ç­‰æ¥å¯è§†åŒ–æ•°æ®çš„åˆ†å¸ƒå’Œæ½œåœ¨çš„æ¨¡å¼ã€‚
  - **å›å½’åˆ†æ**ï¼šå»ºç«‹è¿ç»­å‹å˜é‡ä¹‹é—´çš„æ•°å­¦å…³ç³»ï¼Œé¢„æµ‹ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡å¦‚ä½•å½±å“å› å˜é‡ã€‚
  - æ¯”å¦‚è¥¿ç“œçš„ç”œåº¦,å¤§å°,ä»·æ ¼è¿™äº›æ•°æ®å°±å±äºè¿ç»­å‹æ•°æ®,å¯ä»¥ç”¨äºåšå›å½’

### 2.å›å½’å®šä¹‰

- å®šä¹‰

  å›å½’çš„ç›®çš„æ˜¯é¢„æµ‹æ•°å€¼å‹çš„ç›®æ ‡å€¼yã€‚æœ€ç›´æ¥çš„åŠæ³•æ˜¯ä¾æ®è¾“å…¥xå†™å‡ºä¸€ä¸ªç›®æ ‡å€¼yçš„è®¡ç®—å…¬å¼ã€‚

- è¯´æ˜

  å‡å¦‚ä½ æƒ³é¢„æµ‹å°å§å§ç”·å‹æ±½è½¦çš„åŠŸç‡ï¼Œå¯èƒ½ä¼šè¿™ä¹ˆè®¡ç®—ï¼š

  HorsePower = 0.0015 * annualSalary - 0.99 * hoursListeningToPublicRadio

  å†™æˆä¸­æ–‡å°±æ˜¯ï¼š

  å°å§å§ç”·å‹æ±½è½¦çš„åŠŸç‡ = 0.0015 * å°å§å§ç”·å‹å¹´è–ª - 0.99 * æ”¶å¬å…¬å…±å¹¿æ’­çš„æ—¶é—´

  è¿™å°±æ˜¯æ‰€è°“çš„å›å½’æ–¹ç¨‹ï¼ˆregression equationï¼‰ï¼Œå…¶ä¸­çš„0.0015å’Œ-0.99ç§°ä¸ºå›å½’ç³»æ•°ï¼ˆregression weightsï¼‰ï¼Œ**æ±‚è¿™äº›å›å½’ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯å›å½’**ã€‚

### 3.çº¿æ€§å›å½’å®šä¹‰

- å®šä¹‰

  å›å½’ï¼Œä¸€èˆ¬éƒ½æ˜¯æŒ‡çº¿æ€§å›å½’ï¼ˆlinear regressionï¼‰ã€‚çº¿æ€§å›å½’æ„å‘³ç€å¯ä»¥å°†è¾“å…¥é¡¹åˆ†åˆ«ä¹˜ä»¥ä¸€äº›å¸¸é‡ï¼Œå†å°†ç»“æœåŠ èµ·æ¥å¾—åˆ°è¾“å‡ºã€‚çº¿æ€§å›å½’æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ç§**æœ‰ç›‘ç£å­¦ä¹ **çš„ç®—æ³•,**å›å½’é—®é¢˜**ä¸»è¦å…³æ³¨çš„æ˜¯**å› å˜é‡**(éœ€è¦é¢„æµ‹çš„å€¼)å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ•°å€¼å‹çš„**è‡ªå˜é‡**(é¢„æµ‹å˜é‡)ä¹‹é—´çš„å…³ç³»ã€‚

  éœ€è¦é¢„æµ‹çš„å€¼:å³ç›®æ ‡å˜é‡,**target,y**

  å½±å“ç›®æ ‡å˜é‡çš„å› ç´ :$X_1,X_2...X_n$,å¯ä»¥æ˜¯è¿ç»­å€¼ä¹Ÿå¯ä»¥æ˜¯ç¦»æ•£å€¼

  å› å˜é‡å’Œè‡ªå˜é‡ä¹‹é—´çš„å…³ç³»:å³**æ¨¡å‹(model)**,å°±æ˜¯æˆ‘ä»¬è¦æ±‚è§£çš„

  æ¯”å¦‚1ä¸ªåŒ…å­æ˜¯2å…ƒ 3ä¸ªåŒ…å­æ˜¯6å…ƒ  é¢„æµ‹5ä¸ªåŒ…å­å¤šå°‘é’±

  åˆ—å‡ºæ–¹ç¨‹: $y=wx+b$

  å¸¦å…¥:

   2=w*1+b

   6=w*3+b

  è½»æ˜“æ±‚å¾— w=2 b=0

  **æ¨¡å‹**(xä¸yçš„å…³ç³»): $y=2*x+0$

  é¢„æµ‹ x=5 æ—¶ target_y=2*5+0=10å…ƒ

- è¯´æ˜

  **äººå·¥æ™ºèƒ½ä¸­çš„çº¿æ€§å›å½’**:æ•°æ®é›†ä¸­,å¾€å¾€æ‰¾ä¸åˆ°ä¸€ä¸ªå®Œç¾çš„æ–¹ç¨‹å¼æ¥100%æ»¡è¶³æ‰€æœ‰çš„yç›®æ ‡,æˆ‘ä»¬å°±éœ€è¦**æ‰¾å‡ºä¸€ä¸ªæœ€æ¥è¿‘çœŸç†çš„æ–¹ç¨‹å¼**ã€‚

  æ¯”å¦‚:

  æœ‰è¿™æ ·ä¸€ç§æ¤ç‰©ï¼Œåœ¨ä¸åŒçš„æ¸©åº¦ä¸‹ç”Ÿé•¿çš„é«˜åº¦æ˜¯ä¸åŒçš„ï¼Œå¯¹ä¸åŒæ¸©åº¦ç¯å¢ƒä¸‹ï¼Œå‡ é¢—æ¤ç‰©çš„ç¯å¢ƒæ¸©åº¦ï¼ˆæ¨ªåæ ‡ï¼‰ï¼Œæ¤ç‰©ç”Ÿé•¿é«˜åº¦ï¼ˆçºµåæ ‡ï¼‰çš„å…³ç³»è¿›è¡Œäº†é‡‡é›†ï¼Œå¹¶ä¸”å°†å®ƒä»¬ç»˜åˆ¶åœ¨ä¸€ä¸ªäºŒç»´åæ ‡ä¸­ï¼Œå…¶åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

  åæ ‡åˆ†åˆ«ä¸º[4.2, 3.8]ï¼Œ[4.2, 2.7]ï¼Œ[2.7, 2.4]ï¼Œ[0.8, 1.0]ï¼Œ[3.7, 2.8]ï¼Œ[1.7, 0.9]ï¼Œ[3.2, 2.9]ã€‚

  ![linear](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/linear.png)

  æˆ‘ä»¬å‘ç°è¿™äº›ç‚¹å¥½åƒåˆ†å¸ƒåœ¨ä¸€æ¡ç›´çº¿çš„é™„è¿‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æ‰¾åˆ°è¿™æ ·ä¸€æ¡ç›´çº¿ï¼Œå»â€œ**æ‹Ÿåˆ**â€è¿™äº›ç‚¹ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è·å–ç¯å¢ƒçš„æ¸©åº¦å¤§æ¦‚åˆ¤æ–­æ¤ç‰©åœ¨æŸä¸ªæ¸©åº¦ä¸‹çš„ç”Ÿé•¿é«˜åº¦äº†ã€‚

### 4.æŸå¤±å‡½æ•°

æ•°æ®: [[4.2, 3.8]ï¼Œ[4.2, 2.7]ï¼Œ[2.7, 2.4]ï¼Œ[0.8, 1.0]ï¼Œ[3.7, 2.8]ï¼Œ[1.7, 0.9]ï¼Œ[3.2, 2.9]]

æˆ‘ä»¬å‡è®¾ è¿™ä¸ªæœ€ä¼˜çš„æ–¹ç¨‹æ˜¯:

$y=wx+b$

è¿™æ ·çš„ç›´çº¿éšç€wå’Œbçš„å–å€¼ä¸åŒ  å¯ä»¥ç”»å‡ºæ— æ•°æ¡

**åœ¨è¿™æ— æ•°æ¡ä¸­,åˆ¤æ–­å“ªä¸€æ¡æ›´å¥½æ‹Ÿåˆæ•°æ®ç‚¹**

![loss](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/loss.png)

**é€‰æ‹©å‡æ–¹å·®æ¥è¿›è¡Œåˆ¤æ–­**

**å°±æ˜¯æ¯ä¸ªç‚¹åˆ°çº¿çš„ç«–ç›´æ–¹å‘çš„è·ç¦»å¹³æ–¹ æ±‚å’Œ åœ¨å¹³å‡ æœ€å°æ—¶ è¿™æ¡ç›´æ¥å°±æ˜¯æœ€ä¼˜ç›´çº¿**

![loss_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/loss_2.png)

å‡è®¾: $y=wx+b$

æŠŠ $x_1,x_2,x_3...$ å¸¦å…¥è¿›å»  ç„¶åå¾—å‡º:

$y_1^,=wx_1+b$

$y_2^,=wx_2+b$

$y_3^,=wx_3+b$

...

ç„¶åè®¡ç®— ${y_1-y_1^,}$ è¡¨ç¤ºç¬¬ä¸€ä¸ªç‚¹çš„çœŸå®å€¼å’Œè®¡ç®—å€¼çš„å·®å€¼ ,ç„¶åæŠŠç¬¬äºŒä¸ªç‚¹,ç¬¬ä¸‰ä¸ªç‚¹...æœ€åä¸€ä¸ªç‚¹çš„å·®å€¼å…¨éƒ¨ç®—å‡ºæ¥ã€‚

æ€»è¯¯å·®(ä¹Ÿå°±æ˜¯æŸå¤±å€¼): 

$loss={(y_1-y_1^,)^2}+{(y_2-y_2^,)^2}+....{(y_n-y_n^,)^2}$

å¹³å‡è¯¯å·®ï¼ˆæŸå¤±å‡½æ•°ï¼‰ï¼ˆè§£å†³æ ·æœ¬ç‚¹ä¸ªæ•°ä¸åŒå¸¦æ¥çš„å½±å“ï¼‰

 $\bar e = \frac{1}{n} \textstyle\sum_{i=1}^{n}(y_{i}-w x_{i} - b)^{2}$

**ä¸ºè®©æŸå¤±å‡½æ•°çš„å€¼æœ€å°ï¼Œå…ˆå‡è®¾b=0**

$$
\begin{aligned} 
\bar e
&=\frac{1}{n} \textstyle\sum_{i=1}^{n}(w x_{i}-y_{i})^{2}\\
&={\frac{1}{n}}\sum_{i=1}^{n}x_{i}^{2}w^{2}-{\frac{2}{n}}\sum_{i=1}^{n} x_{i}y_{i}w+{\frac{1}{n}}\sum_{i=1}^{n} y_{i}^{2}\\
&x_i,y_iéƒ½æ˜¯å·²çŸ¥çš„å› æ­¤:\\
&= {a w^{2}+b w+c} \\
&= 10w^{2}-15.9w+6.5 \end{aligned}
$$

æ ¹æ®æ±‚å¯¼åŸç†ï¼Œæ±‚å¾—w=0.795æ—¶æŸå¤±å‡½æ•°å–å¾—æœ€å°å€¼ï¼Œ $y=0.795x+0$ 


æ€»ç»“:  

1.å®é™…æ•°æ®ä¸­ xå’Œyç»„æˆçš„ç‚¹ ä¸ä¸€å®šæ˜¯å…¨éƒ¨è½åœ¨ä¸€æ¡ç›´çº¿ä¸Š

2.æˆ‘ä»¬å‡è®¾æœ‰è¿™ä¹ˆä¸€æ¡ç›´çº¿ $y=wx+b$ æ˜¯æœ€ç¬¦åˆæè¿°è¿™äº›ç‚¹çš„

3.æœ€ç¬¦åˆçš„æ¡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹ç¨‹å¸¦å…¥æ‰€æœ‰xè®¡ç®—å‡ºçš„æ‰€æœ‰yä¸çœŸå®çš„yå€¼åš å‡æ–¹å·®è®¡ç®—  

4.æ‰¾åˆ°å‡æ–¹å·®æœ€å°çš„é‚£ä¸ªw

5.è¿™æ ·å°±æ±‚å‡ºäº†æœ€ä¼˜è§£çš„å‡½æ•°(å‰ææ¡ä»¶æ˜¯å‡è®¾b=0)

### 5.å¤šå‚æ•°å›å½’

æ¡ˆä¾‹: å‡è®¾ä¸€ä¸ªäººå¥åº·ç¨‹åº¦æ€ä¹ˆæ ·,ç”±å¾ˆå¤šå› ç´ ç»„æˆ

| è¢«çˆ± | å­¦ä¹ æŒ‡æ•° | æŠ—å‹æŒ‡æ•° | è¿åŠ¨æŒ‡æ•° | é¥®é£Ÿæƒ…å†µ | é‡‘é’± | å¿ƒæ€ | å‹åŠ› | å¥åº·ç¨‹åº¦ |
| ---- | -------- | -------- | -------- | -------- | ---- | ---- | ---- | -------- |
| 0    | 14       | 8        | 0        | 5        | -2   | 9    | -3   | 339      |
| -4   | 10       | 6        | 4        | -14      | -2   | -14  | 8    | -114     |
| -1   | -6       | 5        | -12      | 3        | -3   | 2    | -2   | 30       |
| 5    | -2       | 3        | 10       | 5        | 11   | 4    | -8   | 126      |
| -15  | -15      | -8       | -15      | 7        | -4   | -12  | 2    | -395     |
| 11   | -10      | -2       | 4        | 3        | -9   | -6   | 7    | -87      |
| -14  | 0        | 4        | -3       | 5        | 10   | 13   | 7    | 422      |
| -3   | -7       | -2       | -8       | 0        | -6   | -5   | -9   | -309     |

karençš„å„é¡¹æŒ‡æ ‡æ˜¯:è¢«çˆ±:11 å­¦ä¹ æŒ‡æ•°:14  æŠ—å‹æŒ‡æ•°:8  è¿åŠ¨æŒ‡æ•°:10  é¥®é£Ÿæ°´å¹³:5  é‡‘é’±:10 å¿ƒæ€:8 å‹åŠ›:1

é‚£ä¹ˆkarençš„å¥åº·ç¨‹åº¦æ˜¯å¤šå°‘?

ç»“åˆè¡¨ä¸­æ•°æ®ï¼Œé™ˆåˆ—æ–¹ç¨‹ï¼š

$14w_2+8w_3+5w_5+-2w_6+9w_7+-3w_8=399$

$-4w_1+10w_2+6w_3+4w_4+-14w_5+-2w_6+-14w_7+8w_8=-144$

$-1w_1+-6w_2+5w_3+-12w_4+3w_3+-3w_6+2w_7+-2w_8=30$

$5w_1+-2w_2+3w_3+10w_4+5w_5+11w_6+4w_7+-8w_8=126$

$-15w_1+-15w_2+-8w_3+-15w_4+7w_5+-4w_6+-12w_7+2w_8=126$

$11w_1+-10w_2+-2w_3+4w_4+3w_5+-9w_6+-6w_7+7w_8=-87$

$-14w_1+4w_3+-3w_4+5w_5+10w_6+13w_7+7w_8=422$

$-3w_1+-7w_2+-2w_3+-8w_4+-6w_6+-5w_7+-9w_8=-309$

**å¦‚æœè¯¥æ–¹ç¨‹æœ‰è§£ï¼Œåˆ™è§£å‡º æƒé‡ $w(w_1,w_2...w_8)$ ç„¶åå¸¦å…¥å³å¯æ±‚å‡ºkarençš„å¥åº·ç¨‹åº¦ã€‚**

**å¤šå…ƒçº¿æ€§å›å½’ï¼š**

$y^,=w_1x_1+w_2x_2+....w_nx_n+b$

bæ˜¯æˆªè·,æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨$w_0$æ¥è¡¨ç¤ºåªè¦æ˜¯ä¸ªå¸¸é‡å°±è¡Œ

$y^,=w_1x_1+w_2x_2+....w_nx_n+w_0$

$y^,=w_1x_1+w_2x_2+....w_nx_n+w_0*1$

é‚£ä¹ˆæŸå¤±å‡½æ•°å°±æ˜¯

$loss=[(y_1-y_1^,)^2+(y_2-y_2^,)^2+....(y_n-y_n^,)^2]/n$

**é€šè¿‡æœ€å°äºŒä¹˜æ³•MSEä½¿å¾—lossæœ€å°**

### 6.æœ€å°äºŒä¹˜æ³•MSE

#### 6.1å¸¸ç”¨å…¬å¼

![fang_c](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/fang_c.png)

#### 6.2æ•°æ®çŸ©é˜µåŒ–
![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/react.png)
  

#### 6.3æœ€å°äºŒä¹˜æ³•

- æ–¹æ³•ä¸€ï¼ˆæ¯”è¾ƒç¹çï¼‰
- ![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/MSE_11.png)


  è™½ç„¶è¿™ä¸ªæ¡ˆä¾‹ä¸­n=8,ä½†æ˜¯å¸¸å¸¸ä»¤n=2,å› ä¸ºæ˜¯ä¸€ä¸ªå¸¸æ•° æ±‚æœ€å°å€¼æ—¶néšä¾¿å–å“ªä¸ªæ­£æ•°éƒ½ä¸ä¼šå½±å“Wç»“æœ,ä½†æ˜¯æ±‚å¯¼è¿‡ç¨‹å¯ä»¥çº¦æ‰å‰é¢çš„ç³»æ•°,ä¼šåŠ é€Ÿåé¢çš„è®¡ç®—

  $h(x_1)è¡¨ç¤ºy^,_1= Xç¬¬1è¡Œåˆ†åˆ«å’ŒWç›¸ä¹˜$

  $h(x_2)è¡¨ç¤ºy^,_2= Xç¬¬2è¡Œåˆ†åˆ«å’ŒWç›¸ä¹˜$

  ...

  é«˜æ–¯æŠŠå…¬å¼ç»™äº†,ä½†æ˜¯ä½•æ—¶lossæœ€å°å‘¢?

  1.äºŒæ¬¡æ–¹ç¨‹å¯¼æ•°ä¸º0æ—¶æœ€å°

  $loss=\frac{1}{2}||(XW-y)||^2 æ±‚å¯¼:$

  2.å…ˆå±•å¼€çŸ©é˜µä¹˜æ³•

  $loss=\frac{1}{2}(XW-y)^T(XW-y)$

  $loss=\frac{1}{2}(W^TX^T-y^T)(XW-y)$

  $loss=\frac{1}{2}(W^TX^TXW-W^TX^Ty-y^TXW+y^Ty)$

  3.è¿›è¡Œæ±‚å¯¼(æ³¨æ„X,yéƒ½æ˜¯å·²çŸ¥çš„,Wæ˜¯æœªçŸ¥çš„)

  $loss'=\frac{1}{2}(W^TX^TXW-W^TX^Ty-y^TXW+y^Ty)'$

  $loss'=\frac{1}{2}(X^TXW+(W^TX^TX)^T-X^Ty-(y^TX)^T)$

  $loss'=\frac{1}{2}(X^TXW+X^TXW-X^Ty-X^Ty)$

  $loss'=\frac{1}{2}(2X^TXW-2X^Ty)$

  $loss'=X^TXW-X^Ty$

  4.ä»¤å¯¼æ•°$loss'=0$

  $0=X^TXW-X^Ty$

  $X^TXW=X^Ty$

  5.çŸ©é˜µæ²¡æœ‰é™¤æ³•,ä½¿ç”¨é€†çŸ©é˜µè½¬åŒ–

  $(X^TX)^{-1}(X^TX)W=(X^TX)^{-1}X^Ty$

  $W=(X^TX)^{-1}X^Ty$

- æ–¹æ³•äºŒï¼ˆé“¾å¼æ±‚å¯¼æ³•åˆ™ï¼Œæ·±åº¦å­¦ä¹ å¸¸ç”¨ï¼‰
- ![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/lian.png)

  karençš„å„é¡¹æŒ‡æ ‡æ˜¯:è¢«çˆ±:11 å­¦ä¹ æŒ‡æ•°:14  æŠ—å‹æŒ‡æ•°:8  è¿åŠ¨æŒ‡æ•°:10  é¥®é£Ÿæ°´å¹³:5  é‡‘é’±:10 æƒåˆ©:8 å‹åŠ›:1

  åˆ†åˆ«ç”¨Wå„é¡¹ä¹˜ä»¥æ–°çš„X å°±å¯ä»¥å¾—åˆ°yå¥åº·ç¨‹åº¦

#### 6.4 API

```python
sklearn.linear_model.LinearRegression()
åŠŸèƒ½ï¼š æ™®é€šæœ€å°äºŒä¹˜æ³•çº¿æ€§å›å½’, æƒé‡å’Œåç½®æ˜¯ç›´æ¥ç®—å‡ºæ¥çš„ï¼Œå¯¹äºæ•°é‡å¤§çš„ä¸é€‚ç”¨ï¼Œå› ä¸ºè®¡ç®—é‡å¤ªå¤§ï¼Œè®¡ç®—é‡å¤ªå¤§çš„é€‚åˆä½¿ç”¨é€’åº¦ä¸‹é™æ³•

å‚æ•°ï¼š
fit_intercept	bool, default=True
	æ˜¯å¦è®¡ç®—æ­¤æ¨¡å‹çš„æˆªè·(åç½®)ã€‚å¦‚æœè®¾ç½®ä¸ºFalseï¼Œåˆ™åœ¨è®¡ç®—ä¸­å°†ä¸ä½¿ç”¨æˆªè·ï¼ˆå³ï¼Œæ•°æ®åº”ä¸­å¿ƒåŒ–ï¼‰ã€‚
å±æ€§:	 
coef_ å›å½’åçš„æƒé‡ç³»æ•°
intercept_ åç½®

print("æƒé‡ç³»æ•°ä¸ºï¼š\n", estimator.coef_)  #æƒé‡ç³»æ•°ä¸ç‰¹å¾æ•°ä¸€å®šæ˜¯åŒæ ·çš„ä¸ªæ•°ã€‚
print("åç½®ä¸ºï¼š\n", estimator.intercept_)
```

#### 6.5 å®ä¾‹

```python
from sklearn.linear_model import LinearRegression
import numpy as np
data=np.array([[0,14,8,0,5,-2,9,-3,399],
               [-4,10,6,4,-14,-2,-14,8,-144],
               [-1,-6,5,-12,3,-3,2,-2,30],
               [5,-2,3,10,5,11,4,-8,126],
               [-15,-15,-8,-15,7,-4,-12,2,-395],
               [11,-10,-2,4,3,-9,-6,7,-87],
               [-14,0,4,-3,5,10,13,7,422],
               [-3,-7,-2,-8,0,-6,-5,-9,-309]])
x=data[:,0:8]
y=data[:,8:]
estimator=LinearRegression(fit_intercept=False)
estimator.fit(x,y)
print("æƒé‡ç³»æ•°ä¸ºï¼š\n", estimator.coef_)  #æƒé‡ç³»æ•°ä¸ç‰¹å¾æ•°ä¸€å®šæ˜¯åŒæ ·çš„ä¸ªæ•°ã€‚
print("åç½®ä¸ºï¼š\n", estimator.intercept_)
x_new=[[11,14,8,10,5,10,8,1]]
y_predict=estimator.predict(x)
print("é¢„æµ‹ç»“æœ:\n",y_predict)
print(-3*0.4243965-7*7.32281732-2*15.05217218-8*3.5996297+0*12.05805264-6*1.76972959-5*17.0276393-9*11.31212591)
```

![end_total](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/end_total.png)
  ### 7.æ¢¯åº¦ä¸‹é™

#### 7.1 æ¢¯åº¦ä¸‹é™æ¦‚å¿µ

![gradient](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gradient.png)

- è‡ªæˆ‘ç†è§£

  æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•ã€‚å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªæ‰¾å±±åº•çš„è¿‡ç¨‹ã€‚

  å‡è®¾ä¸€ä¸ªäººè¢«æ”¾åœ¨ä¸€åº§å±±ä¸Šï¼Œä»–çš„ç›®æ ‡æ˜¯æ‰¾åˆ°å±±çš„æœ€ä½ç‚¹ã€‚ä½†æ˜¯ï¼Œæ— æ³•çœ‹åˆ°å…¨å±€åœ°å½¢ï¼Œåªèƒ½æ„ŸçŸ¥åˆ°è‡ªå·±è„šä¸‹ä½ç½®çš„å¡åº¦ã€‚æ¢¯åº¦ä¸‹é™å°±æ˜¯åˆ©ç”¨è¿™ç§å±€éƒ¨ä¿¡æ¯æ¥å†³å®šåº”è¯¥å¾€å“ªä¸ªæ–¹å‘èµ°ä»¥åŠèµ°å¤šè¿œã€‚

  åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œâ€œæ¢¯åº¦â€æŒ‡çš„æ˜¯å‡½æ•°ï¼ˆæ¯”å¦‚å±±çš„é«˜åº¦ï¼‰åœ¨æŸä¸€ç‚¹çš„å˜åŒ–ç‡æˆ–æ–œç‡ï¼Œå®ƒæŒ‡ç¤ºäº†å‡½æ•°å€¼å¢åŠ æœ€å¿«ï¼ˆå¡åº¦æœ€é™¡å³­ï¼‰çš„æ–¹å‘ã€‚â€œä¸‹é™â€åˆ™æ„å‘³ç€æˆ‘ä»¬æœç€ä¸æ¢¯åº¦ç›¸åçš„æ–¹å‘ç§»åŠ¨ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ–æŸä¸ªå‡½æ•°ï¼ˆæ¯”å¦‚æ‰¾åˆ°å±±è°·çš„æœ€ä½ç‚¹ï¼‰ã€‚

  å…·ä½“åˆ°æ•°å­¦ä¸Šï¼Œæ¢¯åº¦ä¸‹é™é€šè¿‡è¿­ä»£æ›´æ–°å‚æ•°ï¼ˆå¦‚æ¨¡å‹ä¸­çš„æƒé‡ï¼‰æ¥é€æ¸å‡å°‘æŸå¤±å‡½æ•°ï¼ˆè¡¡é‡é¢„æµ‹ç»“æœä¸å®é™…ç»“æœä¹‹é—´å·®è·çš„å‡½æ•°ï¼‰çš„å€¼ã€‚æ¯æ¬¡è¿­ä»£æ—¶ï¼Œéƒ½ä¼šè®¡ç®—å½“å‰å‚æ•°è®¾ç½®ä¸‹çš„æ¢¯åº¦ï¼Œå¹¶æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘è°ƒæ•´å‚æ•°å€¼ï¼Œç›´åˆ°è¾¾åˆ°ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼æˆ–è€…æ»¡è¶³æŸç§åœæ­¢æ¡ä»¶ã€‚

  ç®€å•æ¥è¯´ï¼Œæ¢¯åº¦ä¸‹é™å°±åƒæ˜¯ä¸€ä¸ªäººåœ¨ä¸‹å±±ï¼Œä¸æ–­æ ¹æ®è„šä¸‹çš„æ–œå¡è°ƒæ•´æ­¥ä¼å¤§å°å’Œæ–¹å‘ï¼Œæœ€ç»ˆæ‰¾åˆ°å±±è°·åº•éƒ¨çš„è¿‡ç¨‹ã€‚

- å®é™…å®šä¹‰

  æœºå™¨å­¦ä¹ ä¸­ï¼Œ**æ¢¯åº¦è¡¨ç¤ºæŸå¤±å‡½æ•°å¯¹äºæ¨¡å‹å‚æ•°çš„åå¯¼æ•°**ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ªå¯è®­ç»ƒå‚æ•°ï¼Œ**æ¢¯åº¦å‘Šè¯‰æˆ‘ä»¬åœ¨å½“å‰å‚æ•°å€¼ä¸‹ï¼Œæ²¿ç€æ¯ä¸ªå‚æ•°æ–¹å‘å˜åŒ–æ—¶ï¼ŒæŸå¤±å‡½æ•°çš„å˜åŒ–ç‡**ã€‚é€šè¿‡è®¡ç®—æŸå¤±å‡½æ•°å¯¹å‚æ•°çš„æ¢¯åº¦ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•èƒ½å¤Ÿæ ¹æ®æ¢¯åº¦çš„ä¿¡æ¯æ¥è°ƒæ•´å‚æ•°ï¼Œ**æœç€å‡å°‘æŸå¤±çš„æ–¹å‘æ›´æ–°æ¨¡å‹**ï¼Œä»è€Œé€æ­¥ä¼˜åŒ–æ¨¡å‹ï¼Œä½¿å¾—æ¨¡å‹æ€§èƒ½æ›´å¥½ã€‚

**æ¢¯åº¦ä¸‹é™æ³•(**Gradient Descent)ï¼Œç›¸æ¯”äºæœ€å°äºŒä¹˜æ³•(MSE)è®¡ç®—é‡æ›´å°ï¼Œé€Ÿåº¦æ›´å¿«ã€‚

#### 7.2 æ¢¯åº¦ä¸‹é™æ­¥éª¤

![gradient_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gradient_1.png)

1ã€Randoméšæœºæ•°ç”Ÿæˆåˆå§‹Wï¼Œä¸€èˆ¬éšæœºç”Ÿæˆä¸€ç»„æˆæ­£å¤ªåˆ†å¸ƒçš„æ•°å€¼ $w_0,w_1,w_2....w_n$ ï¼Œæˆ–è€…è‡ªå·±æ‹Ÿå®šåˆå§‹Wå€¼ã€‚

2ã€æ±‚æ¢¯åº¦gï¼Œæ¢¯åº¦ä»£è¡¨æ›²çº¿æŸç‚¹ä¸Šçš„åˆ‡çº¿çš„æ–œç‡ï¼Œ**æ²¿ç€åˆ‡çº¿å¾€ä¸‹å°±ç›¸å½“äºæ²¿ç€å¡åº¦æœ€é™¡å³­çš„æ–¹å‘ä¸‹é™**ã€‚

3ã€if g < 0,wå˜å¤§ï¼Œif g >0,wå˜å°**(ç›®æ ‡å·¦è¾¹æ˜¯æ–œç‡ä¸ºè´Ÿå³è¾¹ä¸ºæ­£ )**

4ã€åˆ¤æ–­æ˜¯å¦æ”¶æ•›ï¼Œå¦‚æœæ”¶æ•›è·³å‡ºè¿­ä»£ï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ°æ”¶æ•›ï¼Œå›ç¬¬2æ­¥å†æ¬¡æ‰§è¡Œ2~4æ­¥æ”¶æ•›çš„åˆ¤æ–­æ ‡å‡†æ˜¯:éšç€è¿­ä»£è¿›è¡ŒæŸ¥çœ‹æŸå¤±å‡½æ•°Lossçš„å€¼ï¼Œå˜åŒ–éå¸¸å¾®å°ç”šè‡³ä¸å†æ”¹å˜ï¼Œå³è®¤ä¸ºè¾¾åˆ°æ”¶æ•›

5.ä¸Šé¢ç¬¬4æ­¥ä¹Ÿå¯ä»¥å›ºå®šè¿­ä»£æ¬¡æ•°

#### 7.3 æ¢¯åº¦ä¸‹é™å…¬å¼

![gradient_2](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gradient_2.png)

![gradient_3](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/gradient_3.png)

éšæœºç»™ä¸€ä¸ªwåˆå§‹å€¼,ç„¶åå°±ä¸åœçš„ä¿®æ”¹å®ƒ,ç›´åˆ°è¾¾åˆ°æŠ›ç‰©çº¿æœ€ä¸‹é¢é™„è¿‘,æ¯”å¦‚

w=0.2

w=w-0.01*wä¸º0.2æ—¶çš„æ¢¯åº¦(å¯¼æ•°) ç®—å‡ºæ¥æ˜¯ 0.198

w=w-0.01*wä¸º0.198æ—¶çš„æ¢¯åº¦(å¯¼æ•°) ç®—å‡ºæ¥æ˜¯ 0.19602

ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚

å°±è¿™æ ·ä¸€ç›´æ›´æ–°ä¸‹å»,ä¼šåœ¨çœŸå®å€¼é™„è¿‘,æˆ‘ä»¬å¯ä»¥æ§åˆ¶æ›´æ–°çš„æ¬¡æ•°

**è‹¥wåœ¨ç›®æ ‡å€¼å·¦è¾¹ï¼Œå¯¼æ•°æ˜¯è´Ÿæ•° ï¼Œå‡å»è´Ÿæ•°å°±æ˜¯åŠ ï¼Œå¾€å³ç§»åŠ¨**

**è‹¥wåœ¨ç›®æ ‡å€¼å³è¾¹ï¼Œå¯¼æ•°æ˜¯æ­£æ•° ï¼Œå‡å»æ­£æ•°å°±æ˜¯å‡ï¼Œå¾€å·¦ç§»åŠ¨**

#### 7.4 å­¦ä¹ ç‡

- å®šä¹‰

  ç”¨æ¥è°ƒæ•´æ¢¯åº¦ä¸‹é™çš„å¹…åº¦é—®é¢˜

- ä½œç”¨

  ![learning_rate](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/learning_rate.png)

  ä¸€èˆ¬æƒ…å†µä¸‹å­¦ä¹ ç‡åœ¨æ•´ä½“è¿­ä»£è¿‡ç¨‹ä¸­æ˜¯ä¸å˜ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥è®¾ç½®æˆ**éšç€è¿­ä»£æ¬¡æ•°å¢å¤šå­¦ä¹ ç‡é€æ¸å˜å°**

  ä¾‹å¦‚ï¼šï¼ˆlearning_rate/(å›ºå®šæ•°å€¼+è¿­ä»£æ¬¡æ•°)ï¼‰

#### 7.5 ä»£ç å®ç°æ¢¯åº¦ä¸‹é™

##### 1.ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹

- å…¬å¼

  $loss(w_1)=(w_1-3.5)^2-4.5w_1+10$

- å›¾ç¤º

  ![one_yuan](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/one_yuan.png)

- ä»£ç 

  ```python
  import numpy as np
  
  # éšæœºåˆå§‹åŒ–w1
  np.random.seed(22)
  w1 = np.random.randint(0, 12)
  # å®šä¹‰æŸå¤±å‡½æ•°
  loss = (w1 - 3.5) ** 2 - 4.5 * w1 + 10
  # å®šä¹‰è‡ªé€‚åº”å­¦ä¹ ç‡
  t0, t1 = 1, 100
  # å®šä¹‰è¿­ä»£éƒ¨ç½²æ¬¡æ•°
  step = 1000
  # è¿­ä»£æ›´æ–°w1
  for i in range(step):
      a = t0 / (t1 + i)  # è‡ªé€‚åº”å­¦ä¹ ç‡
      gradient = 2 * (w1 - 3.5) - 4.5  # æŸå¤±å‡½æ•°å¯¼æ•°ï¼ˆæ¢¯åº¦ï¼‰
      w1 = w1 - a * gradient  # æ›´æ–°w1
      loss = (w1 - 3.5) ** 2 - 4.5 * w1 + 10  # è®¡ç®—æŸå¤±å€¼
      print(f'ç¬¬{i + 1}æ¬¡è¿­ä»£ï¼Œw1={w1},æ›´æ–°åçš„æŸå¤±å€¼={loss}')
  ```

  ![one_yuan_end](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/one_yuan_end.png)

##### 2.äºŒå…ƒäºŒæ¬¡æ–¹ç¨‹

- å…¬å¼

  **$loss(w_1,w_2)=(w_1-3.5)^2+(w_2-2)^2+3w_1w_2-4.5w_1+2w_2+20$**

  **æ±‚æ¢¯åº¦æ—¶ï¼ŒåŒæ—¶æ›´æ–°w1,w2,åœ¨æ•°å­¦è§’åº¦ä¸Šï¼Œå°±æ˜¯æ±‚w1ã€w2çš„åå¯¼æ•°**

- å›¾ç¤º

  ![two_yuan](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/two_yuan.png)

- ä»£ç 

  ```python
  #åˆå§‹åŒ–w1,w2
  np.random.seed(44)
  w1=np.random.randint(0,12)
  w2=np.random.randint(0,12)
  #å®šä¹‰æŸå¤±å‡½æ•°
  loss=(w1-3.5)**2+(w2-2)**2+3*w1*w2-4.5*w1+2*w2+10
  #å®šä¹‰è‡ªé€‚åº”å­¦ä¹ ç‡
  t0,t1=1,100
  #å®šä¹‰è¿­ä»£éƒ¨ç½²æ¬¡æ•°
  step=100
  #è¿­ä»£æ›´æ–°w1,w2
  for i in range(step):
      a=t0/(t1+i)#è‡ªé€‚åº”å­¦ä¹ ç‡
      s_w1=w1#ä¿å­˜èµ·æ¥  é˜²æ­¢æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­w1å’Œw2çš„å€¼å‘ç”Ÿæ”¹å˜
      s_w2=w2
  
      g_w1=2*(s_w1-3.5)+3*s_w2-4.5#w1æ–¹å‘çš„æ¢¯åº¦ï¼ˆå¯¼æ•°ï¼‰
      g_w2=2*(s_w2-2)+3*s_w1+2#w2æ–¹å‘çš„æ¢¯åº¦ï¼ˆå¯¼æ•°ï¼‰
  
      w1=w1-a*g_w1#æ›´æ–°w1
      w2=w2-a*g_w2#æ›´æ–°w2
      loss=(w1-3.5)**2+(w2-2)**2+3*w1*w2-4.5*w1+2*w2+10#è®¡ç®—æŸå¤±å€¼
      print(f'ç¬¬{i+1}æ¬¡è¿­ä»£ï¼Œw1={w1},w2={w2},æ›´æ–°åçš„æŸå¤±å€¼={loss}')
  ```

  ![two_yuan_end](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/two_yuan_end.png)

#### 7.6 sklearn APIå®ç°æ¢¯åº¦ä¸‹é™

- ä¸‰ç§æ¢¯åº¦ç®—æ³•

  æ‰¹é‡æ¢¯åº¦ä¸‹é™BGD(Batch Gradient Descent) 

  å°æ‰¹é‡æ¢¯åº¦ä¸‹é™MBGD(Mini-BatchGradient Descent)

  éšæœºæ¢¯åº¦ä¸‹é™SGD(Stochastic Gradient Descent)

- ä¸‰ç§æ¢¯åº¦ä¸‹é™è¿‡ç¨‹

  ![three_garident](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/three_garident.png)

- ä¸‰ç§æ¢¯åº¦ä¸‹é™åŒºåˆ«

  - **Batch Gradient Descent (BGD)**: æ¯ä¸€æ¬¡è¿­ä»£éƒ½ä¼šä½¿ç”¨**å…¨éƒ¨çš„è®­ç»ƒæ ·æœ¬è®¡ç®—æ¢¯åº¦æ¥æ›´æ–°æƒé‡**ã€‚è¿™æ„å‘³ç€æ¯ä¸€æ­¥æ¢¯åº¦æ›´æ–°éƒ½æ˜¯åŸºäºæ•´ä¸ªæ•°æ®é›†çš„å¹³å‡æ¢¯åº¦ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æ¯æ¬¡æ›´æ–°çš„æ–¹å‘æ˜¯æœ€å‡†ç¡®çš„ï¼Œä½†**ç¼ºç‚¹æ˜¯è®¡ç®—é‡å¤§ä¸”é€Ÿåº¦æ…¢**ï¼Œå°¤å…¶æ˜¯åœ¨å¤§æ•°æ®é›†ä¸Šã€‚
  - **Mini-Batch Gradient Descent (MBGD)**: è¿™ç§æ–¹æ³•ä»‹äºæ‰¹é‡æ¢¯åº¦ä¸‹é™å’Œéšæœºæ¢¯åº¦ä¸‹é™ä¹‹é—´ã€‚å®ƒä¸æ˜¯ç”¨å…¨éƒ¨æ ·æœ¬ä¹Ÿä¸æ˜¯åªç”¨ä¸€ä¸ªæ ·æœ¬ï¼Œè€Œæ˜¯**æ¯æ¬¡è¿­ä»£ä»æ•°æ®é›†ä¸­éšæœºæŠ½å–ä¸€å°éƒ¨åˆ†æ ·æœ¬ï¼ˆä¾‹å¦‚ï¼Œä»500ä¸ªæ ·æœ¬ä¸­é€‰å–32ä¸ªï¼‰**ï¼Œç„¶ååŸºäºè¿™ä¸€å°æ‰¹æ ·æœ¬çš„å¹³å‡æ¢¯åº¦æ¥æ›´æ–°æƒé‡ã€‚è¿™ç§æ–¹æ³•åœ¨å‡†ç¡®æ€§å’Œè®¡ç®—æ•ˆç‡ä¹‹é—´å–å¾—äº†ä¸€ä¸ªå¹³è¡¡ã€‚
  - **Stochastic Gradient Descent (SGD)**: åœ¨éšæœºæ¢¯åº¦ä¸‹é™ä¸­ï¼Œ**æ¯æ¬¡è¿­ä»£ä»…ä½¿ç”¨éšæœºå•ä¸ªæ ·æœ¬**ï¼ˆæˆ–æœ‰æ—¶ç§°ä¸ºâ€œä¾‹å­â€ï¼‰æ¥è®¡ç®—æ¢¯åº¦å¹¶æ›´æ–°æƒé‡ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿæ›´å¿«åœ°æ”¶æ•›ï¼Œä½†ç”±äºæ¯æ¬¡æ›´æ–°éƒ½åŸºäºå•ä¸ªæ ·æœ¬ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æƒé‡æ›´æ–°è·¯å¾„ä¸ç¨³å®šã€‚

#### 7.7 æ‰¹é‡æ¢¯åº¦ä¸‹é™BGD

- åŸç†

  æ¯ä¸€æ¬¡è¿­ä»£éƒ½ä¼šä½¿ç”¨**å…¨éƒ¨çš„è®­ç»ƒæ ·æœ¬è®¡ç®—æ¢¯åº¦æ¥æ›´æ–°æƒé‡**ï¼Œå¹¶æ®æ­¤æ›´æ–°æ¨¡å‹å‚æ•°ã€‚æ­¤æ–¹æ³•ä¸å¸¸ç”¨ï¼Œæ²¡æœ‰å®˜æ–¹APIï¼Œå¯è‡ªå·±å®ç°ã€‚

- å¦‚ä½•æ›´æ–°

  è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å« \( m \) ä¸ªè®­ç»ƒæ ·æœ¬çš„æ•°æ®é›† $\{(x^{(i)}, y^{(i)})\}_{i=1}^{m}$ ï¼Œå…¶ä¸­ $x^{(i)}$ æ˜¯è¾“å…¥ç‰¹å¾ï¼Œ $y^{(i)}$ æ˜¯å¯¹åº”çš„æ ‡ç­¾ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ–æŸå¤±å‡½æ•° $J(\theta)$ ç›¸å¯¹äºæ¨¡å‹å‚æ•° $\theta$ çš„å€¼ã€‚

  æŸå¤±å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š
  $J(\theta) = \frac{1}{2m} \sum_{i=1}^{m} (h_\theta(x^{(i)}) - y^{(i)})^2$ 

  å…¶ä¸­ $h_\theta(x^{(i)})$ æ˜¯æ¨¡å‹å¯¹ç¬¬ $i$ ä¸ªæ ·æœ¬çš„é¢„æµ‹è¾“å‡ºã€‚

  æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ›´æ–°è§„åˆ™ä¸ºï¼š
  $\theta_j:=\theta_j-\alpha\frac{1}{m}\sum_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)}) \cdot x_j^{(i)}$
  å¯¹äº $j=0,1,\ldots,n$ ï¼ˆå…¶ä¸­ $n$ æ˜¯ç‰¹å¾çš„æ•°é‡ï¼‰ï¼Œå¹¶ä¸” $\alpha$ æ˜¯å­¦ä¹ ç‡ã€‚

- ç‰¹ç‚¹

  - **å‡†ç¡®æ€§**ï¼šç”±äºä½¿ç”¨äº†æ‰€æœ‰è®­ç»ƒæ ·æœ¬ï¼Œæ‰€ä»¥å¾—åˆ°çš„æ¢¯åº¦æ˜¯æœ€å‡†ç¡®çš„ï¼Œè¿™æœ‰åŠ©äºæ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€‚
  - **è®¡ç®—æˆæœ¬**ï¼šæ¯æ¬¡æ›´æ–°éƒ½éœ€è¦éå†æ•´ä¸ªæ•°æ®é›†ï¼Œå› æ­¤è®¡ç®—é‡è¾ƒå¤§ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°æ®é›†å¾ˆå¤§çš„æƒ…å†µä¸‹ã€‚
  - **æ”¶æ•›é€Ÿåº¦**ï¼šè™½ç„¶æ¯ä¸€æ­¥çš„æ›´æ–°éƒ½æ˜¯å‡†ç¡®çš„ï¼Œä½†ç”±äºè®¡ç®—æˆæœ¬è¾ƒé«˜ï¼Œå®é™…æ”¶æ•›åˆ°æœ€å°å€¼çš„é€Ÿåº¦å¯èƒ½ä¸å¦‚å…¶ä»–æ–¹æ³•å¿«ã€‚
  - **å†…å­˜éœ€æ±‚**ï¼šéœ€è¦åœ¨å†…å­˜ä¸­å­˜å‚¨æ•´ä¸ªæ•°æ®é›†ï¼Œå¯¹äºå¤§å‹æ•°æ®é›†æ¥è¯´å¯èƒ½æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚

- é€‚ç”¨åœºæ™¯

  - **å°æ•°æ®é›†**ï¼šå½“æ•°æ®é›†è¾ƒå°æ—¶ï¼Œæ‰¹é‡æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒèƒ½ä¿è¯è¾ƒå¥½çš„æ”¶æ•›æ€§å’Œå‡†ç¡®æ€§ã€‚
  - **ä¸éœ€è¦å®æ—¶æ›´æ–°**ï¼šå¦‚æœæ¨¡å‹ä¸éœ€è¦å®æ—¶æ›´æ–°ï¼Œä¾‹å¦‚åœ¨**ç¦»çº¿è®­ç»ƒåœºæ™¯**ä¸‹ï¼Œæ‰¹é‡æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ä¸ªåˆç†çš„é€‰æ‹©ã€‚

- æ³¨æ„äº‹é¡¹

  - **é€‰æ‹©åˆé€‚çš„å­¦ä¹ ç‡**ï¼šé€‰æ‹©åˆé€‚çš„å­¦ä¹ ç‡å¯¹äºå¿«é€Ÿä¸”ç¨³å®šçš„æ”¶æ•›è‡³å…³é‡è¦ã€‚å¦‚æœå­¦ä¹ ç‡å¤ªå°ï¼Œæ”¶æ•›é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼›å¦‚æœå¤ªå¤§ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´ä¸æ”¶æ•›ã€‚
  - **æ•°æ®é¢„å¤„ç†**ï¼šå¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–æˆ–å½’ä¸€åŒ–ï¼Œå¯ä»¥æé«˜æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ•ˆç‡ã€‚
  - **ç›‘æ§æŸå¤±å‡½æ•°**ï¼šå®šæœŸæ£€æŸ¥æŸå¤±å‡½æ•°çš„å˜åŒ–è¶‹åŠ¿ï¼Œç¡®ä¿ç®—æ³•æ­£å¸¸å·¥ä½œå¹¶æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚

#### 7.8 å°æ‰¹é‡æ¢¯åº¦ä¸‹é™SGD

- åŸç†

  **æ¯æ¬¡è¿­ä»£ä»…ä½¿ç”¨éšæœºå•ä¸ªæ ·æœ¬**æ¥è®¡ç®—æ¢¯åº¦å¹¶æ›´æ–°æƒé‡ã€‚

- å®ç°æ­¥éª¤

  1. **åˆå§‹åŒ–å‚æ•°**:
     - é€‰æ‹©ä¸€ä¸ªåˆå§‹ç‚¹ä½œä¸ºå‚æ•°å‘é‡ $\theta$çš„åˆå§‹å€¼ã€‚

  2. **é€‰æ‹©æ ·æœ¬**:
     - éšæœºé€‰å–ä¸€ä¸ªè®­ç»ƒæ ·æœ¬$ (x^{(i)}, y^{(i)})$ã€‚

  3. **è®¡ç®—æ¢¯åº¦**:
     - ä½¿ç”¨æ‰€é€‰æ ·æœ¬ $(x^{(i)}, y^{(i)})$æ¥è¿‘ä¼¼è®¡ç®—æŸå¤±å‡½æ•° $J(\theta) $çš„æ¢¯åº¦ $\nabla J(\theta)$ã€‚

  4. **æ›´æ–°å‚æ•°**:
     - æ ¹æ®æ¢¯åº¦çš„æ–¹å‘æ¥æ›´æ–°å‚æ•° $\theta$ã€‚æ›´æ–°å…¬å¼ä¸ºï¼š
       $\theta = \theta - \alpha \cdot \nabla J(\theta)$
     - å…¶ä¸­ $\alpha$ æ˜¯å­¦ä¹ ç‡ï¼Œå†³å®šäº†æ¯æ¬¡è¿­ä»£æ—¶å‚æ•°æ›´æ–°çš„æ­¥é•¿ã€‚

  5. **é‡å¤æ­¥éª¤ 2 åˆ° 4**:
     - å¯¹æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬é‡å¤æ­¤è¿‡ç¨‹ï¼Œç›´åˆ°å®Œæˆä¸€ä¸ªå®Œæ•´çš„ **epochï¼ˆå³æ‰€æœ‰æ ·æœ¬éƒ½è¢«è®¿é—®è¿‡ä¸€æ¬¡ï¼‰**ã€‚

  6. **é‡å¤å¤šä¸ª epoch**:
     - é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ»¡è¶³æŸä¸ªåœæ­¢æ¡ä»¶ï¼Œæ¯”å¦‚è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–è€…æ¢¯åº¦è¶³å¤Ÿå°ã€‚

  7. **è¾“å‡ºç»“æœ**:
     - è¾“å‡ºæœ€å°åŒ–æŸå¤±å‡½æ•°åçš„æœ€ä¼˜å‚æ•° $\theta^*$ã€‚

- æ•°å­¦å…¬å¼
  ![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/math.png)

  æ¢¯åº¦ $\nabla J(\theta)$ å¯¹äºæ¯ä¸ªå‚æ•° $\theta_j$ çš„åå¯¼æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š
  $\frac{\partial J(\theta)}{\partial \theta_j} = (h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)}$

- å¦‚ä½•æ›´æ–°

  å‚æ•° $\theta$ çš„æ›´æ–°è§„åˆ™ä¸ºï¼š
  $\theta_j := \theta_j - \alpha \cdot \frac{\partial J(\theta)}{\partial \theta_j}$

- æ³¨æ„äº‹é¡¹

  - **å­¦ä¹ ç‡ $\alpha$**: éœ€è¦é€‚å½“è®¾ç½®ï¼Œå¤ªå¤§ä¼šå¯¼è‡´ç®—æ³•ä¸æ”¶æ•›ï¼Œå¤ªå°åˆ™æ”¶æ•›é€Ÿåº¦æ…¢ã€‚
  - **éšæœºæ€§**: æ¯æ¬¡è¿­ä»£éƒ½ä»è®­ç»ƒé›†ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬ï¼Œè¿™æœ‰åŠ©äºé¿å…é™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚
  - **åœæ­¢æ¡ä»¶**: å¯ä»¥æ˜¯è¾¾åˆ°é¢„å®šçš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œæˆ–è€…æ¢¯åº¦çš„èŒƒæ•°å°äºæŸä¸ªé˜ˆå€¼ã€‚

- ä»£ç å®ç°

  ```python
  sklearn.linear_model.SGDRegressor()
  åŠŸèƒ½ï¼šæ¢¯åº¦ä¸‹é™æ³•çº¿æ€§å›å½’
  å‚æ•°:
  	loss: æŸå¤±å‡½æ•°ï¼Œé»˜è®¤ä¸º â€™squared_errorâ€™
      
  	fit_intercept: æ˜¯å¦è®¡ç®—åç½®ï¼Œ default=True
      
  	eta0: float, default=0.01å­¦ä¹ ç‡åˆå§‹å€¼
      
   	learning_rate:  str, default=â€™invscalingâ€™   
              â€˜constantâ€™: eta = eta0 å­¦ä¹ ç‡ä¸ºeta0è®¾ç½®çš„å€¼ï¼Œä¿æŒä¸å˜
              â€˜optimalâ€™: eta = 1.0 / (alpha * (t + t0)) 
              â€˜invscalingâ€™: eta = eta0 / pow(t, power_t)
              â€˜adaptiveâ€™: eta = eta0, å­¦ä¹ ç‡ç”±eta0å¼€å§‹ï¼Œé€æ­¥å˜å°
              
      max_iter: int,  default=1000 ç»è¿‡è®­ç»ƒæ•°æ®çš„æœ€å¤§æ¬¡æ•°(åˆåepoch)
      
      shuffle=True æ¯æ‰¹æ¬¡æ˜¯å¦æ´—ç‰Œï¼ˆæ‰“ä¹±é¡ºåºï¼‰
      
   	penalty: {â€˜l2â€™, â€˜l1â€™, â€˜elasticnetâ€™, None}, default=â€™l2â€™
   		è¦ä½¿ç”¨çš„æƒ©ç½š(åˆç§°æ­£åˆ™åŒ–é¡¹)ã€‚é»˜è®¤ä¸º' l2 'ï¼Œè¿™æ˜¯çº¿æ€§SVMæ¨¡å‹çš„æ ‡å‡†æ­£åˆ™åŒ–å™¨ã€‚' l1 'å’Œ' 
   	elasticnet 'å¯èƒ½ä¼šç»™æ¨¡å‹(ç‰¹å¾é€‰æ‹©)å¸¦æ¥' l2 'æ— æ³•å®ç°çš„ç¨€ç–æ€§ã€‚å½“è®¾ç½®ä¸ºNoneæ—¶ï¼Œä¸æ·»åŠ æƒ©ç½šã€‚
      
  å±æ€§:	 
  coef_ å›å½’åçš„æƒé‡ç³»æ•°
  intercept_ åç½®
  ```

  ```python
  from sklearn.datasets import fetch_california_housing
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.linear_model import SGDRegressor
  
  #åŠ è½½æ•°æ®
  data=fetch_california_housing(data_home='./',as_frame=True)
  x=np.array(data.data)
  y=np.array(data.target)
  #åˆ’åˆ†æ•°æ®
  x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=44,shuffle=True)
  #æ•°æ®é¢„å¤„ç†ï¼ˆæ ‡å‡†åŒ–ï¼‰
  stand=StandardScaler()
  x_train=stand.fit_transform(x_train)
  x_test=stand.fit_transform(x_test)
  #åˆå§‹åŒ–SGDå®¹å™¨
  sgd=SGDRegressor(loss='squared_error',fit_intercept=False,max_iter=1000,learning_rate='optimal',eta0=0.01)
  #è®­ç»ƒæ¨¡å‹
  sgd.fit(x_train,y_train)
  #è®­ç»ƒæ¨¡å‹çš„å‚æ•°
  print('è®­ç»ƒæ¨¡å‹çš„å›å½’æƒé‡ç³»æ•°ï¼š',sgd.coef_)
  print('è®­ç»ƒæ¨¡å‹çš„åç½®ï¼š',sgd.intercept_)
  #æ¨¡å‹è¯„ä¼°
  y_pre=sgd.predict(x_test)
  print('é¢„æµ‹å€¼ï¼š',y_pre)
  score=sgd.score(x_test,y_test)
  print('æ¨¡å‹çš„å‡†ç¡®ç‡ï¼š',score)
  ```

  ![SGD](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/SGD.png)

#### 7.10 æ¢¯åº¦ä¸‹é™ä¼˜åŒ–

1.æ ‡å‡†åŒ–

2.æ­£åˆ™åŒ–

### 8.æ¬ æ‹Ÿåˆè¿‡æ‹Ÿåˆ

![ni_he](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ni_he.png)

![ni_he_1](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ni_he_1.png)

#### 8.1æ¬ æ‹Ÿåˆ

**æ¬ æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°ä¸ä½³ï¼ŒåŒæ—¶åœ¨æ–°çš„æœªè§è¿‡çš„æ•°æ®ä¸Šä¹Ÿè¡¨ç°ä¸ä½³**ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨æ¨¡å‹è¿‡äºç®€å•ï¼Œæ— æ³•æ•æ‰æ•°æ®ä¸­çš„å¤æ‚æ¨¡å¼æ—¶ã€‚æ¬ æ‹Ÿåˆæ¨¡å‹çš„è¡¨ç°ç‰¹å¾å¦‚ä¸‹ï¼š

- è®­ç»ƒè¯¯å·®è¾ƒé«˜ã€‚
- æµ‹è¯•è¯¯å·®åŒæ ·è¾ƒé«˜ã€‚
- æ¨¡å‹å¯èƒ½è¿‡äºç®€åŒ–ï¼Œä¸èƒ½å……åˆ†å­¦ä¹ è®­ç»ƒæ•°æ®ä¸­çš„æ¨¡å¼ã€‚

#### 8.2è¿‡æ‹Ÿåˆ

**è¿‡æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¾—éå¸¸å¥½ï¼Œä½†åœ¨æ–°çš„æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°è¾ƒå·®ã€‚**è¿™é€šå¸¸å‘ç”Ÿåœ¨æ¨¡å‹è¿‡äºå¤æ‚ï¼Œä»¥è‡³äºå®ƒä¸ä»…å­¦ä¹ äº†æ•°æ®ä¸­çš„çœŸå®æ¨¡å¼ï¼Œè¿˜å­¦ä¹ äº†å™ªå£°å’Œå¼‚å¸¸å€¼ã€‚è¿‡æ‹Ÿåˆæ¨¡å‹çš„è¡¨ç°ç‰¹å¾å¦‚ä¸‹ï¼š

- è®­ç»ƒè¯¯å·®éå¸¸ä½ã€‚

- æµ‹è¯•è¯¯å·®è¾ƒé«˜ã€‚

- æ¨¡å‹å¯èƒ½è¿‡äºå¤æ‚ï¼Œä»¥è‡³äºå®ƒå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œäº†è¿‡åº¦æ‹Ÿåˆã€‚

#### 8.3æ­£åˆ™åŒ–

  æ­£åˆ™åŒ–å°±æ˜¯é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œå¢åŠ æ¨¡å‹çš„**é²æ£’æ€§**ï¼Œé²æ£’æ˜¯Robust çš„éŸ³è¯‘ï¼Œä¹Ÿå°±æ˜¯å¼ºå£®çš„æ„æ€ã€‚å°±åƒè®¡ç®—æœºè½¯ä»¶åœ¨é¢ä¸´æ”»å‡»ã€ç½‘ç»œè¿‡è½½ç­‰æƒ…å†µä¸‹èƒ½å¤Ÿä¸æ­»æœºä¸å´©æºƒï¼Œè¿™å°±æ˜¯è½¯ä»¶çš„é²æ£’æ€§,é²æ£’æ€§è°ƒä¼˜å°±æ˜¯è®©æ¨¡å‹æ‹¥æœ‰æ›´å¥½çš„é²æ£’
æ€§ï¼Œä¹Ÿå°±æ˜¯è®©æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ¨å¹¿èƒ½åŠ›æ›´åŠ çš„å¼ºå¤§ã€‚

æ¯”å¦‚,ä¸‹é¢ä¸¤ä¸ªæ–¹ç¨‹æè¿°åŒä¸€æ¡ç›´çº¿,å“ªä¸ªæ›´å¥½?

$y=0.5x_1+0.6x_2+0.7$

$y=5x_1+6x_2+7$

ç¬¬ä¸€ä¸ªæ›´å¥½ï¼Œå› ä¸ºä¸‹é¢çš„å…¬å¼æ˜¯ä¸Šé¢çš„åå€ï¼Œå½“wè¶Šå°å…¬å¼çš„å®¹é”™çš„èƒ½åŠ›å°±è¶Šå¥½ã€‚æˆ‘ä»¬éƒ½çŸ¥é“äººå·¥æ™ºèƒ½ä¸­å›å½’æ˜¯æœ‰è¯¯å·®çš„,ä¸ºäº†æŠŠè¯¯å·®é™ä½è€Œæ‹Ÿåˆå‡ºæ¥çš„ä¸€ä¸ªæ¥è¿‘çœŸå®çš„å…¬å¼,æ¯”å¦‚æŠŠä¸€ä¸ªæµ‹è¯•æ•°æ®[10,20]å¸¦å…¥è®¡ç®—å¾—åˆ°çš„å€¼è·ŸçœŸå®å€¼ä¼šå­˜åœ¨ä¸€å®šçš„è¯¯å·®,ä½†æ˜¯ç¬¬äºŒä¸ªæ–¹ç¨‹ä¼šæŠŠè¯¯å·®æ”¾å¤§,å…¬å¼ä¸­ 
 $y = W^Tx$ ï¼Œå½“ $x$ æœ‰ä¸€ç‚¹é”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯ä¼šé€šè¿‡wæ”¾å¤§ã€‚ä½†æ˜¯wä¸èƒ½å¤ªå°ï¼Œå½“wå¤ªå°æ—¶(æ¯”å¦‚éƒ½è¶‹è¿‘0)ï¼Œæ¨¡å‹å°±æ²¡æœ‰æ„ä¹‰äº†ï¼Œæ— æ³•åº”ç”¨ã€‚æƒ³è¦æœ‰ä¸€å®šçš„å®¹é”™ç‡åˆè¦ä¿è¯æ­£ç¡®ç‡å°±è¦ç”±**æ­£åˆ™é¡¹**æ¥å‘æŒ¥ä½œç”¨äº†!
æ‰€ä»¥**æ­£åˆ™åŒ–(é²æ£’æ€§è°ƒä¼˜)**çš„æœ¬è´¨å°±æ˜¯ç‰ºç‰²æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„æ­£ç¡®ç‡æ¥æé«˜æ¨å¹¿ã€æ³›åŒ–èƒ½åŠ›ï¼ŒWåœ¨æ•°å€¼ä¸Šè¶Šå°è¶Šå¥½ï¼Œè¿™æ ·èƒ½æŠµæŠ—æ•°å€¼çš„æ‰°åŠ¨ã€‚åŒæ—¶ä¸ºäº†ä¿è¯æ¨¡å‹çš„æ­£ç¡®ç‡Wåˆä¸èƒ½æå°ã€‚**å› æ­¤å°†åŸæ¥çš„æŸå¤±å‡½æ•°åŠ ä¸Šä¸€ä¸ªæƒ©ç½šé¡¹ä½¿å¾—è®¡ç®—å‡ºæ¥çš„æ¨¡å‹Wç›¸å¯¹å°ä¸€äº›ï¼Œå°±æ˜¯æ­£åˆ™åŒ–**ã€‚è¿™é‡Œé¢æŸå¤±å‡½æ•°å°±æ˜¯åŸæ¥å›ºæœ‰çš„æŸå¤±å‡½æ•°ï¼Œæ¯”å¦‚å›å½’çš„è¯é€šå¸¸æ˜¯MSEï¼Œç„¶ååœ¨åŠ ä¸Šä¸€éƒ¨åˆ†æƒ©ç½šé¡¹æ¥ä½¿å¾—è®¡ç®—å‡ºæ¥çš„æ¨¡å‹Wç›¸å¯¹å°ä¸€äº›æ¥å¸¦æ¥æ³›åŒ–èƒ½åŠ›ã€‚

å¸¸ç”¨çš„æƒ©ç½šé¡¹æœ‰L1æ­£åˆ™é¡¹æˆ–è€…L2æ­£åˆ™é¡¹:

![](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/lizheng.png)

å…¶å® $L1$ å’Œ $L2$ æ­£åˆ™çš„å…¬å¼åœ¨æ•°å­¦é‡Œé¢çš„æ„ä¹‰å°±æ˜¯èŒƒæ•°,ä»£è¡¨ç©ºé—´ä¸­å‘é‡åˆ°åŸç‚¹çš„è·ç¦»

å½“æˆ‘ä»¬æŠŠå¤šå…ƒçº¿æ€§å›å½’æŸå¤±å‡½æ•°åŠ ä¸Š $L2$ æ­£åˆ™çš„æ—¶å€™ï¼Œå°±è¯ç”Ÿäº†Ridgeå²­å›å½’ã€‚å½“æˆ‘ä»¬æŠŠå¤šå…ƒçº¿æ€§å›å½’æŸå¤±å‡½æ•°åŠ ä¸Š $L1$ æ­£åˆ™çš„æ—¶å€™ï¼Œå°±å­•è‚²å‡ºæ¥äº†Lassoå›å½’ã€‚å…¶å® $L1$ å’Œ $L2$ æ­£åˆ™é¡¹æƒ©ç½šé¡¹å¯ä»¥åŠ åˆ°ä»»ä½•ç®—æ³•çš„æŸå¤±å‡½æ•°ä¸Šé¢å»æé«˜è®¡ç®—å‡ºæ¥æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›çš„ã€‚

### 9.å²­å›å½’Ridge

- æŸå¤±å‡½æ•°å…¬å¼

  å²­å›å½’æ˜¯å¤±æŸå‡½æ•°é€šè¿‡æ·»åŠ æ‰€æœ‰æƒé‡çš„å¹³æ–¹å’Œçš„ä¹˜ç§¯(L2)æ¥æƒ©ç½šæ¨¡å‹çš„å¤æ‚åº¦ã€‚

  ![ridge](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/ridge.png)

  å‡æ–¹å·®é™¤ä»¥2æ˜¯å› ä¸ºæ–¹ä¾¿æ±‚å¯¼ï¼Œ $w_j$ æŒ‡æ‰€æœ‰çš„æƒé‡ç³»æ•°, Î»æŒ‡æƒ©ç½šå‹ç³»æ•°ï¼Œåˆå«æ­£åˆ™é¡¹åŠ›åº¦ã€‚

  - å²­å›å½’ä¸ä¼šå°†æƒé‡å‹ç¼©åˆ°é›¶ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ç‰¹å¾éƒ½ä¼šä¿ç•™åœ¨æ¨¡å‹ä¸­ï¼Œä½†å®ƒä»¬çš„æƒé‡ä¼šè¢«ç¼©å°ã€‚
  - é€‚ç”¨äºç‰¹å¾é—´å­˜åœ¨å¤šé‡å…±çº¿æ€§çš„æƒ…å†µã€‚
  - å²­å›å½’äº§ç”Ÿçš„æ¨¡å‹é€šå¸¸æ›´ä¸ºå¹³æ»‘ï¼Œå› ä¸ºå®ƒå¯¹æ‰€æœ‰ç‰¹å¾éƒ½æœ‰å½±å“ã€‚

- API

  ```python
  å…·æœ‰L2æ­£åˆ™åŒ–çš„çº¿æ€§å›å½’-å²­å›å½’ã€‚
  sklearn.linear_model.Ridge()
  1 å‚æ•°ï¼š
  (1)alpha, default=1.0ï¼Œæ­£åˆ™é¡¹åŠ›åº¦
  (2)fit_intercept, æ˜¯å¦è®¡ç®—åç½®ï¼Œ default=True
  (3)solver, {â€˜autoâ€™, â€˜svdâ€™, â€˜choleskyâ€™, â€˜lsqrâ€™, â€˜sparse_cgâ€™, â€˜sagâ€™, â€˜sagaâ€™, â€˜lbfgsâ€™}, default=â€™autoâ€™
  å½“å€¼ä¸ºauto,å¹¶ä¸”æ•°æ®åº¥ã€ç‰¹å¾éƒ½æ¯”è¾ƒå¤§æ—¶ï¼Œå†…éƒ¨ä¼šéšæœºæ¢¯åº¦ä¸‹é™æ³•ã€‚
  (4)max_iterint, default=None,æ¢¯åº¦è§£ç®—å™¨çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º15000
  
  2 å±æ€§
  coef_ å›å½’åçš„æƒé‡ç³»æ•°
  intercept_ åç½®
  
  è¯´æ˜:SGDRegressorä¹Ÿå¯ä»¥åšå²­å›å½’çš„äº‹æƒ…ï¼Œæ¯”å¦‚SGDRegressor(penalty='l2',loss="squared_loss"),ä½†æ˜¯å…¶ä¸­æ¢¯åº¦ä¸‹é™æ³•æœ‰äº›ä¸åŒã€‚æ‰€ä»¥æ¨èä½¿ç”¨Ridgeå®ç°å²­å›å½’
  ```

- å®ä¾‹

  ```python
  # å²­å›å½’ åŠ è½½åŠ åˆ©ç¦å°¼äºšä½æˆ¿æ•°æ®é›†ï¼Œè¿›è¡Œå›å½’é¢„æµ‹
  from sklearn.model_selection import train_test_split
  from sklearn.preprocessing import StandardScaler
  from sklearn.linear_model import LinearRegression, SGDRegressor, Ridge
  from sklearn.metrics import mean_squared_error
  
  from sklearn.datasets import fetch_california_housing
  # 1)åŠ è½½æ•°æ®
  housing = fetch_california_housing(data_home="./src")
  print(housing)
  # 2)åˆ’åˆ†è®­ç»ƒé›†ä¸æµ‹è¯•é›†
  x_train, x_test, y_train, y_test = train_test_split(housing.data, housing.target, random_state=22)
  # 3)æ ‡å‡†åŒ–
  transfer = StandardScaler()
  x_train = transfer.fit_transform(x_train)
  x_test = transfer.transform(x_test)
  
  # 4ï¼‰å²­å›å½’é¢„ä¼°å™¨
  estimator = Ridge(alpha=0.5, max_iter=10000)
  estimator.fit(x_train, y_train)
  
  # 5ï¼‰å¾—å‡ºæ¨¡å‹
  print("æƒé‡ç³»æ•°ä¸ºï¼š\n", estimator.coef_)  #æƒé‡ç³»æ•°ä¸ç‰¹å¾æ•°ä¸€å®šæ˜¯åŒæ ·çš„ä¸ªæ•°ã€‚
  print("åç½®ä¸ºï¼š\n", estimator.intercept_)
  
  # 6ï¼‰æ¨¡å‹è¯„ä¼°
  y_predict = estimator.predict(x_test)
  print("é¢„æµ‹çš„æ•°æ®é›†ï¼š\n", y_predict)
  error = mean_squared_error(y_test, y_predict)
  print("å‡æ–¹è¯¯å·®ä¸ºï¼š\n", error)
  ```

### 10.æ‹‰ç´¢å›å½’Lasso

- æŸå¤±å‡½æ•°å…¬å¼

  Lassoå›å½’æ˜¯ä¸€ç§çº¿æ€§å›å½’æ¨¡å‹ï¼Œå®ƒé€šè¿‡æ·»åŠ æ‰€æœ‰æƒé‡çš„ç»å¯¹å€¼ä¹‹å’Œ(L1)æ¥æƒ©ç½šæ¨¡å‹çš„å¤æ‚åº¦ã€‚

  Lassoå›å½’çš„ç›®æ ‡æ˜¯æœ€å°åŒ–ä»¥ä¸‹æŸå¤±å‡½æ•°ï¼š

  $\text{J(w)}= \frac{1}{2n}\sum_{i=1}^n (h_w(x_i)-y_i)^2 + \lambda \sum_{j=1}^p |w_j|$

  å…¶ä¸­ï¼š

  - $n$ æ˜¯æ ·æœ¬æ•°é‡ï¼Œ
  - $p$ æ˜¯ç‰¹å¾çš„æ•°é‡ï¼Œ
  - $y_i$ æ˜¯ç¬¬ $i$ ä¸ªæ ·æœ¬çš„ç›®æ ‡å€¼ï¼Œ
  - $x_i$ æ˜¯ç¬¬ $i$ ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œ
  - $w$ æ˜¯æ¨¡å‹çš„å‚æ•°å‘é‡ï¼Œ
  - $\lambda$ æ˜¯æ­£åˆ™åŒ–å‚æ•°ï¼Œæ§åˆ¶æ­£åˆ™åŒ–é¡¹çš„å¼ºåº¦ã€‚

  ç‰¹ç‚¹:

  - æ‹‰ç´¢å›å½’å¯ä»¥å°†ä¸€äº›æƒé‡å‹ç¼©åˆ°é›¶ï¼Œä»è€Œå®ç°ç‰¹å¾é€‰æ‹©ã€‚è¿™æ„å‘³ç€æ¨¡å‹æœ€ç»ˆå¯èƒ½åªåŒ…å«ä¸€éƒ¨åˆ†ç‰¹å¾ã€‚
  - é€‚ç”¨äºç‰¹å¾æ•°é‡è¿œå¤§äºæ ·æœ¬æ•°é‡çš„æƒ…å†µï¼Œæˆ–è€…å½“ç‰¹å¾é—´å­˜åœ¨ç›¸å…³æ€§æ—¶ï¼Œå¯ä»¥ä»ä¸­é€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾ã€‚
  - æ‹‰ç´¢å›å½’äº§ç”Ÿçš„æ¨¡å‹å¯èƒ½æ›´ç®€å•ï¼Œå› ä¸ºå®ƒä¼šå»é™¤ä¸€äº›ä¸é‡è¦çš„ç‰¹å¾ã€‚

- API

  ```python
  sklearn.linear_model.Lasso()
  """
  å‚æ•°:
  
  1. **alpha (float, default=1.0)**:
     - æ§åˆ¶æ­£åˆ™åŒ–å¼ºåº¦ï¼›å¿…é¡»æ˜¯éè´Ÿæµ®ç‚¹æ•°ã€‚è¾ƒå¤§çš„ alpha å¢åŠ äº†æ­£åˆ™åŒ–å¼ºåº¦ã€‚
  2. **fit_intercept (bool, default=True)**:
     - æ˜¯å¦è®¡ç®—æ­¤æ¨¡å‹çš„æˆªè·ã€‚å¦‚æœè®¾ç½®ä¸º Falseï¼Œåˆ™ä¸ä¼šä½¿ç”¨æˆªè·ï¼ˆå³æ•°æ®åº”è¯¥å·²ç»è¢«å±…ä¸­ï¼‰ã€‚
  3. **precompute (bool or array-like, default=False)**:
     - å¦‚æœä¸º Trueï¼Œåˆ™ä½¿ç”¨é¢„è®¡ç®—çš„ Gram çŸ©é˜µæ¥åŠ é€Ÿè®¡ç®—ã€‚å¦‚æœä¸ºæ•°ç»„ï¼Œåˆ™ä½¿ç”¨æä¾›çš„ Gram çŸ©é˜µã€‚
  4. **copy_X (bool, default=True)**:
     - å¦‚æœä¸º Trueï¼Œåˆ™å¤åˆ¶æ•°æ® Xï¼Œå¦åˆ™å¯èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚
  5. **max_iter (int, default=1000)**:
     - æœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚
  6. **tol (float, default=1e-4)**:
     - ç²¾åº¦é˜ˆå€¼ã€‚å¦‚æœæ›´æ–°åçš„ç³»æ•°å‘é‡å‡å»ä¹‹å‰çš„ç³»æ•°å‘é‡çš„æ— ç©·èŒƒæ•°é™¤ä»¥ 1 åŠ ä¸Šæ›´æ–°åçš„ç³»æ•°å‘é‡çš„æ— ç©·èŒƒæ•°å°äº tolï¼Œåˆ™è®¤ä¸ºæ”¶æ•›ã€‚
  7. **warm_start (bool, default=False)**:
     - å½“è®¾ç½®ä¸º True æ—¶ï¼Œå†æ¬¡è°ƒç”¨ fit æ–¹æ³•ä¼šé‡æ–°ä½¿ç”¨ä¹‹å‰è°ƒç”¨ fit æ–¹æ³•çš„ç»“æœä½œä¸ºåˆå§‹ä¼°è®¡å€¼ï¼Œè€Œä¸æ˜¯æ¸…é›¶å®ƒä»¬ã€‚
  8. **positive (bool, default=False)**:
     - å½“è®¾ç½®ä¸º True æ—¶ï¼Œå¼ºåˆ¶ç³»æ•°ä¸ºéè´Ÿã€‚
  9. **random_state (int, RandomState instance, default=None)**:
     - éšæœºæ•°ç”Ÿæˆå™¨çš„çŠ¶æ€ã€‚ç”¨äºéšæœºåˆå§‹åŒ–åæ ‡ä¸‹é™ç®—æ³•ä¸­çš„éšæœºé€‰æ‹©ã€‚
  10. **selection ({'cyclic', 'random'}, default='cyclic')**:
      - å¦‚æœè®¾ç½®ä¸º 'random'ï¼Œåˆ™éšæœºé€‰æ‹©åæ ‡è¿›è¡Œæ›´æ–°ã€‚å¦‚æœè®¾ç½®ä¸º 'cyclic'ï¼Œåˆ™æŒ‰ç…§å¾ªç¯é¡ºåºé€‰æ‹©åæ ‡ã€‚
  
  å±æ€§:
  
  1. **coef_**
     - ç³»æ•°å‘é‡æˆ–è€…çŸ©é˜µï¼Œä»£è¡¨äº†æ¯ä¸ªç‰¹å¾çš„æƒé‡ã€‚
  2. **intercept_ **
     - æˆªè·é¡¹ï¼ˆå¦‚æœ fit_intercept=Trueï¼‰ã€‚
  3. **n_iter_ **
     - å®é™…ä½¿ç”¨çš„è¿­ä»£æ¬¡æ•°ã€‚
  4. **n_features_in_ (int)**:
     - è®­ç»ƒæ ·æœ¬ä¸­ç‰¹å¾çš„æ•°é‡ã€‚
  
  """
  ```

- å®ä¾‹

  ```python
  from sklearn.datasets import fetch_california_housing
  from sklearn.linear_model import Lasso
  from sklearn.model_selection import train_test_split
  from sklearn.metrics import mean_squared_error
  import numpy as np
  
  # åŠ è½½æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†
  data = fetch_california_housing(data_home="./src")
  X, y = data.data, data.target
  
  # åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
  X_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
  
  # åˆ›å»ºLassoå›å½’æ¨¡å‹
  lasso = Lasso(alpha=0.1)  # alphaæ˜¯æ­£åˆ™åŒ–å‚æ•°
  
  # è®­ç»ƒæ¨¡å‹
  lasso.fit(X_train, y_train)
  
  # å¾—å‡ºæ¨¡å‹
  print("æƒé‡ç³»æ•°ä¸ºï¼š\n", lasso.coef_)  #æƒé‡ç³»æ•°ä¸ç‰¹å¾æ•°ä¸€å®šæ˜¯åŒæ ·çš„ä¸ªæ•°ã€‚
  print("åç½®ä¸ºï¼š\n", lasso.intercept_)
  
  #æ¨¡å‹è¯„ä¼°
  y_predict = lasso.predict(x_test)
  print("é¢„æµ‹çš„æ•°æ®é›†ï¼š\n", y_predict)
  error = mean_squared_error(y_test, y_predict)
  print("å‡æ–¹è¯¯å·®ä¸ºï¼š\n", error)
  ```

  

## é€»è¾‘å›å½’

- å®šä¹‰

  é€»è¾‘å›å½’(Logistic Regression)æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„ä¸€ç§åˆ†ç±»æ¨¡å‹ï¼Œ**é€»è¾‘å›å½’æ˜¯ä¸€ç§åˆ†ç±»ç®—æ³•**ï¼Œè™½ç„¶åå­—ä¸­å¸¦æœ‰å›å½’ï¼Œä½†æ˜¯å®ƒä¸å›å½’ä¹‹é—´æœ‰ä¸€å®šçš„è”ç³»ã€‚ç”±äºç®—æ³•çš„ç®€å•å’Œé«˜æ•ˆï¼Œåœ¨å®é™…ä¸­åº”ç”¨éå¸¸å¹¿æ³›ã€‚

  é€»è¾‘å›å½’ä¸€èˆ¬ç”¨äºäºŒåˆ†ç±»é—®é¢˜,æ¯”å¦‚:

  æ˜¯å¥½ç“œè¿˜æ˜¯åç“œ

  å¥åº·è¿˜æ˜¯ä¸å¥åº·

  å¯ä»¥æ‰˜ä»˜ç»ˆèº«è¿˜æ˜¯ä¸å¯ä»¥

- åŸç†

  é€»è¾‘å›å½’çš„è¾“å…¥æ˜¯çº¿æ€§å›å½’çš„è¾“å‡º

  çº¿æ€§å›å½’: **$h(w)=w_1x_1+w_2x_2+....+b$** 

  sigmoidæ¿€æ´»å‡½æ•° :
  $f(x)=\frac{1}{1+e^{-x}}$      

  sigmoidå‡½æ•°çš„å€¼æ˜¯åœ¨[0,1]åŒºé—´ä¸­çš„ä¸€ä¸ªæ¦‚ç‡å€¼,é»˜è®¤ä¸º0.5ä¸ºé˜ˆå€¼å¯ä»¥è‡ªå·±è®¾å®š,å¤§äº0.5è®¤ä¸ºæ˜¯æ­£ä¾‹,å°äºåˆ™è®¤ä¸ºæ˜¯è´Ÿä¾‹

  æŠŠä¸Šé¢çš„$h(w)$ çº¿æ€§çš„è¾“å‡ºå†è¾“å…¥åˆ°sigmoidå‡½æ•°å½“ä¸­
  $f(w)=\frac{1}{1+e^{-h(w)}}$    

  ![sigmo](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/sigmo.png)

  æŸå¤±å‡½æ•°ï¼š

  ![NNN](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/NNN.png)

  æŸå¤±å‡½æ•°å›¾ï¼š

  y=1æ—¶:

  ![redio](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/redio.png)

  é€šè¿‡æŸå¤±å‡½æ•°å›¾åƒ,æˆ‘ä»¬çŸ¥é“:

  å½“y=1æ—¶,æˆ‘ä»¬å¸Œæœ›
  $$h\theta(x)$$
  å€¼è¶Šå¤§è¶Šå¥½

  å½“y=0æ—¶,æˆ‘ä»¬å¸Œæœ›
  $h\theta(x)$
  å€¼è¶Šå°è¶Šå¥½

  ç»¼åˆ0å’Œ1çš„æŸå¤±å‡½æ•°:

  ![MMM](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/MMM.png)

  ![BBB](https://github.com/ljgit1316/Picture_resource/blob/main/Machine_Pic/BBB.png)

- API

  ```python
  sklearn.linear_model.LogisticRegression()
  å‚æ•°:
  	fit_intercept bool, default=True æŒ‡å®šæ˜¯å¦è®¡ç®—æˆªè·
  	max_iter int, default=100  æœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚è¿­ä»£è¾¾åˆ°æ­¤æ•°ç›®åï¼Œå³ä½¿æœªæ”¶æ•›ä¹Ÿä¼šåœæ­¢ã€‚
  æ¨¡å‹å¯¹è±¡:
    .coef_ æƒé‡
    .intercept_ åç½®
    predict()é¢„æµ‹åˆ†ç±»
    predict_proba()é¢„æµ‹åˆ†ç±»(å¯¹åº”çš„æ¦‚ç‡)
    score()å‡†ç¡®ç‡
  ```

- å®ä¾‹

  ```python
  #å¯¼åŒ…
  import numpy as np
  from sklearn.linear_model import LogisticRegression
  from sklearn.model_selection import train_test_split
  from sklearn.datasets import load_iris
  #åŠ è½½æ•°æ®
  X,y = load_iris(return_X_y=True)
  print(y)
  
  #äºŒåˆ†ç±» åˆ é™¤ç¬¬ä¸‰ç±»
  X=X[y!=2]
  y=y[y!=2]
  print(y)
  
  #æ•°æ®é›†åˆ’åˆ†
  X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.25,random_state=33)
  print(X_train.shape,y_train.shape)
  
  #é€»è¾‘å›å½’æ¨¡å‹
  model=LogisticRegression()
  
  #è®­ç»ƒ
  model.fit(X_train,y_train)
  
  #æƒé‡
  print(model.coef_)
  
  #åç½®
  print(model.intercept_)
  
  #é¢„æµ‹åˆ†ç±»
  y_predict=model.predict(X_test)
  print(y_predict)
  print(y_test)
  
  #é¢„æµ‹åˆ†ç±»å¯¹åº”çš„æ¦‚ç‡
  proba=model.predict_proba(X_test)
  print(proba)
  
  #è¯„ä¼°
  print(model.score(X_test,y_test))
  ```

  
